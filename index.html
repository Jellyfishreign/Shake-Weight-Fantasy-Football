<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shake Weight Fantasy Football</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Bebas+Neue&family=Oswald:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 3.5rem;
            font-weight: 800;
            margin-bottom: 8px;
            color: #111827;
            font-family: 'Black Ops One', 'Bebas Neue', 'Oswald', 'Inter', sans-serif;
            letter-spacing: 1px;
            text-transform: uppercase;
            text-shadow: 0 4px 12px rgba(0,0,0,0.15), 0 2px 4px rgba(0,0,0,0.1);
        }
        @media (min-width: 1200px) {
            .header h1 { font-size: 4.25rem; }
        }
        @media (max-width: 768px) {
            .header h1 { font-size: 2.6rem; }
        }

        .header p {
            font-size: 1.1rem;
            color: #4a5568;
        }

        .timestamp {
            background: #e2e8f0;
            padding: 8px 16px;
            border-radius: 4px;
            display: inline-block;
            margin-top: 15px;
            font-weight: 500;
            color: #2d3748;
        }

        .tabs-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-bottom: 30px;
        }

        .tabs-header {
            display: flex;
            background: #2d3748;
            border-bottom: 1px solid #4a5568;
        }

        .tab-button {
            background: none;
            border: none;
            color: #a0aec0;
            padding: 15px 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .tab-button:hover {
            color: #e2e8f0;
            background: rgba(255,255,255,0.1);
        }

        .tab-button.active {
            color: white;
            border-bottom-color: #4299e1;
            background: rgba(255,255,255,0.1);
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .duel-of-fates-container {
            background: linear-gradient(135deg, rgba(139, 0, 0, 0.2), rgba(0, 0, 0, 0.3));
            border: 3px solid #8B0000;
            border-radius: 12px;
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
            min-height: 400px;
        }

        .duel-of-fates-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            z-index: 1;
            pointer-events: none;
        }

        .duel-of-fates-video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: 0;
            opacity: 0.3;
            transform: scale(2.5);
            transform-origin: center center;
        }

        .duel-of-fates-header {
            background: linear-gradient(135deg, #8B0000, #DC143C);
            color: white;
            padding: 15px 20px;
            font-weight: 700;
            font-size: 1.1rem;
            text-align: center;
            letter-spacing: 1px;
            text-transform: uppercase;
            position: relative;
            z-index: 2;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .duel-of-fates-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            padding: 20px;
            position: relative;
            z-index: 2;
            min-height: 300px;
        }

        .duel-section {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(139, 0, 0, 0.3);
            overflow: hidden;
            opacity: 0.8;
            border: 1px solid rgba(139, 0, 0, 0.2);
        }

        .duel-header {
            background: linear-gradient(135deg, #8B0000, #DC143C);
            color: white;
            padding: 12px 15px;
            font-weight: 600;
            font-size: 1rem;
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        .duel-content {
            padding: 15px;
        }

        .duel-content .data-table {
            background: rgba(255, 255, 255, 0.6);
        }

        .duel-content .data-table th {
            background: rgba(139, 0, 0, 0.8);
            color: white;
            border: 1px solid rgba(220, 20, 60, 0.3);
        }

        .duel-content .data-table td {
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(139, 0, 0, 0.2);
        }

        .duel-content .data-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.4);
        }

        .duel-content .data-table tr:hover {
            background: rgba(220, 20, 60, 0.2);
        }

        /* Make team names black in Duel of the Fates section */
        .duel-content .data-table td {
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(139, 0, 0, 0.2);
            color: black;
        }

        /* ===== UNIVERSAL TEAM NAME FIX - MAKE ALL BLACK ===== */
        .data-table .team-name,
        .duel-content .team-name,
        .wildcard-content .team-name, 
        .toilet-content .team-name,
        .week-section .team-name,
        .tournament-grid .team-name,
        #week16-conference .team-name,
        #week16-purgatory .team-name,
        #week16-toilet .team-name,
        #week17-championship .team-name,
        #week17-purgatory .team-name,
        #week17-toilet .team-name {
            color: #000000 !important;
            font-weight: 500;
        }

        .tournament-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            position: relative;
        }

        .week-section {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
            position: relative;
            z-index: 1; /* Lower than overlay */
        }

        .week-header {
            background: #4a5568;
            color: white;
            padding: 15px 20px;
            font-weight: 600;
            font-size: 1.1rem;
            text-align: center;
            position: relative;
            z-index: 1; /* Lower than overlay */
        }

        .week-content {
            padding: 20px;
        }

        .round-section {
            margin-bottom: 20px;
        }

        .round-title {
            font-weight: 600;
            font-size: 0.9rem;
            color: #2d3748;
            margin-bottom: 8px;
            padding-bottom: 3px;
            border-bottom: 1px solid #e2e8f0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .seed-label {
            font-size: 0.7rem;
            color: #718096;
            font-style: italic;
            margin-bottom: 5px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
            font-size: 0.8rem;
        }

        .data-table th {
            background: #f7fafc;
            padding: 6px 8px;
            text-align: center;
            font-weight: 600;
            color: #4a5568;
            border: 1px solid #e2e8f0;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .data-table td {
            padding: 6px 8px;
            border: 1px solid #e2e8f0;
            vertical-align: middle;
        }

        .data-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .data-table tr:hover {
            background: #edf2f7;
        }

        .team-name {
            font-weight: 500;
            color: #2d3748;
        }

        .score {
            font-weight: 600;
            color: #2d3748;
            text-align: right;
        }

        .position-change {
            font-size: 0.7rem;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 12px;
            display: inline-block;
        }

        .position-change.positive {
            background: #c6f6d5;
            color: #22543d;
        }

        .position-change.negative {
            background: #fed7d7;
            color: #742a2a;
        }

        .position-change.neutral {
            background: #e2e8f0;
            color: #4a5568;
        }

        .standings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        .standings-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }

        .standings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e2e8f0;
        }

        .standings-team {
            font-weight: 600;
            color: #2d3748;
        }

        .standings-position {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .standings-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: #4a5568;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #4a5568;
            font-size: 1.2rem;
        }

        .error {
            background: #fed7d7;
            color: #c53030;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #e53e3e;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .payout {
            font-weight: 600;
        }

        .payout.positive {
            color: #38a169;
        }

        .payout.negative {
            color: #e53e3e;
        }

        .payout.neutral {
            color: #718096;
        }

        .result-row {
            background: #f0fff4 !important;
            border-left: 4px solid #48bb78 !important;
        }

        .tournament-phase {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 12px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 0.8rem;
            text-align: center;
            margin-bottom: 15px;
        }

        .wildcard-divisional-container {
            background: linear-gradient(135deg, rgba(0, 100, 0, 0.1), rgba(34, 139, 34, 0.1));
            border: 3px solid #006400;
            border-radius: 12px;
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
            min-height: 400px;
        }

        .wildcard-divisional-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&h=600&fit=crop') center center;
            background-size: cover;
            opacity: 0.3;
            z-index: 0;
        }

        .wildcard-divisional-container::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 100, 0, 0.2);
            z-index: 1;
            pointer-events: none;
        }

        .wildcard-divisional-header {
            background: linear-gradient(135deg, #006400, #228B22);
            color: white;
            padding: 15px 20px;
            font-weight: 700;
            font-size: 1.1rem;
            text-align: center;
            letter-spacing: 1px;
            text-transform: uppercase;
            position: relative;
            z-index: 2;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .wildcard-divisional-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            padding: 20px;
            position: relative;
            z-index: 2;
            min-height: 300px;
        }

        .wildcard-section {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 100, 0, 0.3);
            overflow: hidden;
            opacity: 0.9;
            border: 1px solid rgba(0, 100, 0, 0.2);
        }

        .wildcard-header {
            background: linear-gradient(135deg, #006400, #228B22);
            color: white;
            padding: 12px 15px;
            font-weight: 600;
            font-size: 1rem;
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        .wildcard-content {
            padding: 15px;
        }

        .wildcard-content .data-table {
            background: rgba(255, 255, 255, 0.7);
        }

        .wildcard-content .data-table th {
            background: rgba(0, 100, 0, 0.8);
            color: white;
            border: 1px solid rgba(34, 139, 34, 0.3);
        }

        .wildcard-content .data-table td {
            background: rgba(255, 255, 255, 0.6);
            border: 1px solid rgba(0, 100, 0, 0.2);
        }

        .wildcard-content .data-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.5);
        }

        .wildcard-content .data-table tr:hover {
            background: rgba(34, 139, 34, 0.2);
        }

        /* Make team names black in Wildcard + Divisional Round */
        .wildcard-content .data-table td {
            background: rgba(255, 255, 255, 0.6);
            border: 1px solid rgba(0, 100, 0, 0.2);
        }

        /* Specifically target team-name spans in wildcard section */
        .wildcard-content .data-table .team-name,
        .wildcard-divisional-container .data-table .team-name {
            color: #000000 !important;
            font-weight: 500;
        }

        .toilet-bowl-container {
            background: linear-gradient(135deg, rgba(47, 79, 79, 0.2), rgba(70, 130, 180, 0.3));
            border: 3px solid #2F4F4F;
            border-radius: 12px;
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
            min-height: 400px;
        }

        .toilet-bowl-container::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(47, 79, 79, 0.5);
            z-index: 1;
            pointer-events: none;
        }

        .toilet-bowl-header {
            background: linear-gradient(135deg, #2F4F4F, #4682B4);
            color: white;
            padding: 15px 20px;
            font-weight: 700;
            font-size: 1.1rem;
            text-align: center;
            letter-spacing: 1px;
            text-transform: uppercase;
            position: relative;
            z-index: 2;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .toilet-bowl-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            padding: 20px;
            position: relative;
            z-index: 2;
            min-height: 300px;
        }

        .toilet-section {
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(47, 79, 79, 0.3);
            overflow: hidden;
            opacity: 0.8;
            border: 1px solid rgba(47, 79, 79, 0.2);
        }

        .toilet-header {
            background: linear-gradient(135deg, #2F4F4F, #4682B4);
            color: white;
            padding: 12px 15px;
            font-weight: 600;
            font-size: 1rem;
            text-align: center;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        .toilet-content {
            padding: 15px;
        }

        .toilet-content .data-table {
            background: rgba(255, 255, 255, 0.6);
        }

        .toilet-content .data-table th {
            background: rgba(47, 79, 79, 0.8);
            color: white;
            border: 1px solid rgba(70, 130, 180, 0.3);
        }

        .toilet-content .data-table td {
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(47, 79, 79, 0.2);
        }

        .toilet-content .data-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.4);
        }

        .toilet-content .data-table tr:hover {
            background: rgba(70, 130, 180, 0.2);
        }

        .wildcard-winner-row {
            background: linear-gradient(45deg, #48bb78, #38a169) !important;
            color: white !important;
            font-weight: 700 !important;
        }

        .wildcard-winner-row td {
            color: white !important;
            font-weight: 700 !important;
        }

        @media (max-width: 1200px) {
            .tournament-grid {
                grid-template-columns: 1fr;
            }
            .duel-of-fates-grid {
                grid-template-columns: 1fr;
            }
            .wildcard-divisional-grid {
                grid-template-columns: 1fr;
            }
            .toilet-bowl-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .tabs-header {
                flex-direction: column;
            }
            
            .tab-button {
                padding: 12px 20px;
                font-size: 0.9rem;
            }
            
            .data-table {
                font-size: 0.7rem;
            }
            
            .data-table th,
            .data-table td {
                padding: 4px 6px;
            }
        }
        .subtabs-header {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: nowrap; /* keep buttons on one row */
        }
        .subtab-button {
            background: #222;
            color: #fff;
            border: none;
            padding: 10px 18px;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }
        .subtab-button.active {
            background: #4a148c;
            color: #fff;
        }
        .subtab-content {
            display: none;
        }
        .subtab-content.active {
            display: block;
        }
        .rules-section {
            max-width: 700px;
            margin: 30px auto;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 32px 28px 24px 28px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
        }
        .rules-section h2 {
            color: #4a148c;
            margin-top: 0;
        }
        .rules-section h3 {
            color: #228B22;
            margin-bottom: 8px;
        }
        .rules-section ul {
            margin-bottom: 18px;
            padding-left: 22px;
        }
        .rules-section li {
            margin-bottom: 6px;
            font-size: 1.05em;
        }
        .rules-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 22px;
        }
        .rules-table th, .rules-table td {
            border: 1px solid #bbb;
            padding: 7px 12px;
            text-align: center;
        }
        .rules-table th {
            background: #e0e0e0;
            color: #222;
        }
        .rules-table td {
            background: #fff;
        }
        .idp-scoring-section {
            max-width: 900px;
            margin: 30px auto;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 32px 28px 24px 28px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.07);
        }
        .idp-scoring-section h2 {
            color: #4a148c;
            margin-top: 0;
            text-align: center;
            margin-bottom: 24px;
        }
        .idp-scoring-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .idp-scoring-table th {
            background: #4a148c;
            color: white;
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
        }
        .idp-scoring-table td {
            padding: 10px 16px;
            border-bottom: 1px solid #eee;
        }
        .idp-scoring-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        .idp-scoring-table tr:hover {
            background: #e9ecef;
        }
        .idp-error {
            color: #dc3545;
            text-align: center;
            padding: 20px;
            background: #f8d7da;
            border-radius: 8px;
            border: 1px solid #f5c6cb;
        }
        .scoring-rules {
            margin-bottom: 40px;
        }
        .scoring-rules h3 {
            color: #4a148c;
            margin-bottom: 16px;
            text-align: center;
        }
        .player-rankings h3 {
            color: #4a148c;
            margin-bottom: 16px;
            text-align: center;
        }
        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
        }
        .note {
            background: #e3f2fd;
            padding: 16px;
            border-radius: 8px;
            border-left: 4px solid #2196f3;
            margin-top: 20px;
        }
        .note p {
            margin: 0;
            color: #1565c0;
            font-size: 14px;
        }
        .sortable {
            cursor: pointer;
            user-select: none;
            position: relative;
        }
        .sortable:hover {
            background: #3a1b5a !important;
        }
        .sortable.asc::after {
            content: ' ↑';
            opacity: 1;
        }
        .sortable.desc::after {
            content: ' ↓';
            opacity: 1;
        }

        /* The Run Tab Styles */
        .run-container {
            padding: 20px;
            background: #1a202c;
            border-radius: 8px;
            margin: 20px;
        }

        .run-container h2 {
            color: #f7fafc;
            margin-bottom: 20px;
            text-align: center;
            font-size: 24px;
        }

        .chart-controls {
            margin-bottom: 20px;
            text-align: center;
        }

        .chart-controls button {
            margin-right: 10px;
            padding: 8px 16px;
            background: #4299e1;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
        }

        .chart-controls button:hover {
            background: #3182ce;
        }

        .chart-wrapper {
            height: 520px !important;
            margin: 0 auto 15px auto;
            position: relative;
            overflow: visible;
            background: linear-gradient(135deg, 
                #0A1F33 0%,     /* Deep Midnight Blue */
                #004D40 25%,    /* Deep Teal */
                #1B3B63 50%,    /* Dark Steel Blue */
                #00695C 75%,    /* Strong Sea Green */
                #244C7E 100%    /* Royal Blue */
            );
            border-radius: 12px;
            padding: 15px;
            box-shadow: 
                0 8px 32px rgba(10, 31, 51, 0.3),
                0 4px 16px rgba(0, 77, 64, 0.2);
            border: 1px solid rgba(57, 112, 181, 0.3);
            opacity: 1 !important;
            visibility: visible !important;
            max-width: 95%;
        }

        .chart-wrapper canvas {
            background-color: transparent !important;
            max-height: 100% !important;
            max-width: 100% !important;
            border-radius: 8px;
            opacity: 1 !important;
            visibility: visible !important;
        }

        /* Update the main container for tri-color theme */
        .run-container {
            padding: 25px;
            background: linear-gradient(180deg, 
                #0A1F33 0%,     /* Deep Midnight Blue */
                #004D40 50%,    /* Deep Teal */
                #1B3B63 100%    /* Dark Steel Blue */
            );
            border-radius: 12px;
            margin: 20px auto;
            max-width: 1400px;
            border: 1px solid rgba(0, 105, 92, 0.3);
        }

        /* Update title styling for the new theme */
        .run-container h2 {
            color: #B4E0FF;  /* Pale Powder Blue */
            text-shadow: 0 2px 8px rgba(10, 31, 51, 0.8);
            margin-bottom: 20px;
            text-align: center;
        }

        /* Update button styling to match tri-color theme */
        .chart-controls button {
            margin-right: 12px;
            padding: 12px 20px;
            background: linear-gradient(45deg, #244C7E, #00897B);  /* Royal Blue to Aqua Teal */
            color: #B4E0FF;  /* Pale Powder Blue text */
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 
                0 4px 12px rgba(36, 76, 126, 0.3),
                0 2px 6px rgba(0, 137, 123, 0.2);
            border: 1px solid rgba(57, 112, 181, 0.4);
        }

        .chart-controls button:hover {
            background: linear-gradient(45deg, #3970B5, #26A69A);  /* Bright Denim to Soft Turquoise */
            transform: translateY(-2px);
            box-shadow: 
                0 6px 20px rgba(57, 112, 181, 0.4),
                0 3px 10px rgba(38, 166, 154, 0.3);
            color: #FFFFFF;
        }

        .chart-controls button:active {
            transform: translateY(0);
            background: linear-gradient(45deg, #244C7E, #00695C);  /* Darker variants */
        }

        /* Add special styling for orange accent elements */
        .chart-controls button.orange-accent {
            background: linear-gradient(45deg, #C76B00, #E3882E);  /* Warm Orange to Golden Orange */
            border: 1px solid rgba(199, 107, 0, 0.4);
        }

        .chart-controls button.orange-accent:hover {
            background: linear-gradient(45deg, #E3882E, #F5A552);  /* Golden Orange to Soft Apricot */
            box-shadow: 
                0 6px 20px rgba(199, 107, 0, 0.4),
                0 3px 10px rgba(227, 136, 46, 0.3);
        }

        .elimination-tracker {
            background: rgba(10, 31, 51, 0.3);
            border-radius: 8px;
            padding: 12px 15px;
            margin-top: 15px;
            border: 1px solid rgba(121, 196, 255, 0.2);
        }

        .elimination-legend {
            display: flex;
            align-items: center;
            gap: 20px;
            font-size: 12px;
            color: #B4E0FF;
        }

        .elimination-legend span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* View Mode Toggle */
        .view-toggle {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }
        .view-toggle .toggle-btn {
            padding: 8px 14px;
            border-radius: 6px;
            border: 1px solid rgba(57,112,181,0.4);
            background: linear-gradient(45deg, #244C7E, #00897B);
            color: #B4E0FF;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .view-toggle .toggle-btn.active {
            background: linear-gradient(45deg, #3970B5, #26A69A);
            color: #ffffff;
            box-shadow: 0 4px 12px rgba(36, 76, 126, 0.3);
        }
        .view-toggle .toggle-btn:focus { outline: none; }

        /* Mobile mode overrides */
        body.mobile-mode .container { max-width: 480px; margin: 0 auto; padding: 10px; }
        body.mobile-mode .header { padding: 12px; }
        body.mobile-mode .tabs-header { overflow-x: auto; white-space: nowrap; }
        body.mobile-mode .tab-button { padding: 10px 12px; font-size: 0.9rem; }
        body.mobile-mode .subtabs-header {
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            padding-right: 16px;      /* avoids cutting off last tab */
            scroll-padding-right: 24px;
        }
        /* Hide The Run subtab and its content on mobile */
        body.mobile-mode .subtabs-header .subtab-button[data-subtab="final-standings"] { display: none !important; }
        body.mobile-mode #final-standings { display: none !important; }
        body.mobile-mode .subtabs-header .subtab-button { flex: 0 0 auto; }
        body.mobile-mode .subtabs-header .subtab-button:last-child { margin-right: 8px; }
        body.mobile-mode .subtab-button { padding: 8px 10px; font-size: 0.85rem; }
        body.mobile-mode .chart-wrapper { height: 360px !important; max-width: 100% !important; }
        body.mobile-mode .horizontal-sections-container { display: block; }
        body.mobile-mode .horizontal-tournament-section { width: 100%; margin: 10px 0; }
        body.mobile-mode table.data-table th, body.mobile-mode table.data-table td { padding: 6px; font-size: 12px; }
        body.mobile-mode .standings-card { padding: 10px !important; }
        body.mobile-mode #standings-grid { display: grid !important; grid-template-columns: 1fr !important; gap: 10px !important; }
        body.mobile-mode .duel-of-fates-video { display: none !important; }

        /* Utility visibility helpers for mobile/desktop within viz */
        .desktop-only { display: inline; }
        .mobile-only { display: none; }
        #quantum-gauntlet-viz.is-mobile .desktop-only { display: none; }
        #quantum-gauntlet-viz.is-mobile .mobile-only { display: inline; }

        /* ==============================
           Quantum Gauntlet: Mobile Mode
           (scoped to #quantum-gauntlet-viz.is-mobile)
           ============================== */
        #quantum-gauntlet-viz.is-mobile {
          --gutter: 12px;
          --gutter-lg: 16px;
          --card-pad: 12px;
          --radius: 12px;
          --fs-title: clamp(18px, 4vw, 22px);
          --fs-sub: clamp(14px, 3.6vw, 16px);
          --fs-body: clamp(13px, 3.4vw, 15px);
        }

        #quantum-gauntlet-viz.is-mobile .tournament-header,
        #quantum-gauntlet-viz.is-mobile .phases-header,
        #quantum-gauntlet-viz.is-mobile .horizontal-section-header,
        #quantum-gauntlet-viz.is-mobile .column-header { padding: var(--card-pad); }

        #quantum-gauntlet-viz.is-mobile .tournament-title { font-size: var(--fs-title); }
        #quantum-gauntlet-viz.is-mobile .tournament-subtitle { font-size: var(--fs-sub); }

        #quantum-gauntlet-viz.is-mobile .tournament-bracket,
        #quantum-gauntlet-viz.is-mobile .horizontal-sections-container,
        #quantum-gauntlet-viz.is-mobile .week13-horizontal-container,
        #quantum-gauntlet-viz.is-mobile .playoff-horizontal-container,
        #quantum-gauntlet-viz.is-mobile .duel-horizontal-container,
        #quantum-gauntlet-viz.is-mobile .week16-container,
        #quantum-gauntlet-viz.is-mobile .week17-container {
          width: 100%;
          max-width: 100%;
          overflow-x: hidden;
          padding: 0 var(--card-pad);
          box-sizing: border-box;
        }

        #quantum-gauntlet-viz.is-mobile .horizontal-tournament-section {
          display: block;
          border-radius: var(--radius);
          padding: var(--card-pad);
          margin-bottom: var(--gutter-lg);
        }

        #quantum-gauntlet-viz.is-mobile .seeding-results-grid { display: grid; grid-template-columns: 1fr; gap: var(--gutter-lg); }
        #quantum-gauntlet-viz.is-mobile .seed-category .seed-row { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: var(--gutter); }
        @media (max-width: 380px) { #quantum-gauntlet-viz.is-mobile .seed-category .seed-row { grid-template-columns: 1fr; } }
        #quantum-gauntlet-viz.is-mobile .seed-box { min-width: 0; width: auto; padding: 10px; border-radius: var(--radius); }
        #quantum-gauntlet-viz.is-mobile .seed-team,
        #quantum-gauntlet-viz.is-mobile .seed-status,
        #quantum-gauntlet-viz.is-mobile .participant-name { font-size: var(--fs-body); white-space: normal; word-break: break-word; }

        #quantum-gauntlet-viz.is-mobile .horizontal-participant { display: grid; grid-template-columns: 1fr; gap: 8px; padding: 10px; border-radius: var(--radius); }
        #quantum-gauntlet-viz.is-mobile .participant-header { display: flex; align-items: center; gap: 8px; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring { display: grid; grid-template-columns: auto auto auto auto; grid-template-areas: "w14 plus w15 equals" "total total total total"; gap: 6px 10px; align-items: center; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .week-score:first-child { grid-area: w14; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .score-plus { grid-area: plus; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .week-score:nth-of-type(2) { grid-area: w15; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .score-equals { grid-area: equals; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .total-score { grid-area: total; justify-self: start; }
        #quantum-gauntlet-viz.is-mobile .week-score .week-label,
        #quantum-gauntlet-viz.is-mobile .total-score .total-label { font-size: var(--fs-sub); }

        #quantum-gauntlet-viz.is-mobile .duel-horizontal-container { display: grid; grid-template-columns: 1fr; gap: var(--gutter); }
        #quantum-gauntlet-viz.is-mobile .vs-indicator { order: 3; margin: 4px 0 0; text-align: center; }

        #quantum-gauntlet-viz.is-mobile .playoff-competitors-grid { display: grid; grid-template-columns: 1fr; gap: var(--gutter); }
        #quantum-gauntlet-viz.is-mobile .playoff-advancement .advancement-slots { display: grid; grid-template-columns: 1fr; gap: 8px; }

        #quantum-gauntlet-viz.is-mobile .wildcard-competitors { display: grid; grid-template-columns: repeat(2, minmax(0, 1fr)); gap: var(--gutter); }
        @media (max-width: 380px) { #quantum-gauntlet-viz.is-mobile .wildcard-competitors { grid-template-columns: 1fr; } }

        #quantum-gauntlet-viz.is-mobile .vertical-columns-container { display: grid; grid-template-columns: 1fr; gap: var(--gutter-lg); padding: 0 var(--card-pad); }
        #quantum-gauntlet-viz.is-mobile .tournament-column { border-radius: var(--radius); padding: var(--card-pad); }

        #quantum-gauntlet-viz.is-mobile .tournament-info-panel { position: fixed; left: 0; right: 0; bottom: 0; max-height: 70vh; transform: translateY(100%); transition: transform 200ms ease; overflow: auto; padding-bottom: max(16px, env(safe-area-inset-bottom)); z-index: 50; }
        #quantum-gauntlet-viz.is-mobile .tournament-info-panel.is-open { transform: translateY(0); }

        #quantum-gauntlet-viz.is-mobile .week-indicators,
        #quantum-gauntlet-viz.is-mobile .advancement-explanation { display: flex; flex-wrap: wrap; gap: 6px; font-size: var(--fs-body); }

        #quantum-gauntlet-viz.is-mobile .seed-box,
        #quantum-gauntlet-viz.is-mobile .auto-playoff-participant,
        #quantum-gauntlet-viz.is-mobile .wildcard-competitor,
        #quantum-gauntlet-viz.is-mobile .conference-team,
        #quantum-gauntlet-viz.is-mobile .championship-team,
        #quantum-gauntlet-viz.is-mobile .advance-slot { width: 100%; max-width: 100%; box-sizing: border-box; }

        #quantum-gauntlet-viz.is-mobile .horizontal-section-header h3,
        #quantum-gauntlet-viz.is-mobile .column-header h3 { font-size: var(--fs-title); }
        #quantum-gauntlet-viz.is-mobile p,
        #quantum-gauntlet-viz.is-mobile li { font-size: var(--fs-body); line-height: 1.25; }
        #quantum-gauntlet-viz.is-mobile .section-label,
        #quantum-gauntlet-viz.is-mobile .champion-crown { font-size: clamp(18px, 5vw, 22px); }

        /* Week 13 Results: make seeding grid vertical */
        #quantum-gauntlet-viz.is-mobile .week13-horizontal-container .seeding-results-grid {
          display: flex;
          flex-direction: column;
          gap: 12px;
        }
        #quantum-gauntlet-viz.is-mobile .week13-horizontal-container .seed-category { width: 100%; }
        #quantum-gauntlet-viz.is-mobile .week13-horizontal-container .seed-row {
          display: flex;
          flex-direction: column;
          gap: 8px;
        }
        #quantum-gauntlet-viz.is-mobile .week13-horizontal-container .seed-box { width: 100%; box-sizing: border-box; }

        /* Week 14 + 15: stack like Week 16 */
        #quantum-gauntlet-viz.is-mobile .duel-horizontal-container,
        #quantum-gauntlet-viz.is-mobile .playoff-horizontal-container,
        #quantum-gauntlet-viz.is-mobile .wildcard-competitors {
          display: flex;
          flex-direction: column;
          gap: 12px;
        }
        #quantum-gauntlet-viz.is-mobile .duel-participant,
        #quantum-gauntlet-viz.is-mobile .auto-playoff-participant,
        #quantum-gauntlet-viz.is-mobile .wildcard-competitor {
          width: 100%;
          box-sizing: border-box;
        }
        /* Center VS indicator/prize notes */
        #quantum-gauntlet-viz.is-mobile .vs-indicator { align-self: center; text-align: center; }
        /* Playoff advancement slots stacked */
        #quantum-gauntlet-viz.is-mobile .playoff-advancement .advancement-slots {
          display: flex;
          flex-direction: column;
          gap: 8px;
        }

        /* ---------- MOBILE LAYOUT HARD LIMITS ---------- */
        #quantum-gauntlet-viz.is-mobile {
          --mobile-card-max: 560px;   /* match Week 16 visual width; adjust as needed */
          --card-pad: 12px;
        }

        /* Force Week 13 + Week 14–15 sections to a centered card width (like Week 16) */
        #quantum-gauntlet-viz.is-mobile .week13-horizontal-section,
        #quantum-gauntlet-viz.is-mobile .simultaneous-phases-container,
        #quantum-gauntlet-viz.is-mobile #duel-horizontal-section,
        #quantum-gauntlet-viz.is-mobile #playoff-horizontal-section,
        #quantum-gauntlet-viz.is-mobile #wildcard-horizontal-section {
          max-width: var(--mobile-card-max);
          margin-inline: auto;
          padding-inline: var(--card-pad);
          width: 100%;
          box-sizing: border-box;
        }

        /* Kill any accidental sideways scroll at the root */
        #quantum-gauntlet-viz.is-mobile,
        #quantum-gauntlet-viz.is-mobile * { box-sizing: border-box; }
        #quantum-gauntlet-viz.is-mobile { overflow-x: hidden; }

        /* Week 13: stack categories and seed rows like cards */
        #quantum-gauntlet-viz.is-mobile .week13-horizontal-container .seeding-results-grid {
          display: grid;
          grid-template-columns: 1fr;
          gap: 12px;
        }
        #quantum-gauntlet-viz.is-mobile .week13-horizontal-container .seed-category { width: 100%; }
        #quantum-gauntlet-viz.is-mobile .week13-horizontal-container .seed-row { display: grid; grid-template-columns: 1fr; gap: 8px; }

        /* Week 14–15 (Duel, Playoff): stack participants one-per-row */
        #quantum-gauntlet-viz.is-mobile .duel-horizontal-container,
        #quantum-gauntlet-viz.is-mobile .playoff-horizontal-container { display: grid; grid-template-columns: 1fr; gap: 12px; }

        /* Wildcard competitors: single column by default */
        #quantum-gauntlet-viz.is-mobile .wildcard-competitors { display: grid; grid-template-columns: 1fr; gap: 10px; }

        /* Advancement slots as full-width stack */
        #quantum-gauntlet-viz.is-mobile .playoff-advancement .advancement-slots { display: grid; grid-template-columns: 1fr; gap: 8px; }

        /* Make all card children shrink within the card */
        #quantum-gauntlet-viz.is-mobile .seed-box,
        #quantum-gauntlet-viz.is-mobile .horizontal-participant,
        #quantum-gauntlet-viz.is-mobile .auto-playoff-participant,
        #quantum-gauntlet-viz.is-mobile .wildcard-competitor,
        #quantum-gauntlet-viz.is-mobile .advance-slot,
        #quantum-gauntlet-viz.is-mobile .conference-team,
        #quantum-gauntlet-viz.is-mobile .championship-team {
          min-width: 0;
          max-width: 100%;
          width: 100%;
        }

        /* Score rows: math on one row, total below */
        #quantum-gauntlet-viz.is-mobile .participant-scoring {
          display: grid;
          grid-template-columns: auto auto auto auto;
          grid-template-areas:
            "w14 plus w15 equals"
            "total total total total";
          gap: 6px 10px;
          align-items: center;
        }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .week-score:first-child { grid-area: w14; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .score-plus { grid-area: plus; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .week-score:nth-of-type(2) { grid-area: w15; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .score-equals { grid-area: equals; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .total-score { grid-area: total; justify-self: start; }

        /* Allow labels and long names to wrap */
        #quantum-gauntlet-viz.is-mobile .seed-team,
        #quantum-gauntlet-viz.is-mobile .seed-status,
        #quantum-gauntlet-viz.is-mobile .participant-name,
        #quantum-gauntlet-viz.is-mobile .week-indicators { white-space: normal; word-break: break-word; }

        /* ===== MOBILE HARD CONSTRAINTS & OVERFLOW GUARD ===== */
        html, body { width: 100%; max-width: 100%; overflow-x: hidden; }

        #quantum-gauntlet-viz.is-mobile {
          --mobile-card-max: 560px;    /* adjust to 520/500 if desired */
          --pad-inline: 14px;
          width: 100%;
          max-width: 100vw;
          margin: 0;
          padding-inline: var(--pad-inline);
          box-sizing: border-box;
          overflow-x: hidden;
        }

        /* Main wrappers may not exceed viewport */
        #quantum-gauntlet-viz.is-mobile .tournament-bracket,
        #quantum-gauntlet-viz.is-mobile .week13-horizontal-section,
        #quantum-gauntlet-viz.is-mobile .simultaneous-phases-container,
        #quantum-gauntlet-viz.is-mobile #duel-horizontal-section,
        #quantum-gauntlet-viz.is-mobile #playoff-horizontal-section,
        #quantum-gauntlet-viz.is-mobile #wildcard-horizontal-section,
        #quantum-gauntlet-viz.is-mobile .vertical-columns-container {
          width: 100%;
          max-width: min(var(--mobile-card-max), 100%);
          margin-inline: auto;
          padding-inline: 0;
          box-sizing: border-box;
          position: static !important;
          transform: none !important;
          left: auto !important;
          right: auto !important;
        }

        /* Ensure all inner boxes shrink inside viewport */
        #quantum-gauntlet-viz.is-mobile * { box-sizing: border-box; }
        #quantum-gauntlet-viz.is-mobile .seed-box,
        #quantum-gauntlet-viz.is-mobile .horizontal-participant,
        #quantum-gauntlet-viz.is-mobile .auto-playoff-participant,
        #quantum-gauntlet-viz.is-mobile .wildcard-competitor,
        #quantum-gauntlet-viz.is-mobile .advance-slot,
        #quantum-gauntlet-viz.is-mobile .conference-team,
        #quantum-gauntlet-viz.is-mobile .championship-team,
        #quantum-gauntlet-viz.is-mobile .week-indicators,
        #quantum-gauntlet-viz.is-mobile .horizontal-section-header,
        #quantum-gauntlet-viz.is-mobile .phases-header,
        #quantum-gauntlet-viz.is-mobile .column-header {
          min-width: 0;
          max-width: 100%;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: normal;
          word-break: break-word;
        }

        /* Single-column stacks for horizontal areas */
        #quantum-gauntlet-viz.is-mobile .week13-horizontal-container .seeding-results-grid,
        #quantum-gauntlet-viz.is-mobile .duel-horizontal-container,
        #quantum-gauntlet-viz.is-mobile .playoff-horizontal-container,
        #quantum-gauntlet-viz.is-mobile .playoff-competitors-grid,
        #quantum-gauntlet-viz.is-mobile .wildcard-competitors,
        #quantum-gauntlet-viz.is-mobile .playoff-advancement .advancement-slots {
          display: grid;
          grid-template-columns: 1fr;
          gap: 12px;
        }

        /* Week 13 seed rows as single-column */
        #quantum-gauntlet-viz.is-mobile .week13-horizontal-container .seed-row { display: grid; grid-template-columns: 1fr; gap: 8px; }

        /* Score line reflow (math row + total row) */
        #quantum-gauntlet-viz.is-mobile .participant-scoring {
          display: grid;
          grid-template-columns: auto auto auto auto;
          grid-template-areas: "w14 plus w15 equals" "total total total total";
          gap: 6px 10px;
          align-items: center;
        }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .week-score:first-child { grid-area: w14; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .score-plus { grid-area: plus; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .week-score:nth-of-type(2) { grid-area: w15; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .score-equals { grid-area: equals; }
        #quantum-gauntlet-viz.is-mobile .participant-scoring .total-score { grid-area: total; justify-self: start; }

        /* VS indicator centering */
        #quantum-gauntlet-viz.is-mobile .vs-indicator { text-align: center; }

        /* Media never exceed card */
        #quantum-gauntlet-viz.is-mobile img,
        #quantum-gauntlet-viz.is-mobile svg,
        #quantum-gauntlet-viz.is-mobile canvas { max-width: 100%; height: auto; }

        /* ===== QUANTUM GAUNTLET — MOBILE HOTFIX (place LAST) ===== */
        @media (max-width: 820px) {
          /* 0) Root guards: kill sideways scroll page-wide */
          html, body { max-width: 100%; overflow-x: hidden; }

          /* 1) Viz root must fit the screen and not push right */
          #quantum-gauntlet-viz {
            width: 100% !important;
            max-width: 100vw !important;
            margin: 0 auto !important;
            padding: 12px !important;
            box-sizing: border-box !important;
            overflow-x: hidden !important;
            position: relative !important;
            transform: none !important;
            left: auto !important; right: auto !important;
          }

          /* 2) Clamp ALL top-level blocks inside the viz */
          #quantum-gauntlet-viz .tournament-header,
          #quantum-gauntlet-viz .tournament-bracket,
          #quantum-gauntlet-viz .week13-horizontal-section,
          #quantum-gauntlet-viz .week13-horizontal-container,
          #quantum-gauntlet-viz .simultaneous-phases-container,
          #quantum-gauntlet-viz .horizontal-sections-container,
          #quantum-gauntlet-viz #duel-horizontal-section,
          #quantum-gauntlet-viz #playoff-horizontal-section,
          #quantum-gauntlet-viz #wildcard-horizontal-section,
          #quantum-gauntlet-viz .vertical-columns-container,
          #quantum-gauntlet-viz .week16-container,
          #quantum-gauntlet-viz .week17-container,
          #quantum-gauntlet-viz .tournament-info-panel {
            width: 100% !important;
            max-width: 100% !important;
            margin: 0 auto !important;
            padding: 0 !important;
            box-sizing: border-box !important;
            position: static !important;
            transform: none !important;
            left: auto !important; right: auto !important;
          }

          /* 3) Make ALL children shrink instead of forcing overflow */
          #quantum-gauntlet-viz * {
            box-sizing: border-box;
            min-width: 0 !important;
            max-width: 100% !important;
            white-space: normal !important;
            word-break: break-word !important;
          }

          /* 4) Turn every “horizontal” area into a ONE-COLUMN stack */
          #quantum-gauntlet-viz .seeding-results-grid,
          #quantum-gauntlet-viz .week13-horizontal-container .seed-row,
          #quantum-gauntlet-viz .duel-horizontal-container,
          #quantum-gauntlet-viz .playoff-horizontal-container,
          #quantum-gauntlet-viz .playoff-competitors-grid,
          #quantum-gauntlet-viz .wildcard-competitors,
          #quantum-gauntlet-viz .playoff-advancement .advancement-slots,
          #quantum-gauntlet-viz .conference-participants,
          #quantum-gauntlet-viz .championship-participants {
            display: grid !important;
            grid-template-columns: 1fr !important;
            gap: 12px !important;
          }

          /* 5) Each “card” fills the column width */
          #quantum-gauntlet-viz .seed-box,
          #quantum-gauntlet-viz .horizontal-participant,
          #quantum-gauntlet-viz .auto-playoff-participant,
          #quantum-gauntlet-viz .wildcard-competitor,
          #quantum-gauntlet-viz .conference-team,
          #quantum-gauntlet-viz .championship-team,
          #quantum-gauntlet-viz .advance-slot {
            width: 100% !important;
            max-width: 100% !important;
          }

          /* 6) Score line: math on row 1, total on row 2 */
          #quantum-gauntlet-viz .participant-scoring {
            display: grid !important;
            grid-template-columns: auto auto auto auto !important;
            grid-template-areas:
              "w14 plus w15 equals"
              "total total total total" !important;
            gap: 6px 10px !important;
            align-items: center !important;
          }
          #quantum-gauntlet-viz .participant-scoring .week-score:first-child { grid-area: w14; }
          #quantum-gauntlet-viz .participant-scoring .score-plus { grid-area: plus; }
          #quantum-gauntlet-viz .participant-scoring .week-score:nth-of-type(2) { grid-area: w15; }
          #quantum-gauntlet-viz .participant-scoring .score-equals { grid-area: equals; }
          #quantum-gauntlet-viz .participant-scoring .total-score { grid-area: total; justify-self: start; }

          /* 7) Center the VS badge under the two duel cards */
          #quantum-gauntlet-viz .vs-indicator { text-align: center !important; }

          /* 8) Media never exceeds the column width */
          #quantum-gauntlet-viz img,
          #quantum-gauntlet-viz svg,
          #quantum-gauntlet-viz canvas { max-width: 100% !important; height: auto !important; }
        }
        /* ====== MOBILE OVERRIDES (place last) ====== */
        @media (max-width: 820px) {
          /* Root: no sideways scroll, small inner padding */
          html, body { max-width: 100%; overflow-x: hidden; }
          #quantum-gauntlet-viz { padding-inline: 14px; }

          /* Force mobile mode styles even if class isn't toggled */
          #quantum-gauntlet-viz { --mobile-card-max: 540px; }

          /* Big sections fit viewport and are centered */
          #quantum-gauntlet-viz .tournament-bracket,
          #quantum-gauntlet-viz .week13-horizontal-section,
          #quantum-gauntlet-viz .simultaneous-phases-container,
          #quantum-gauntlet-viz #duel-horizontal-section,
          #quantum-gauntlet-viz #playoff-horizontal-section,
          #quantum-gauntlet-viz #wildcard-horizontal-section,
          #quantum-gauntlet-viz .vertical-columns-container {
            width: 100% !important;
            max-width: min(100%, var(--mobile-card-max)) !important;
            margin: 0 auto !important;
            padding: 0 !important;
            box-sizing: border-box !important;
            position: static !important;
            transform: none !important;
            left: auto !important; right: auto !important;
          }

          /* Clamp inner gradient/wrapper containers */
          #quantum-gauntlet-viz .horizontal-sections-container,
          #quantum-gauntlet-viz .week13-horizontal-container,
          #quantum-gauntlet-viz .week16-container,
          #quantum-gauntlet-viz .week17-container {
            width: 100% !important;
            max-width: 100% !important;
            margin: 0 auto !important;
          }

          /* Allow shrink everywhere */
          #quantum-gauntlet-viz * { box-sizing: border-box; min-width: 0; }

          /* Cards fill width */
          #quantum-gauntlet-viz .seed-box,
          #quantum-gauntlet-viz .horizontal-participant,
          #quantum-gauntlet-viz .auto-playoff-participant,
          #quantum-gauntlet-viz .wildcard-competitor,
          #quantum-gauntlet-viz .advance-slot,
          #quantum-gauntlet-viz .conference-team,
          #quantum-gauntlet-viz .championship-team {
            width: 100% !important;
            max-width: 100% !important;
          }

          /* Collapse multi-column to one column */
          #quantum-gauntlet-viz .seeding-results-grid,
          #quantum-gauntlet-viz .playoff-competitors-grid,
          #quantum-gauntlet-viz .duel-horizontal-container,
          #quantum-gauntlet-viz .playoff-horizontal-container,
          #quantum-gauntlet-viz .wildcard-competitors,
          #quantum-gauntlet-viz .playoff-advancement .advancement-slots,
          #quantum-gauntlet-viz .week13-horizontal-container .seed-row {
            display: grid !important;
            grid-template-columns: 1fr !important;
            gap: 12px !important;
          }

          /* Score line: 2 rows */
          #quantum-gauntlet-viz .participant-scoring {
            display: grid !important;
            grid-template-columns: auto auto auto auto !important;
            grid-template-areas:
              "w14 plus w15 equals"
              "total total total total" !important;
            gap: 6px 10px !important;
            align-items: center !important;
          }
          #quantum-gauntlet-viz .participant-scoring .week-score:first-child { grid-area: w14; }
          #quantum-gauntlet-viz .participant-scoring .score-plus { grid-area: plus; }
          #quantum-gauntlet-viz .participant-scoring .week-score:nth-of-type(2) { grid-area: w15; }
          #quantum-gauntlet-viz .participant-scoring .score-equals { grid-area: equals; }
          #quantum-gauntlet-viz .participant-scoring .total-score { grid-area: total; justify-self: start; }

          /* Wrap long labels */
          #quantum-gauntlet-viz .seed-team,
          #quantum-gauntlet-viz .seed-status,
          #quantum-gauntlet-viz .participant-name,
          #quantum-gauntlet-viz .week-indicators {
            white-space: normal !important;
            word-break: break-word !important;
          }

          /* Slight scale to add breathing room */
          #quantum-gauntlet-viz .horizontal-tournament-section,
          #quantum-gauntlet-viz .vertical-columns-container {
            transform: scale(0.98);
            transform-origin: top center;
          }
        }

        .red-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background-color: #FF0000;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Payouts Container */
        .payouts-container {
            padding: 25px !important;
            background: linear-gradient(180deg, #0A1F33 0%, #004D40 50%, #1B3B63 100%) !important;
            border-radius: 12px;
            margin: 20px 0;
            color: #B4E0FF !important;
            min-height: 400px !important;
            opacity: 1 !important;
            visibility: visible !important;
        }

        /* Ensure tab content is visible */
        #payouts-content {
            display: none !important;
            opacity: 1 !important;
            visibility: visible !important;
            background: transparent !important;
        }

        #payouts-content.active,
        #payouts-content[style*="block"] {
            display: block !important;
        }

        /* Test content styling */
        .test-content {
            color: #B4E0FF !important;
            padding: 15px !important;
            background: rgba(0, 77, 64, 0.3) !important;
            border-radius: 6px !important;
            border-left: 4px solid #26A69A !important;
        }

        /* Debug styles */
        .debug-info {
            background: #FF6B6B !important;
            color: white !important;
            padding: 10px !important;
            margin: 10px 0 !important;
            border-radius: 4px !important;
        }

        /* ADD this CSS for the season toggle */
        .season-toggle-container {
            background: rgba(27, 59, 99, 0.3);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid rgba(121, 196, 255, 0.2);
        }

        .toggle-switch {
            display: flex;
            justify-content: center;
            gap: 0;
            background: rgba(10, 31, 51, 0.5);
            border-radius: 8px;
            padding: 4px;
            max-width: 300px;
            margin: 0 auto;
        }

        .toggle-btn {
            flex: 1;
            padding: 10px 20px;
            border: none;
            background: transparent;
            color: #79C4FF;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.3s ease;
            position: relative;
        }

        .toggle-btn.active {
            background: linear-gradient(45deg, #244C7E, #26A69A);
            color: #FFFFFF;
            box-shadow: 0 2px 8px rgba(36, 76, 126, 0.4);
        }

        .toggle-btn:hover:not(.active) {
            background: rgba(57, 112, 181, 0.2);
            color: #B4E0FF;
        }

        .toggle-label {
            font-weight: 600;
        }

        .season-status {
            opacity: 0.8;
        }

        /* Responsive toggle */
        @media (max-width: 480px) {
            .toggle-switch {
                max-width: 250px;
            }
            
            .toggle-btn {
                padding: 8px 16px;
                font-size: 12px;
            }
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            pointer-events: auto;
        }

        .modal-content {
            background: linear-gradient(135deg, #0A1F33 0%, #1B3B63 100%);
            margin: 10% auto;
            padding: 0;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            border: 2px solid rgba(121, 196, 255, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
            z-index: 10000;
        }

        .modal-header {
            background: rgba(255, 215, 0, 0.1);
            padding: 20px;
            border-bottom: 1px solid rgba(121, 196, 255, 0.2);
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            color: #FFD700;
            margin: 0;
            font-size: 18px;
            font-weight: 600;
        }

        .close-modal {
            color: #79C4FF;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .close-modal:hover {
            color: #FFD700;
        }

        .modal-body {
            padding: 20px;
        }

        .total-earnings {
            text-align: center;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .earnings-label {
            color: #B4E0FF;
            font-size: 14px;
            font-weight: 500;
        }

        .earnings-amount {
            color: #FFD700;
            font-size: 24px;
            font-weight: bold;
            margin-left: 10px;
        }

        .breakdown-item {
            background: rgba(27, 59, 99, 0.4);
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #26A69A;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .breakdown-category {
            color: #B4E0FF;
            font-weight: 500;
            font-size: 14px;
        }

        .breakdown-amount {
            color: #FFD700;
            font-weight: 600;
            font-size: 14px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .modal-content {
                width: 95%;
                margin: 5% auto;
            }
        }

        /* ADD this comprehensive CSS for the tournament visualization */

        .quantum-gauntlet-visualization {
            background: linear-gradient(135deg, #0A1F33 0%, #004D40 25%, #1B3B63 50%, #00695C 75%, #244C7E 100%);
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .tournament-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .tournament-title {
            color: #FFD700;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
        }

        .tournament-subtitle {
            color: #79C4FF;
            font-size: 14px;
            margin: 0;
            font-style: italic;
        }

        /* Tournament Controls */
        .tournament-controls {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 10px 16px;
            background: rgba(27, 59, 99, 0.4);
            color: #79C4FF;
            border: 1px solid rgba(121, 196, 255, 0.3);
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .control-btn:hover {
            background: rgba(57, 112, 181, 0.3);
            color: #B4E0FF;
            transform: translateY(-1px);
        }

        .control-btn.active {
            background: linear-gradient(45deg, #244C7E, #26A69A);
            color: #FFFFFF;
            border-color: rgba(255, 215, 0, 0.5);
            box-shadow: 0 2px 8px rgba(36, 76, 126, 0.4);
        }

        /* Tournament Bracket */
        .tournament-bracket {
            display: flex;
            gap: 20px;
            min-width: 1200px;
            overflow-x: auto;
            padding-bottom: 20px;
        }

        .tournament-column {
            flex: 1;
            min-width: 220px;
            background: rgba(10, 31, 51, 0.3);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(121, 196, 255, 0.2);
            position: relative;
        }

        .column-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(121, 196, 255, 0.3);
        }

        .column-header h3 {
            color: #FFD700;
            font-size: 16px;
            font-weight: 600;
            margin: 0 0 5px 0;
        }

        .column-header p {
            color: #79C4FF;
            font-size: 12px;
            margin: 0;
            font-style: italic;
        }

        /* Seeding Container (Week 13) */
        .seeding-container {
            display: flex;
            flex-direction: row;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: space-between;
        }

        .seed-group {
            background: rgba(27, 59, 99, 0.2);
            border-radius: 8px;
            padding: 12px;
            border-left: 4px solid;
            flex: 1;
            min-width: 200px;
            max-width: 250px;
        }

        .seed-group.byes {
            border-left-color: #FFD700;
        }

        .seed-group.playoffs {
            border-left-color: #559AE0;
        }

        .seed-group.wildcards {
            border-left-color: #E3882E;
        }

        @media (max-width: 768px) {
            .seeding-container {
                flex-direction: column;
            }
        }

        /* Week 13 Horizontal Layout Styles */
        .horizontal-section-header {
            text-align: center;
            padding: 20px;
            background: rgba(0, 31, 63, 0.4);
            border-radius: 10px 10px 0 0;
            border-bottom: 2px solid rgba(121, 196, 255, 0.3);
        }

        .horizontal-section-header h3 {
            color: #FFD700;
            font-size: 24px;
            margin-bottom: 10px;
        }

        .horizontal-section-header p {
            color: #B4E0FF;
            font-size: 14px;
            margin-bottom: 15px;
        }

        .week-indicators {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .week-badge, .result-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .week-badge.active {
            background: rgba(255, 215, 0, 0.2);
            color: #FFD700;
            border: 1px solid #FFD700;
        }

        .result-badge {
            background: rgba(85, 154, 224, 0.2);
            color: #559AE0;
            border: 1px solid #559AE0;
        }

        .week13-horizontal-container {
            padding: 20px;
        }

        .seeding-results-grid {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            gap: 20px;
        }

        .seed-category {
            background: rgba(10, 31, 51, 0.3);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(121, 196, 255, 0.2);
            flex: 1;
        }

        .category-header {
            color: #FFD700;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 215, 0, 0.3);
        }

        .seed-row {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Grid layout for Auto Playoff (2x2) */
        .auto-playoff .seed-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 10px;
        }

        /* Grid layout for Wildcard Battle (3x2) */
        .wildcard-battle .seed-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 10px;
        }

        .seed-box {
            background: rgba(27, 59, 99, 0.4);
            border-radius: 8px;
            padding: 10px;
            width: 140px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .seed-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .seed-box.gold-seed {
            border-color: #FFD700;
            background: rgba(255, 215, 0, 0.1);
        }

        .seed-box.blue-seed {
            border-color: #559AE0;
            background: rgba(85, 154, 224, 0.1);
        }

        .seed-box.orange-seed {
            border-color: #E3882E;
            background: rgba(227, 136, 46, 0.1);
        }

        .seed-number {
            color: #FFD700;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 8px;
        }

        .seed-team {
            color: #B4E0FF;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .seed-status {
            color: #79C4FF;
            font-size: 11px;
            font-style: italic;
        }

        /* Responsive Design for Week 13 Horizontal */
        @media (max-width: 768px) {
            .seeding-results-grid {
                flex-direction: column;
                gap: 25px;
            }
            
            .seed-category {
                flex: none;
            }
            
            .seed-row {
                flex-direction: column;
                align-items: center;
            }
            
            /* Reset grid layouts to flex on mobile */
            .auto-playoff .seed-row,
            .wildcard-battle .seed-row {
                display: flex;
                flex-direction: column;
                align-items: center;
                grid-template-columns: none;
                grid-template-rows: none;
            }
            
            .seed-box {
                width: 200px;
            }
        }

        /* Simultaneous Phases Container */
        .simultaneous-phases-container {
            background: linear-gradient(135deg, 
                rgba(255, 215, 0, 0.08) 0%,     /* Gold tint */
                rgba(85, 154, 224, 0.08) 50%,   /* Blue tint */
                rgba(227, 136, 46, 0.08) 100%   /* Orange tint */
            );
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            position: relative;
            overflow: hidden;
        }

        /* Add animated background pattern */
        .simultaneous-phases-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 20px,
                rgba(255, 215, 0, 0.03) 20px,
                rgba(255, 215, 0, 0.03) 40px
            );
            pointer-events: none;
            z-index: 0;
        }

        /* Phases Header */
        .phases-header {
            text-align: center;
            margin-bottom: 25px;
            position: relative;
            z-index: 1;
        }

        .phases-header h2 {
            color: #FFD700;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
        }

        .phases-header p {
            color: #B4E0FF;
            font-size: 14px;
            margin-bottom: 15px;
            font-style: italic;
        }

        .timing-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .timing-badge {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #0A1F33;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 12px;
            letter-spacing: 1px;
            animation: pulse 2s infinite;
        }

        .timing-details {
            color: #79C4FF;
            font-size: 12px;
            font-style: italic;
        }

        @keyframes pulse {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
            }
            50% { 
                transform: scale(1.05);
                box-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
            }
        }

        /* Ensure sections are properly positioned */
        .horizontal-sections-container {
            position: relative;
            z-index: 1;
        }



        /* Responsive adjustments */
        @media (max-width: 768px) {
            .simultaneous-phases-container {
                padding: 15px;
                margin: 15px 0;
            }
            
            .phases-header h2 {
                font-size: 20px;
            }
            
            .timing-indicator {
                flex-direction: column;
                gap: 8px;
            }
        }

        .group-label {
            color: #B4E0FF;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 8px;
            text-align: center;
        }

        .seed-slot {
            background: rgba(0, 77, 64, 0.3);
            border-radius: 6px;
            padding: 8px;
            margin-bottom: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .seed-slot:hover {
            background: rgba(0, 77, 64, 0.5);
            border-color: rgba(121, 196, 255, 0.5);
            transform: translateX(3px);
        }

        .seed-slot.bye-seed:hover {
            border-color: rgba(255, 215, 0, 0.5);
        }

        .seed-slot.playoff-seed:hover {
            border-color: rgba(85, 154, 224, 0.5);
        }

        .seed-slot.wildcard-seed:hover {
            border-color: rgba(227, 136, 46, 0.5);
        }

        .seed-number {
            color: #FFD700;
            font-weight: bold;
            font-size: 14px;
        }

        .seed-team {
            color: #B4E0FF;
            font-size: 12px;
            font-weight: 500;
            margin: 2px 0;
        }

        .seed-status {
            color: #79C4FF;
            font-size: 10px;
            font-style: italic;
        }

        /* Week 14 Styles */
        .week14-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .bye-section, .playoff-section {
            background: rgba(27, 59, 99, 0.2);
            border-radius: 8px;
            padding: 10px;
        }

        .section-label {
            color: #B4E0FF;
            font-size: 11px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 8px;
        }

        .bye-team, .playoff-team {
            background: rgba(0, 77, 64, 0.3);
            border-radius: 4px;
            padding: 6px 8px;
            margin-bottom: 4px;
            color: #B4E0FF;
            font-size: 11px;
            text-align: center;
        }

        .wildcard-battle {
            background: rgba(227, 136, 46, 0.1);
            border-radius: 8px;
            padding: 12px;
            border: 1px solid rgba(227, 136, 46, 0.3);
        }

        .wildcard-arena {
            position: relative;
        }

        .wildcard-team {
            background: rgba(227, 136, 46, 0.2);
            border-radius: 4px;
            padding: 4px 6px;
            margin-bottom: 3px;
            color: #B4E0FF;
            font-size: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .wildcard-team:hover {
            background: rgba(227, 136, 46, 0.4);
            transform: scale(1.02);
        }

        .battle-arrow {
            text-align: center;
            font-size: 20px;
            color: #FFD700;
            margin: 8px 0;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        .winner-slot {
            background: rgba(255, 215, 0, 0.2);
            border-radius: 6px;
            padding: 8px;
            border: 2px solid rgba(255, 215, 0, 0.5);
            text-align: center;
        }

        .winner-label {
            color: #FFD700;
            font-size: 11px;
            font-weight: 600;
        }

        .winner-team {
            color: #B4E0FF;
            font-size: 10px;
            margin-top: 2px;
        }

        .toilet-bowl {
            background: rgba(139, 69, 19, 0.1);
            border-radius: 8px;
            padding: 10px;
            border: 1px solid rgba(139, 69, 19, 0.3);
        }

        .toilet-teams {
            text-align: center;
        }

        .toilet-message {
            color: #8B4513;
            font-size: 11px;
            font-style: italic;
        }

        /* Week 15 Styles */
        .week15-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .divisional-battle {
            background: rgba(85, 154, 224, 0.1);
            border-radius: 8px;
            padding: 12px;
            border: 1px solid rgba(85, 154, 224, 0.3);
        }

        .divisional-arena {
            position: relative;
        }

        .divisional-team {
            background: rgba(85, 154, 224, 0.2);
            border-radius: 4px;
            padding: 6px 8px;
            margin-bottom: 4px;
            color: #B4E0FF;
            font-size: 11px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .divisional-team:hover {
            background: rgba(85, 154, 224, 0.4);
            transform: scale(1.02);
        }

        .wildcard-in-div {
            border: 1px solid rgba(227, 136, 46, 0.5);
            background: rgba(227, 136, 46, 0.2);
        }

        .advancement-slot {
            background: rgba(255, 215, 0, 0.2);
            border-radius: 6px;
            padding: 8px;
            border: 2px solid rgba(255, 215, 0, 0.5);
            text-align: center;
            margin-top: 10px;
        }

        .advance-label {
            color: #FFD700;
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .advance-teams {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .qualifier {
            background: rgba(38, 166, 154, 0.3);
            border-radius: 3px;
            padding: 3px 6px;
            color: #B4E0FF;
            font-size: 10px;
        }

        .elimination-section {
            background: rgba(139, 69, 19, 0.1);
            border-radius: 8px;
            padding: 10px;
            border: 1px solid rgba(139, 69, 19, 0.3);
        }

        .eliminated-teams {
            text-align: center;
        }

        .eliminated-message {
            color: #8B4513;
            font-size: 11px;
            font-style: italic;
        }

        /* Week 16 Styles */
        .week16-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .conference-championship {
            background: rgba(255, 215, 0, 0.1);
            border-radius: 8px;
            padding: 12px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .conference-arena {
            position: relative;
        }

        .conference-team {
            background: rgba(255, 215, 0, 0.2);
            border-radius: 4px;
            padding: 6px 8px;
            margin-bottom: 4px;
            color: #B4E0FF;
            font-size: 11px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .conference-team:hover {
            background: rgba(255, 215, 0, 0.4);
            transform: scale(1.02);
        }

        .finals-slot {
            background: rgba(38, 166, 154, 0.2);
            border-radius: 6px;
            padding: 8px;
            border: 2px solid rgba(38, 166, 154, 0.5);
            text-align: center;
            margin-top: 10px;
        }

        .finals-label {
            color: #26A69A;
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .finalists {
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .finalist {
            background: rgba(38, 166, 154, 0.3);
            border-radius: 3px;
            padding: 3px 6px;
            color: #B4E0FF;
            font-size: 10px;
        }

        .conference-elimination {
            background: rgba(139, 69, 19, 0.1);
            border-radius: 8px;
            padding: 10px;
            border: 1px solid rgba(139, 69, 19, 0.3);
        }

        /* Week 17 Styles */
        .week17-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .championship-game {
            background: rgba(255, 215, 0, 0.15);
            border-radius: 8px;
            padding: 15px;
            border: 2px solid rgba(255, 215, 0, 0.5);
        }

        .championship-arena {
            position: relative;
        }

        .championship-team {
            background: rgba(255, 215, 0, 0.2);
            border-radius: 4px;
            padding: 6px 8px;
            margin-bottom: 4px;
            color: #B4E0FF;
            font-size: 11px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .championship-team:hover {
            background: rgba(255, 215, 0, 0.4);
            transform: scale(1.05);
            border-color: rgba(255, 215, 0, 0.7);
        }

        .champion-slot {
            background: linear-gradient(45deg, rgba(255, 215, 0, 0.3), rgba(255, 215, 0, 0.1));
            border-radius: 8px;
            padding: 12px;
            border: 3px solid #FFD700;
            text-align: center;
            margin-top: 15px;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
        }

        .champion-crown {
            font-size: 24px;
            margin-bottom: 5px;
            animation: rotate 3s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .champion-label {
            color: #FFD700;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .champion-team {
            color: #FFFFFF;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .champion-prize {
            color: #26A69A;
            font-size: 16px;
            font-weight: bold;
        }

        .championship-runnerups {
            background: rgba(180, 180, 180, 0.1);
            border-radius: 8px;
            padding: 10px;
            border: 1px solid rgba(180, 180, 180, 0.3);
        }

        .runnerups {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .runnerup {
            background: rgba(180, 180, 180, 0.2);
            border-radius: 3px;
            padding: 4px 6px;
            color: #B4E0FF;
            font-size: 10px;
            text-align: center;
        }

        /* Information Panel */
        .tournament-info-panel {
            background: rgba(10, 31, 51, 0.9);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid rgba(121, 196, 255, 0.3);
            min-height: 120px;
        }

        .info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(121, 196, 255, 0.2);
        }

        .info-header h3 {
            color: #FFD700;
            margin: 0;
            font-size: 16px;
        }

        .close-info {
            background: none;
            border: none;
            color: #79C4FF;
            font-size: 18px;
            cursor: pointer;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-info:hover {
            color: #FFD700;
        }

        .info-content {
            color: #B4E0FF;
            line-height: 1.5;
        }

        .info-content h4 {
            color: #FFD700;
            margin: 0 0 10px 0;
            font-size: 14px;
        }

        .info-content ul {
            margin: 10px 0;
            padding-left: 20px;
        }

        .info-content li {
            margin-bottom: 5px;
            font-size: 13px;
        }

        .info-content strong {
            color: #79C4FF;
        }

        /* Animation Classes */
        .highlight-step {
            animation: highlightGlow 1s ease-in-out;
        }

        @keyframes highlightGlow {
            0% { box-shadow: 0 0 0 rgba(255, 215, 0, 0); }
            50% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.5); }
            100% { box-shadow: 0 0 0 rgba(255, 215, 0, 0); }
        }

        .flow-animation {
            animation: flowPulse 0.5s ease-in-out;
        }

        @keyframes flowPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .eliminated-fade {
            opacity: 0.3;
            filter: grayscale(70%);
            transition: all 0.5s ease;
        }

        .winner-glow {
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
            animation: winnerPulse 1s ease-in-out infinite alternate;
        }

        @keyframes winnerPulse {
            from { box-shadow: 0 0 15px rgba(255, 215, 0, 0.6); }
            to { box-shadow: 0 0 25px rgba(255, 215, 0, 0.8); }
        }

        /* Duel of the Fates Section Styles */
        .duel-of-fates-section {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(227, 136, 46, 0.15));
            border-radius: 8px;
            padding: 15px;
            border: 2px solid rgba(255, 215, 0, 0.4);
            margin-bottom: 15px;
            position: relative;
            overflow: hidden;
        }

        .duel-of-fates-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            animation: duelShimmer 3s ease-in-out infinite;
            pointer-events: none;
        }

        @keyframes duelShimmer {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }

        .duel-arena {
            position: relative;
            z-index: 1;
        }

        .duel-participant {
            background: rgba(255, 215, 0, 0.2);
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 8px;
            border: 1px solid rgba(255, 215, 0, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .duel-participant:hover {
            background: rgba(255, 215, 0, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
        }

        .participant-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .participant-seed {
            background: rgba(255, 215, 0, 0.8);
            color: #0A1F33;
            font-weight: bold;
            font-size: 14px;
            padding: 4px 8px;
            border-radius: 4px;
            min-width: 30px;
            text-align: center;
        }

        .participant-name {
            color: #B4E0FF;
            font-weight: 600;
            font-size: 13px;
            flex: 1;
        }

        .duel-vs {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #FFD700;
            font-weight: bold;
            font-size: 12px;
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 6px;
            border-radius: 3px;
        }

        .duel-explanation {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            padding: 10px;
            margin: 12px 0;
            text-align: center;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .duel-title {
            color: #FFD700;
            font-weight: bold;
            font-size: 13px;
            margin-bottom: 4px;
        }

        .duel-details {
            color: #B4E0FF;
            font-size: 11px;
            margin-bottom: 3px;
        }

        .duel-prize {
            color: #26A69A;
            font-size: 10px;
            font-style: italic;
        }

        .duel-advancement {
            background: rgba(38, 166, 154, 0.2);
            border-radius: 6px;
            padding: 8px;
            text-align: center;
            border: 1px solid rgba(38, 166, 154, 0.4);
        }

        .advance-label {
            color: #26A69A;
            font-weight: 600;
            font-size: 11px;
            margin-bottom: 2px;
        }

        .advance-note {
            color: #79C4FF;
            font-size: 10px;
            font-style: italic;
        }

        /* Update seed group styling for Duel of the Fates */
        .seed-group.byes {
            border-left-color: #FFD700;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1), rgba(227, 136, 46, 0.05));
        }

        /* Seed highlighting styles */
        .seed-highlight {
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8) !important;
            border-color: #FFD700 !important;
            background: rgba(255, 215, 0, 0.2) !important;
            transform: scale(1.05) !important;
            z-index: 10 !important;
            position: relative !important;
        }

        /* UPDATE the tournament bracket CSS for mixed layout */

        .tournament-bracket {
            display: flex;
            flex-direction: column;
            gap: 25px;
            min-width: 1200px;
            overflow-x: auto;
            padding-bottom: 20px;
        }

        /* Week 13 column remains the same */
        .week13-column {
            flex: none;
            min-width: 800px;  /* Increase to accommodate horizontal layout */
            max-width: none;   /* Remove width constraint */
            width: 100%;       /* Take full available width */
            background: rgba(10, 31, 51, 0.3);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(121, 196, 255, 0.2);
        }

        /* Horizontal sections container */
        .horizontal-sections-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
        }

        /* Horizontal tournament sections */
        .horizontal-tournament-section {
            width: 100%;
            background: rgba(10, 31, 51, 0.3);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(121, 196, 255, 0.2);
            overflow-x: auto;
        }

        .horizontal-section-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(121, 196, 255, 0.3);
        }

        .horizontal-section-header h3 {
            color: #FFD700;
            font-size: 18px;
            font-weight: 600;
            margin: 0 0 5px 0;
        }

        .horizontal-section-header p {
            color: #79C4FF;
            font-size: 13px;
            margin: 0 0 10px 0;
            font-style: italic;
        }

        .week-indicators {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .week-badge {
            background: rgba(85, 154, 224, 0.3);
            color: #559AE0;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }

        .week-badge.active {
            background: rgba(255, 215, 0, 0.3);
            color: #FFD700;
        }

        .plus-sign, .equals-sign {
            color: #B4E0FF;
            font-weight: bold;
            font-size: 14px;
        }

        .result-badge {
            background: rgba(38, 166, 154, 0.3);
            color: #26A69A;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
        }

        .inactive-text {
            color: #79C4FF;
            font-size: 11px;
            font-style: italic;
        }

        /* Duel of the Fates Horizontal Styles */
        .duel-section {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(227, 136, 46, 0.1));
            border: 2px solid rgba(255, 215, 0, 0.4);
        }

        .duel-horizontal-container {
            display: flex;
            align-items: center;
            gap: 20px;
            justify-content: space-between;
            flex-wrap: wrap;
            min-height: 120px;
        }

        .horizontal-participant {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
            flex: 1;
        }

        .horizontal-participant:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .participant-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        .participant-seed {
            background: rgba(255, 215, 0, 0.8);
            color: #0A1F33;
            font-weight: bold;
            font-size: 14px;
            padding: 4px 8px;
            border-radius: 4px;
            min-width: 30px;
            text-align: center;
        }

        .participant-name {
            color: #B4E0FF;
            font-weight: 600;
            font-size: 14px;
            flex: 1;
        }

        .participant-scoring {
            display: flex;
            align-items: center;
            gap: 8px;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        .week-score {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .week-label {
            color: #79C4FF;
            font-size: 10px;
            font-weight: 500;
        }

        .score-value {
            color: #B4E0FF;
            font-size: 12px;
            font-weight: 600;
            background: rgba(0, 0, 0, 0.2);
            padding: 2px 6px;
            border-radius: 3px;
            min-width: 30px;
            text-align: center;
        }

        .score-plus, .score-equals {
            color: #79C4FF;
            font-weight: bold;
            font-size: 12px;
        }

        .total-score {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2px;
        }

        .total-label {
            color: #26A69A;
            font-size: 10px;
            font-weight: 600;
        }

        .total-value {
            color: #26A69A;
            font-size: 14px;
            font-weight: bold;
            background: rgba(38, 166, 154, 0.2);
            padding: 3px 8px;
            border-radius: 4px;
            min-width: 40px;
            text-align: center;
        }

        .vs-indicator {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            min-width: 80px;
        }

        .vs-text {
            color: #FFD700;
            font-weight: bold;
            font-size: 18px;
            background: rgba(0, 0, 0, 0.3);
            padding: 8px 12px;
            border-radius: 6px;
        }

        .duel-prize {
            color: #26A69A;
            font-size: 11px;
            font-weight: 600;
            background: rgba(38, 166, 154, 0.2);
            padding: 4px 8px;
            border-radius: 4px;
        }

        .duel-outcome {
            text-align: center;
            background: rgba(38, 166, 154, 0.2);
            border-radius: 6px;
            padding: 10px;
            min-width: 150px;
        }

        .outcome-header {
            color: #26A69A;
            font-weight: 600;
            font-size: 12px;
            margin-bottom: 3px;
        }

        .outcome-details {
            color: #79C4FF;
            font-size: 10px;
            font-style: italic;
        }

        /* Playoff Battle Horizontal Styles */
        .playoff-section {
            background: linear-gradient(135deg, rgba(85, 154, 224, 0.15), rgba(57, 112, 181, 0.1));
            border: 2px solid rgba(85, 154, 224, 0.4);
        }

        .playoff-horizontal-container {
            display: flex;
            gap: 25px;
            align-items: stretch;
            flex-wrap: wrap;
        }

        .playoff-competitors-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            flex: 2;
            min-width: 600px;
        }

        .auto-playoff-participant {
            background: rgba(85, 154, 224, 0.1);
            border-radius: 8px;
            padding: 12px;
            border: 1px solid rgba(85, 154, 224, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .auto-playoff-participant:hover {
            background: rgba(85, 154, 224, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(85, 154, 224, 0.3);
        }

        .wildcard-winner-participant {
            background: rgba(227, 136, 46, 0.1);
            border: 2px solid rgba(227, 136, 46, 0.5);
            grid-column: span 3;
            justify-self: center;
            max-width: 300px;
        }

        .wildcard-winner-participant:hover {
            background: rgba(227, 136, 46, 0.2);
        }

        .auto-playoff-participant .participant-scoring {
            gap: 6px;
            font-size: 12px;
        }

        .auto-playoff-participant .week-label {
            font-size: 10px;
        }

        .auto-playoff-participant .score-value,
        .auto-playoff-participant .total-value {
            font-size: 12px;
            padding: 2px 6px;
            min-width: 30px;
        }

        .playoff-advancement {
            background: rgba(38, 166, 154, 0.1);
            border-radius: 10px;
            padding: 18px;
            border: 1px solid rgba(38, 166, 154, 0.3);
            flex: 1;
            min-width: 250px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .advancement-header {
            color: #26A69A;
            font-weight: bold;
            font-size: 16px;
            text-align: center;
            margin-bottom: 8px;
        }

        .advancement-explanation {
            color: #79C4FF;
            font-size: 12px;
            text-align: center;
            margin-bottom: 15px;
            font-style: italic;
            line-height: 1.4;
        }

        .advancement-slots {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 12px;
        }

        .advance-slot {
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(38, 166, 154, 0.2);
            border-radius: 6px;
            padding: 8px 12px;
            border: 1px solid rgba(38, 166, 154, 0.4);
        }

        .advance-slot.gold {
            background: rgba(255, 215, 0, 0.2);
            border-color: rgba(255, 215, 0, 0.4);
        }

        .advance-slot.silver {
            background: rgba(192, 192, 192, 0.2);
            border-color: rgba(192, 192, 192, 0.4);
        }

        .advance-slot.bronze {
            background: rgba(205, 127, 50, 0.2);
            border-color: rgba(205, 127, 50, 0.4);
        }

        .slot-rank {
            background: rgba(38, 166, 154, 0.8);
            color: #FFFFFF;
            font-weight: bold;
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            min-width: 30px;
            text-align: center;
        }

        .advance-slot.gold .slot-rank {
            background: rgba(255, 215, 0, 0.8);
            color: #0A1F33;
        }

        .advance-slot.silver .slot-rank {
            background: rgba(192, 192, 192, 0.8);
            color: #0A1F33;
        }

        .advance-slot.bronze .slot-rank {
            background: rgba(205, 127, 50, 0.8);
            color: #FFFFFF;
        }

        .slot-team {
            color: #B4E0FF;
            font-size: 12px;
            font-weight: 500;
            flex: 1;
        }

        .elimination-note {
            color: #000000;
            font-size: 11px;
            text-align: center;
            font-style: italic;
        }

        /* Vertical columns container */
        .vertical-columns-container {
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        .tournament-column {
            flex: 1;
            min-width: 280px;
            max-width: 350px;
            background: rgba(10, 31, 51, 0.3);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid rgba(121, 196, 255, 0.2);
        }

        /* Conference Championship Styles */
        .conference-championship {
            background: rgba(255, 215, 0, 0.1);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .section-label {
            color: #B4E0FF;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 12px;
        }

        .conference-participants {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }

        .conference-team {
            background: rgba(255, 215, 0, 0.2);
            border-radius: 6px;
            padding: 8px 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .conference-team:hover {
            background: rgba(255, 215, 0, 0.3);
            transform: scale(1.02);
        }

        .conference-team.duel-qualifier {
            border-left: 4px solid #FFD700;
        }

        .conference-team.playoff-qualifier {
            border-left: 4px solid #559AE0;
        }

        .team-seed {
            background: rgba(255, 215, 0, 0.8);
            color: #0A1F33;
            font-weight: bold;
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 3px;
            margin-right: 8px;
            display: inline-block;
        }

        .team-name {
            color: #B4E0FF;
            font-size: 12px;
            font-weight: 600;
            display: inline;
        }

        .team-status {
            color: #79C4FF;
            font-size: 10px;
            font-style: italic;
            display: block;
            margin-top: 2px;
        }

        .conference-battle-arrow {
            text-align: center;
            font-size: 20px;
            color: #FFD700;
            margin: 15px 0;
            animation: pulse 2s infinite;
        }

        .conference-results {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .finals-advancement {
            background: rgba(38, 166, 154, 0.2);
            border-radius: 6px;
            padding: 10px;
            border: 1px solid rgba(38, 166, 154, 0.4);
        }

        .finals-label {
            color: #26A69A;
            font-weight: 600;
            font-size: 11px;
            text-align: center;
            margin-bottom: 6px;
        }

        .finalists {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .finalist {
            background: rgba(38, 166, 154, 0.3);
            border-radius: 4px;
            padding: 4px 8px;
            color: #B4E0FF;
            font-size: 10px;
            text-align: center;
        }

        .conference-eliminated {
            background: rgba(139, 69, 19, 0.2);
            border-radius: 6px;
            padding: 10px;
            border: 1px solid rgba(139, 69, 19, 0.4);
        }

        .eliminated-teams {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .eliminated-team {
            background: rgba(139, 69, 19, 0.3);
            border-radius: 4px;
            padding: 4px 8px;
            color: #000000;
            font-size: 10px;
            text-align: center;
        }

        /* Championship Game Styles */
        .championship-game {
            background: rgba(255, 215, 0, 0.15);
            border-radius: 8px;
            padding: 15px;
            border: 2px solid rgba(255, 215, 0, 0.5);
        }

        .championship-participants {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }

        .championship-team {
            background: rgba(255, 215, 0, 0.2);
            border-radius: 6px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 215, 0, 0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .championship-team:hover {
            background: rgba(255, 215, 0, 0.4);
            transform: scale(1.02);
            border-color: rgba(255, 215, 0, 0.7);
        }

        .finalist-seed {
            background: rgba(255, 215, 0, 0.8);
            color: #0A1F33;
            font-weight: bold;
            font-size: 12px;
            padding: 3px 8px;
            border-radius: 4px;
        }

        .finalist-name {
            color: #B4E0FF;
            font-size: 12px;
            font-weight: 600;
            flex: 1;
            margin: 0 8px;
        }

        .finalist-score {
            color: #26A69A;
            font-size: 12px;
            font-weight: 600;
            background: rgba(38, 166, 154, 0.2);
            padding: 3px 8px;
            border-radius: 4px;
        }

        .championship-battle-arrow {
            text-align: center;
            font-size: 20px;
            color: #FFD700;
            margin: 15px 0;
            animation: pulse 2s infinite;
        }

        .championship-results {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .champion-slot {
            background: linear-gradient(45deg, rgba(255, 215, 0, 0.3), rgba(255, 215, 0, 0.1));
            border-radius: 8px;
            padding: 15px;
            border: 3px solid #FFD700;
            text-align: center;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
        }

        .champion-crown {
            font-size: 24px;
            margin-bottom: 5px;
            animation: rotate 3s linear infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .champion-label {
            color: #FFD700;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .champion-team {
            color: #FFFFFF;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .champion-prize {
            color: #26A69A;
            font-size: 16px;
            font-weight: bold;
        }

        .championship-runnerups {
            background: rgba(180, 180, 180, 0.1);
            border-radius: 6px;
            padding: 10px;
            border: 1px solid rgba(180, 180, 180, 0.3);
        }

        .runnerup-label {
            color: #B4E0FF;
            font-size: 11px;
            font-weight: 600;
            text-align: center;
            margin-bottom: 6px;
        }

        .runnerups {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .runnerup {
            background: rgba(180, 180, 180, 0.2);
            border-radius: 4px;
            padding: 4px 8px;
            color: #B4E0FF;
            font-size: 10px;
            text-align: center;
        }

        /* Wildcard Battle Horizontal Styles */
        .wildcard-section {
            background: linear-gradient(135deg, rgba(227, 136, 46, 0.15), rgba(199, 107, 0, 0.1));
            border: 2px solid rgba(227, 136, 46, 0.4);
        }

        .wildcard-horizontal-container {
            display: flex;
            justify-content: center;
            width: 100%;
        }

        .wildcard-battle-arena {
            display: flex;
            align-items: center;
            gap: 30px;
            width: 100%;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        .wildcard-competitors {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            flex: 1;
            min-width: 350px;
        }

        .wildcard-competitor {
            background: rgba(227, 136, 46, 0.2);
            border-radius: 6px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(227, 136, 46, 0.3);
        }

        .wildcard-competitor:hover {
            background: rgba(227, 136, 46, 0.3);
            transform: scale(1.02);
            border-color: rgba(227, 136, 46, 0.6);
        }

        .competitor-seed {
            background: rgba(227, 136, 46, 0.8);
            color: #0A1F33;
            font-weight: bold;
            font-size: 13px;
            padding: 3px 8px;
            border-radius: 4px;
            margin-bottom: 5px;
            display: inline-block;
        }

        .competitor-name {
            color: #B4E0FF;
            font-size: 12px;
            font-weight: 500;
            margin-bottom: 5px;
        }

        .competitor-score {
            color: #E3882E;
            font-size: 13px;
            font-weight: 600;
            background: rgba(0, 0, 0, 0.2);
            padding: 3px 8px;
            border-radius: 4px;
        }

        .battle-flow {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            min-width: 100px;
        }

        .flow-arrow {
            font-size: 24px;
            color: #FFD700;
            animation: pulse 2s infinite;
        }

        .flow-text {
            color: #FFD700;
            font-size: 11px;
            font-weight: 600;
            background: rgba(255, 215, 0, 0.2);
            padding: 4px 8px;
            border-radius: 4px;
        }

        .battle-result {
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-width: 200px;
        }

        .winner-announcement {
            background: rgba(255, 215, 0, 0.2);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
            border: 2px solid rgba(255, 215, 0, 0.4);
        }

        .winner-label {
            color: #FFD700;
            font-weight: 600;
            font-size: 12px;
            margin-bottom: 8px;
        }

        .winner-details {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .winner-seed {
            background: rgba(255, 215, 0, 0.8);
            color: #0A1F33;
            font-weight: bold;
            font-size: 14px;
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }

        .winner-name {
            color: #B4E0FF;
            font-size: 12px;
            font-weight: 500;
        }

        .elimination-result {
            background: rgba(139, 69, 19, 0.2);
            border-radius: 6px;
            padding: 8px;
            text-align: center;
            border: 1px solid rgba(139, 69, 19, 0.4);
        }

        .eliminated-label {
            color: #000000;
            font-size: 11px;
            font-weight: 600;
            margin-bottom: 3px;
        }

        .eliminated-details {
            color: #000000;
            font-size: 10px;
        }

        /* Click and Interaction Styles */
        .horizontal-participant.clicked,
        .wildcard-competitor.clicked,
        .duel-participant.clicked {
           box-shadow: 0 0 20px rgba(255, 215, 0, 0.8) !important;
           border-color: #FFD700 !important;
           background: rgba(255, 215, 0, 0.2) !important;
           transform: scale(1.05) !important;
           z-index: 10 !important;
           position: relative !important;
        }

        /* Responsive Design for Tournament */
        @media (max-width: 1024px) {
            .tournament-bracket {
                min-width: 800px;
            }
            
            .vertical-columns-container {
                flex-direction: column;
                align-items: center;
            }
            
            .playoff-competitors-grid {
                grid-template-columns: repeat(2, 1fr);
                min-width: 400px;
            }
            
            .wildcard-winner-participant {
                grid-column: span 2;
            }
        }

        @media (max-width: 768px) {
            .tournament-bracket {
                min-width: 800px;
            }
            
            .tournament-column {
                min-width: 180px;
            }
            
            .tournament-controls {
                gap: 5px;
            }
            
            .control-btn {
                padding: 8px 12px;
                font-size: 11px;
            }
            
            .tournament-title {
                font-size: 24px;
            }
            
            .column-header h3 {
                font-size: 14px;
            }

            .duel-horizontal-container,
            .wildcard-battle-arena,
            .playoff-horizontal-container {
                flex-direction: column;
                align-items: center;
            }
            
            .wildcard-competitors {
                grid-template-columns: repeat(2, 1fr);
                min-width: 300px;
            }
            
            .playoff-competitors-grid {
                grid-template-columns: 1fr;
                min-width: 250px;
            }
            
            .wildcard-winner-participant {
                grid-column: span 1;
                max-width: none;
            }
            
            .participant-scoring {
                justify-content: center;
            }
            
            .advancement-slots {
                flex-direction: column;
                align-items: center;
            }
        }

        @media (max-width: 480px) {
            .wildcard-competitors {
                grid-template-columns: 1fr;
            }
            
            .week-indicators {
                flex-direction: column;
                gap: 4px;
            }
            
            .horizontal-tournament-section {
                padding: 15px;
            }
        }

        .payouts-title {
            text-align: center;
            color: #FFD700;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
        }

        .payouts-subtitle {
            text-align: center;
            color: #79C4FF;
            font-size: 14px;
            margin-bottom: 30px;
            font-style: italic;
        }

        /* Winners Section */
        .winners-section {
            margin-bottom: 40px;
            background: rgba(10, 31, 51, 0.3);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(121, 196, 255, 0.2);
        }

        .section-title {
            color: #FFD700;
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .winners-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .winner-category {
            background: rgba(27, 59, 99, 0.4);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid rgba(57, 112, 181, 0.3);
        }

        .category-title {
            color: #559AE0;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
            text-align: center;
            border-bottom: 1px solid rgba(85, 154, 224, 0.3);
            padding-bottom: 8px;
        }

        .weekly-winner-item, .season-winner, .duel-winner-item, .champion-winner {
            background: rgba(0, 77, 64, 0.3);
            border-radius: 6px;
            padding: 10px 12px;
            margin-bottom: 8px;
            border-left: 4px solid #26A69A;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .winner-info {
            display: flex;
            flex-direction: column;
        }

        .winner-name {
            font-weight: 600;
            color: #B4E0FF;
            font-size: 14px;
        }

        .winner-details {
            font-size: 12px;
            color: #79C4FF;
            margin-top: 2px;
        }

        .winner-payout {
            font-weight: bold;
            color: #FFD700;
            font-size: 14px;
        }

        /* Earnings Section */
        .earnings-section {
            background: rgba(10, 31, 51, 0.3);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(121, 196, 255, 0.2);
        }

        .earnings-chart-container {
            height: 400px;
            position: relative;
            background: rgba(27, 59, 99, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .last-updated {
            text-align: center;
            font-size: 12px;
            color: #79C4FF;
            font-style: italic;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #0A1F33 0%, #1B3B63 100%);
            margin: 10% auto;
            padding: 0;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            border: 2px solid rgba(121, 196, 255, 0.3);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .modal-header {
            background: rgba(255, 215, 0, 0.1);
            padding: 20px;
            border-bottom: 1px solid rgba(121, 196, 255, 0.2);
            border-radius: 12px 12px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h3 {
            color: #FFD700;
            margin: 0;
            font-size: 18px;
            font-weight: 600;
        }

        .close-modal {
            color: #79C4FF;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .close-modal:hover {
            color: #FFD700;
        }

        .modal-body {
            padding: 20px;
        }

        .total-earnings {
            text-align: center;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }

        .earnings-label {
            color: #B4E0FF;
            font-size: 14px;
            font-weight: 500;
        }

        .earnings-amount {
            color: #FFD700;
            font-size: 24px;
            font-weight: bold;
            margin-left: 10px;
        }

        .breakdown-item {
            background: rgba(27, 59, 99, 0.4);
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 4px solid #26A69A;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .breakdown-category {
            color: #B4E0FF;
            font-weight: 500;
            font-size: 14px;
        }

        .breakdown-amount {
            color: #FFD700;
            font-weight: 600;
            font-size: 14px;
        }

        /* Loading and Error States */
        .loading {
            text-align: center;
            color: #79C4FF;
            font-style: italic;
            padding: 20px;
        }

        .error {
            text-align: center;
            color: #FF6B6B;
            font-style: italic;
            padding: 20px;
        }

        .no-winners {
            text-align: center;
            color: #79C4FF;
            font-style: italic;
            padding: 15px;
            opacity: 0.7;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .winners-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                margin: 5% auto;
            }
            
            .earnings-chart-container {
                height: 300px;
            }
        }

        @media (max-width: 480px) {
            .payouts-title {
                font-size: 24px;
            }
            
            .winners-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .winner-category {
                padding: 12px;
            }
            
            .category-title {
                font-size: 14px;
            }
            
            .modal-content {
                width: 98%;
                margin: 2% auto;
            }
            
            .modal-header {
                padding: 15px;
            }
            
            .modal-body {
                padding: 15px;
            }
            
            .earnings-amount {
                font-size: 20px;
            }
        }


    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Shake Weight Fantasy Football</h1>
            <p style="font-weight:700; letter-spacing:0.5px;">Draft: September 3rd, 2025 8:00 PM CST</p>
            <!-- <div class="timestamp" id="timestamp">Loading...</div> -->
            <div class="view-toggle">
                <button id="desktop-mode" class="toggle-btn active">Desktop</button>
                <button id="mobile-mode" class="toggle-btn">Mobile</button>
            </div>
        </div>

        <div id="loading" class="loading">
            <div class="pulse">Loading playoff data...</div>
        </div>

        <div id="error" class="error" style="display: none;"></div>

        <div class="tabs-container">
            <div class="tabs-header">
                            <button class="tab-button active" data-tab="rules-updates">Rules & Updates</button>
                            <button class="tab-button" data-tab="payouts-content">Payouts</button>
            <button class="tab-button" data-tab="quantum-gauntlet">The Quantum Gauntlet</button>
            <button class="tab-button" data-tab="scoring-idp">Scoring IDP</button>
            </div>
            <div class="tab-content" id="quantum-gauntlet" style="display: none;">
                <div class="subtabs-container">
                    <div class="subtabs-header">
                        <button class="subtab-button active" data-subtab="mini-tournament">Wildcard + Divisional Round</button>
                        <button class="subtab-button" data-subtab="week16">Conference Championship</button>
                        <button class="subtab-button" data-subtab="week17">Superbowl</button>
                        <button class="subtab-button" data-subtab="final-standings">The Run</button>
                    </div>
                    <div class="subtab-content" id="mini-tournament" style="display: block;">
                        <!-- Duel of the Fates Tournament Container -->
                        <div class="duel-of-fates-container">
                            <!-- Duel of the Fates Video Background -->
                            <iframe 
                                class="duel-of-fates-video"
                                src="https://www.youtube.com/embed/8_3ufz0rgi0?autoplay=1&mute=1&loop=1&playlist=8_3ufz0rgi0&controls=0&showinfo=0&rel=0&modestbranding=1&playsinline=1&enablejsapi=1"
                                frameborder="0"
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                allowfullscreen>
                            </iframe>
                            
                            <div class="duel-of-fates-header">DUEL OF THE FATES TOURNAMENT</div>
                            <div class="duel-of-fates-grid">
                                <!-- Week 14 Duel of the Fates -->
                                <div class="duel-section">
                                    <div class="duel-header">Week 14</div>
                                    <div class="duel-content">
                                        <div class="round-section">
                                            <div class="seed-label">Seeds 1-2</div>
                                            <div class="round-title">Duel of the Fates</div>
                                            <table class="data-table" id="week14-bye">
                                                <thead>
                                                    <tr>
                                                        <th>Team</th>
                                                        <th>Score</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data will be populated here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <!-- Week 15 Duel of the Fates -->
                                <div class="duel-section">
                                    <div class="duel-header">Week 15</div>
                                    <div class="duel-content">
                                        <div class="round-section">
                                            <div class="round-title">Duel of the Fates</div>
                                            <table class="data-table" id="week15-bye">
                                                <thead>
                                                    <tr>
                                                        <th>Team</th>
                                                        <th>Score</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data will be populated here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <!-- Duel of the Fates Results -->
                                <div class="duel-section">
                                    <div class="duel-header">Results</div>
                                    <div class="duel-content">
                                        <div class="round-section">
                                            <div class="round-title">Duel of the Fates Result</div>
                                            <table class="data-table" id="week15-bye-result">
                                                <thead>
                                                    <tr>
                                                        <th>Team</th>
                                                        <th>Proj. Score</th>
                                                        <th>Score</th>
                                                        <th>Next week</th>
                                                        <th>Payout</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data will be populated here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Wildcard + Divisional Tournament Container -->
                        <div class="wildcard-divisional-container">
                            <div class="wildcard-divisional-header">WILDCARD + DIVISIONAL ROUND TOURNAMENT</div>
                            <div class="wildcard-divisional-grid">
                                <!-- Week 14 Wildcard + Divisional -->
                                <div class="wildcard-section">
                                    <div class="wildcard-header">Week 14</div>
                                    <div class="wildcard-content">
                                        <div class="round-section">
                                            <div class="seed-label">Seeds 3-6</div>
                                            <div class="round-title">Divisional pt 1</div>
                                            <table class="data-table" id="week14-playoff">
                                                <thead>
                                                    <tr>
                                                        <th>Team</th>
                                                        <th>Score</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data will be populated here -->
                                                </tbody>
                                            </table>
                                        </div>

                                        <div class="round-section">
                                            <div class="seed-label">Seeds 7-12</div>
                                            <div class="round-title">Wildcard</div>
                                            <table class="data-table" id="week14-wildcard">
                                                <thead>
                                                    <tr>
                                                        <th>Team</th>
                                                        <th>Score</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data will be populated here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <!-- Week 15 Wildcard + Divisional -->
                                <div class="wildcard-section">
                                    <div class="wildcard-header">Week 15</div>
                                    <div class="wildcard-content">
                                        <div class="round-section">
                                            <div class="round-title">Wildcard Winner + Divisional pt 2</div>
                                            <table class="data-table" id="week15-playoff">
                                                <thead>
                                                    <tr>
                                                        <th>Team</th>
                                                        <th>Score</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data will be populated here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <!-- Wildcard + Divisional Results -->
                                <div class="wildcard-section">
                                    <div class="wildcard-header">Results</div>
                                    <div class="wildcard-content">
                                        <div class="round-section">
                                            <div class="round-title">Wildcard + Divisional Round Result</div>
                                            <table class="data-table" id="week15-playoff-result">
                                                <thead>
                                                    <tr>
                                                        <th>Team</th>
                                                        <th>Proj. Score</th>
                                                        <th>Score</th>
                                                        <th>Next week</th>
                                                        <th>Payout</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data will be populated here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Toilet Bowl Tournament Container -->
                        <div class="toilet-bowl-container">
                            <div class="toilet-bowl-header">TOILET BOWL TOURNAMENT</div>
                            <div class="toilet-bowl-grid">
                                <!-- Week 14 Toilet Bowl (Placeholder) -->
                                <div class="toilet-section">
                                    <div class="toilet-header">Week 14</div>
                                    <div class="toilet-content">
                                        <div class="round-section">
                                            <div class="round-title">Toilet Bowl</div>
                                            <table class="data-table" id="week14-toilet">
                                                <thead>
                                                    <tr>
                                                        <th>Team</th>
                                                        <th>Score</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data will be populated here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <!-- Week 15 Toilet Bowl -->
                                <div class="toilet-section">
                                    <div class="toilet-header">Week 15</div>
                                    <div class="toilet-content">
                                        <div class="round-section">
                                            <div class="round-title">Toilet Bowl</div>
                                            <table class="data-table" id="week15-toilet">
                                                <thead>
                                                    <tr>
                                                        <th>Team</th>
                                                        <th>Score</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data will be populated here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>

                                <!-- Toilet Bowl Results -->
                                <div class="toilet-section">
                                    <div class="toilet-header">Results</div>
                                    <div class="toilet-content">
                                        <div class="round-section">
                                            <div class="round-title">Toilet Bowl Result</div>
                                            <table class="data-table" id="week15-toilet-result">
                                                <thead>
                                                    <tr>
                                                        <th>Team</th>
                                                        <th>Proj. Score</th>
                                                        <th>Score</th>
                                                        <th>Next week</th>
                                                        <th>Payout</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <!-- Data will be populated here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="subtab-content" id="week16" style="display: none;">
                        <div class="tournament-grid">
                            <div class="week-section">
                                <div class="week-header">Conference Championship</div>
                                <div class="week-content">
                                    <div class="tournament-phase">ReSeeded Seeds 1-5</div>
                                    <table class="data-table" id="week16-conference">
                                        <thead>
                                            <tr>
                                                <th>Team</th>
                                                <th>Proj. Score</th>
                                                <th>Score</th>
                                                <th>Next Week</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Data will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="week-section">
                                <div class="week-header">Purgatory</div>
                                <div class="week-content">
                                    <div class="tournament-phase">ReSeeded Seeds 6-8</div>
                                    <table class="data-table" id="week16-purgatory">
                                        <thead>
                                            <tr>
                                                <th>Team</th>
                                                <th>Proj. Score</th>
                                                <th>Score</th>
                                                <th>Next Week</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Data will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="week-section">
                                <div class="week-header">Toilet Bowl</div>
                                <div class="week-content">
                                    <div class="tournament-phase">ReSeeded Seeds 9-12</div>
                                    <table class="data-table" id="week16-toilet">
                                        <thead>
                                            <tr>
                                                <th>Team</th>
                                                <th>Proj. Score</th>
                                                <th>Score</th>
                                                <th>Next Week</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Data will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="subtab-content" id="week17" style="display: none;">
                        <div class="tournament-grid">
                            <div class="week-section">
                                <div class="week-header">Shake Weight Fantasy Championship</div>
                                <div class="week-content">
                                    <div class="tournament-phase">ReSeeded Seeds 1-3</div>
                                    <table class="data-table" id="week17-championship">
                                        <thead>
                                            <tr>
                                                <th>Team</th>
                                                <th>Proj. Score</th>
                                                <th>Score</th>
                                                <th>Final Result</th>
                                                <th>Payout</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Data will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="week-section">
                                <div class="week-header">Purgatory</div>
                                <div class="week-content">
                                    <div class="tournament-phase">ReSeeded Seeds 4-9</div>
                                    <table class="data-table" id="week17-purgatory">
                                        <thead>
                                            <tr>
                                                <th>Team</th>
                                                <th>Proj. Score</th>
                                                <th>Score</th>
                                                <th>Final Result</th>
                                                <th>Payout</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Data will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="week-section">
                                <div class="week-header">The Final Flush</div>
                                <div class="week-content">
                                    <div class="tournament-phase">ReSeeded Seeds 10-12</div>
                                    <table class="data-table" id="week17-toilet">
                                        <thead>
                                            <tr>
                                                <th>Team</th>
                                                <th>Proj. Score</th>
                                                <th>Score</th>
                                                <th>Final Result</th>
                                                <th>Payout</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <!-- Data will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="subtab-content" id="final-standings" style="display: none;">
                        <div class="run-container">
                            <h2>🏆 The Run - Championship Path</h2>
                            <div class="chart-controls">
                                <button id="show-all-teams-subtab">Wildcard</button>
                                <button id="hide-all-teams-subtab">Non-Wildcard</button>
                                <button id="reset-filters-subtab">Show All</button>
                                <button id="show-champion-only-subtab">Champion Only</button>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="theRunChartSubtab"></canvas>
                            </div>
                            
                            

                            
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="payouts-content" style="display: none;">
                <div class="payouts-container">
                    <h1 style="color: #FFD700; text-align: center; margin-bottom: 10px;">💰 Shake Weight Fantasy Payouts</h1>
                    
                    <!-- ADD this season toggle section -->
                    <div class="season-toggle-container" style="text-align: center; margin-bottom: 20px;">
                        <div class="toggle-label" style="color: #79C4FF; font-size: 14px; margin-bottom: 10px;">
                            View Season Data:
                        </div>
                        <div class="toggle-switch">
                            <button id="season-2024" class="toggle-btn active" onclick="switchSeason('2024')">
                                2024 (Demo)
                            </button>
                            <button id="season-2025" class="toggle-btn" onclick="switchSeason('2025')">
                                2025 (Live)
                            </button>
                        </div>
                        <div class="season-status" style="color: #B4E0FF; font-size: 12px; margin-top: 8px; font-style: italic;" id="season-status">
                            Showing 2024 demo data
                        </div>
                    </div>
                    
                    <div class="payouts-subtitle" style="color: #79C4FF; text-align: center; margin-bottom: 30px;">
                        Season earnings tracker - Updates every Tuesday morning
                    </div>
                    
                    <!-- Test Section -->
                    <div style="background: rgba(10, 31, 51, 0.3); border-radius: 8px; padding: 20px; margin-bottom: 20px;">
                        <h2 style="color: #FFD700; margin-bottom: 15px;">🏆 Category Winners</h2>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                            
                            <div style="background: rgba(27, 59, 99, 0.4); border-radius: 6px; padding: 15px;">
                                <h3 style="color: #559AE0; font-size: 14px; margin-bottom: 10px;">Weekly High Score ($25 each)</h3>
                                <div id="weekly-winners">
                                    <div style="color: #B4E0FF; padding: 10px;">Loading weekly winners...</div>
                                </div>
                            </div>
                            
                            <div style="background: rgba(27, 59, 99, 0.4); border-radius: 6px; padding: 15px;">
                                <h3 style="color: #559AE0; font-size: 14px; margin-bottom: 10px;">Season High Score - $75</h3>
                                <div id="season-winner">
                                    <div style="color: #B4E0FF; padding: 10px;">Loading season winner...</div>
                                </div>
                            </div>
                            
                            <div style="background: rgba(27, 59, 99, 0.4); border-radius: 6px; padding: 15px;">
                                <h3 style="color: #559AE0; font-size: 14px; margin-bottom: 10px;">Duel of the Fates - $100</h3>
                                <div id="duel-winners">
                                    <div style="color: #B4E0FF; padding: 10px;">Loading duel winners...</div>
                                </div>
                            </div>
                            
                            <div style="background: rgba(27, 59, 99, 0.4); border-radius: 6px; padding: 15px;">
                                <h3 style="color: #559AE0; font-size: 14px; margin-bottom: 10px;">Champion - $700</h3>
                                <div id="champion-winner">
                                    <div style="color: #B4E0FF; padding: 10px;">Loading champion...</div>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <!-- Earnings Chart Section -->
                    <div style="background: rgba(10, 31, 51, 0.3); border-radius: 8px; padding: 20px;">
                        <h2 style="color: #FFD700; margin-bottom: 15px;">📊 Team Earnings ($1+ Winners)</h2>
                        <div style="height: 400px; background: rgba(27, 59, 99, 0.2); border-radius: 6px; padding: 15px;">
                            <canvas id="earningsChart"></canvas>
                        </div>
                        <!-- <div style="text-align: center; font-size: 12px; color: #79C4FF; font-style: italic; margin-top: 10px;" id="last-updated">
                            Last Updated: --
                        </div> -->
                    </div>
                    
                </div>
            </div>

            <!-- Earnings Detail Modal -->
            <div id="earningsModal" class="modal" style="display: none;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 id="modalTeamName">Team Earnings Breakdown</h3>
                        <span class="close-modal" id="earningsModalClose">&times;</span>
                    </div>
                    <div class="modal-body">
                        <div class="total-earnings">
                            <span class="earnings-label">Total Earnings:</span>
                            <span class="earnings-amount" id="modalTotalEarnings">$0</span>
                        </div>
                        <div class="earnings-breakdown" id="modalEarningsBreakdown">
                            <!-- Dynamic content will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="rules-updates" style="display: block;">
                <div class="rules-section">
                    <h2>Changes + Reminders</h2>
                    <ul>
                        <li>ESPN App switched to Sleeper App</li>
                        <li>RB2 returns to the roster</li>
                        <li>TE get 1.5 points per reception</li>
                        <li>Quantum Gauntlet Format Update</li>
                        <li>Trades execute immediately</li>
                        <li>FAAB is tradable directly through the Sleeper App</li>
                        <li>Defense has been replaced by two IDP players</li>
                        <li>#1 Seed Payout removed</li>
                        <li>$75 for Most regular season points</li>
                        <li>$100 split payout for Duel of the Fates tournament</li>
                        <li>Limit 3 QBs per roster</li>
                        <li>1 Bench Spot Added</li>
                        <li>Excess FAAB from draft is added to week 1 FAAB Budget</li>
                        <li>Bonus Match up against the median score runs week 1 - 13</li>
                    </ul>

                    <h2>Quantum Gauntlet Update Details - Week 14 + 15</h2>

                    <h3>Duel of the Fates - Rules</h3>
                    <ul>
                        <li>Only top 2 seeds after week 13 qualify</li>
                        <li>This is a two-week matchup (week 14 + week 15)</li>
                        <li>Each team's total score across both weeks is combined</li>
                        <li>The point gap between the two totals determines the payout split from a $100 prize pool:</li>
                    </ul>
                    <table class="rules-table">
                        <thead>
                            <tr><th>Winning Margin</th><th>Winner Prize</th><th>Loser Prize</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>0 – 7.5 pts</td><td>$60</td><td>$40</td></tr>
                            <tr><td>7.51 – 15 pts</td><td>$70</td><td>$30</td></tr>
                            <tr><td>15.01 – 23.5 pts</td><td>$80</td><td>$20</td></tr>
                            <tr><td>23.51 – 30 pts</td><td>$90</td><td>$10</td></tr>
                            <tr><td>30.01 pts or more</td><td>$100</td><td>$0</td></tr>
                        </tbody>
                    </table>

                    <h3>Wildcard + Divisional - Rules</h3>
                    <ul>
                        <li>Seeds 3–6 after week 13 automatically enter a two-week playoff (Weeks 14 & 15).</li>
                        <li>Their total score across both weeks determines who advances.</li>
                        <li>Seeds 7–12 compete in a Wildcard round during Week 14.</li>
                        <li>The highest-scoring team from that group becomes the Wildcard Winner.</li>
                        <li>The Wildcard Winner then joins the playoff in Week 15, and their Week 14 + Week 15 score is compared against Seeds 3–6 to determine advancement.</li>
                        <li>The top 3 team scores from week 14 + 15 combined will advance to play against seeds 1 and 2 in the conference championship.</li>
                        <li>The teams that don't win the wildcard will be moved into the Toilet bowl which starts week 15.</li>
                    </ul>
                </div>

                <!-- ADD this interactive tournament visualization -->
                <div class="quantum-gauntlet-visualization" id="quantum-gauntlet-viz">
                    <div class="tournament-header">
                        <h2 class="tournament-title">⚡ The Quantum Gauntlet Tournament</h2>
                        <p class="tournament-subtitle">Interactive playoff bracket - Click elements to explore</p>
                    </div>
                    
                    <!-- Tournament Controls -->
                    <!-- <div class="tournament-controls">
                        <button class="control-btn active" onclick="showTournamentStep('overview')" id="step-overview">
                            📋 Overview
                        </button>
                        <button class="control-btn" onclick="showTournamentStep('week14')" id="step-week14">
                            ⚔️ Week 14 - Wildcard
                        </button>
                        <button class="control-btn" onclick="showTournamentStep('week15')" id="step-week15">
                            🏟️ Week 15 - Divisional
                        </button>
                        <button class="control-btn" onclick="showTournamentStep('week16')" id="step-week16">
                            🏆 Week 16 - Conference
                        </button>
                        <button class="control-btn" onclick="showTournamentStep('week17')" id="step-week17">
                            👑 Week 17 - Championship
                        </button>
                        <button class="control-btn" onclick="animateFullTournament()" id="animate-btn">
                            ▶️ Animate Flow
                        </button>
                    </div> -->
                    
                    <!-- Tournament Bracket Container -->
                    <div class="tournament-bracket" id="tournament-bracket">
                        
                        <!-- Week 13 Results - Horizontal Layout -->
                        <div class="horizontal-tournament-section week13-horizontal-section" id="week13-horizontal-section">
                            <div class="horizontal-section-header">
                                <h3>📊 Week 13 Final Results</h3>
                                <p>Regular Season Complete - Tournament Seeding Determined</p>
                                <div class="week-indicators">
                                    <span class="week-badge active">Week 13</span>
                                    <span class="result-badge">Final Standings</span>
                                </div>
                            </div>
                            
                            <div class="week13-horizontal-container">
                                <div class="seeding-results-grid">
                                    <div class="seed-category duel-qualifiers">
                                        <div class="category-header">⚔️ Duel of the Fates Qualifiers</div>
                                        <div class="seed-row">
                                            <div class="seed-box gold-seed" data-seed="1">
                                                <div class="seed-number">#1</div>
                                                <div class="seed-team">Seed 1 Team</div>
                                                <div class="seed-status">Duel Participant</div>
                                            </div>
                                            <div class="seed-box gold-seed" data-seed="2">
                                                <div class="seed-number">#2</div>
                                                <div class="seed-team">Seed 2 Team</div>
                                                <div class="seed-status">Duel Participant</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="seed-category auto-playoff">
                                        <div class="category-header">🏟️ Auto Playoff</div>
                                        <div class="seed-row">
                                            <div class="seed-box blue-seed" data-seed="3">
                                                <div class="seed-number">#3</div>
                                                <div class="seed-team">Seed 3 Team</div>
                                                <div class="seed-status">Weeks 14+15</div>
                                            </div>
                                            <div class="seed-box blue-seed" data-seed="4">
                                                <div class="seed-number">#4</div>
                                                <div class="seed-team">Seed 4 Team</div>
                                                <div class="seed-status">Weeks 14+15</div>
                                            </div>
                                            <div class="seed-box blue-seed" data-seed="5">
                                                <div class="seed-number">#5</div>
                                                <div class="seed-team">Seed 5 Team</div>
                                                <div class="seed-status">Weeks 14+15</div>
                                            </div>
                                            <div class="seed-box blue-seed" data-seed="6">
                                                <div class="seed-number">#6</div>
                                                <div class="seed-team">Seed 6 Team</div>
                                                <div class="seed-status">Weeks 14+15</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="seed-category wildcard-battle">
                                        <div class="category-header">🎰 Wildcard Battle</div>
                                        <div class="seed-row">
                                            <div class="seed-box orange-seed" data-seed="7">
                                                <div class="seed-number">#7</div>
                                                <div class="seed-team">Seed 7 Team</div>
                                                <div class="seed-status">Week 14 Only</div>
                                            </div>
                                            <div class="seed-box orange-seed" data-seed="8">
                                                <div class="seed-number">#8</div>
                                                <div class="seed-team">Seed 8 Team</div>
                                                <div class="seed-status">Week 14 Only</div>
                                            </div>
                                            <div class="seed-box orange-seed" data-seed="9">
                                                <div class="seed-number">#9</div>
                                                <div class="seed-team">Seed 9 Team</div>
                                                <div class="seed-status">Week 14 Only</div>
                                            </div>
                                            <div class="seed-box orange-seed" data-seed="10">
                                                <div class="seed-number">#10</div>
                                                <div class="seed-team">Seed 10 Team</div>
                                                <div class="seed-status">Week 14 Only</div>
                                            </div>
                                            <div class="seed-box orange-seed" data-seed="11">
                                                <div class="seed-number">#11</div>
                                                <div class="seed-team">Seed 11 Team</div>
                                                <div class="seed-status">Week 14 Only</div>
                                            </div>
                                            <div class="seed-box orange-seed" data-seed="12">
                                                <div class="seed-number">#12</div>
                                                <div class="seed-team">Seed 12 Team</div>
                                                <div class="seed-status">Week 14 Only</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Simultaneous Tournament Phases Container -->
                        <div class="simultaneous-phases-container">
                            <div class="phases-header">
                                <h2>⚡ Week 14-15 Tournament Phases</h2>
                                <span class="timing-badge">SIMULTANEOUS</span>
                                <div class="timing-indicator"></div>
                            </div>
                            
                            <div class="horizontal-sections-container">
                            
                            <!-- 1. DUEL OF THE FATES (Move to TOP) -->
                            <!-- 2. PLAYOFF BATTLE (Move to MIDDLE) -->
                            <!-- 3. WILDCARD BATTLE (Move to BOTTOM) -->
                            
                            
                            
                            <!-- Duel of the Fates Section (Weeks 14+15) -->
                            <div class="horizontal-tournament-section duel-section" id="duel-horizontal-section">
                                <div class="horizontal-section-header">
                                    <h3>⚔️ Duel of the Fates</h3>
                                    <p>Seeds #1 vs #2 - Weeks 14+15 Combined</p>
                                    <div class="week-indicators">
                                        <span class="week-badge">Week 14</span>
                                        <span class="plus-sign">+</span>
                                        <span class="week-badge">Week 15</span>
                                        <span class="equals-sign">=</span>
                                        <span class="result-badge">Total Score</span>
                                    </div>
                                </div>
                                
                                <div class="duel-horizontal-container">
                                    <div class="duel-participant horizontal-participant" data-seed="1">
                                        <div class="participant-header">
                                            <div class="participant-seed">#1</div>
                                            <div class="participant-name">Seed 1 Team</div>
                                        </div>
                                        <div class="participant-scoring">
                                            <div class="week-score">
                                                <span class="week-label">Week 14</span>
                                                <span class="score-value" id="duel-1-w14">--</span>
                                            </div>
                                            <div class="score-plus">+</div>
                                            <div class="week-score">
                                                <span class="week-label">Week 15</span>
                                                <span class="score-value" id="duel-1-w15">--</span>
                                            </div>
                                            <div class="score-equals">=</div>
                                            <div class="total-score">
                                                <span class="total-label">Total</span>
                                                <span class="total-value" id="duel-1-total">--</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="vs-indicator">
                                        <div class="vs-text">VS</div>
                                        <div class="duel-prize">$100 Prize Pool</div>
                                        <div class="duel-outcome-note">Both Advance</div>
                                    </div>
                                    
                                    <div class="duel-participant horizontal-participant" data-seed="2">
                                        <div class="participant-header">
                                            <div class="participant-seed">#2</div>
                                            <div class="participant-name">Seed 2 Team</div>
                                        </div>
                                        <div class="participant-scoring">
                                            <div class="week-score">
                                                <span class="week-label">Week 14</span>
                                                <span class="score-value" id="duel-2-w14">--</span>
                                            </div>
                                            <div class="score-plus">+</div>
                                            <div class="week-score">
                                                <span class="week-label">Week 15</span>
                                                <span class="score-value" id="duel-2-w15">--</span>
                                            </div>
                                            <div class="score-equals">=</div>
                                            <div class="total-score">
                                                <span class="total-label">Total</span>
                                                <span class="total-value" id="duel-2-total">--</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Playoff Battle Section (Weeks 14+15) -->
                            <div class="horizontal-tournament-section playoff-section" id="playoff-horizontal-section">
                                <div class="horizontal-section-header">
                                    <h3>⚔️ Playoff Battle</h3>
                                    <p>Seeds 3-6 + Wildcard Winner - Combined Scoring</p>
                                    <div class="week-indicators">
                                        <span class="week-badge">Week 14</span>
                                        <span class="plus-sign">+</span>
                                        <span class="week-badge">Week 15</span>
                                        <span class="equals-sign">=</span>
                                        <span class="result-badge">Combined Score</span>
                                    </div>
                                </div>
                                
                                <div class="playoff-horizontal-container">
                                    <div class="playoff-competitors-grid">
                                        <div class="auto-playoff-participant horizontal-participant" data-seed="3">
                                            <div class="participant-header">
                                                <div class="participant-seed">#3</div>
                                                <div class="participant-name">Seed 3 Team</div>
                                            </div>
                                            <div class="participant-scoring">
                                                <div class="week-score">
                                                    <span class="week-label">W14</span>
                                                    <span class="score-value" id="playoff-3-w14">--</span>
                                                </div>
                                                <div class="score-plus">+</div>
                                                <div class="week-score">
                                                    <span class="week-label">W15</span>
                                                    <span class="score-value" id="playoff-3-w15">--</span>
                                                </div>
                                                <div class="score-equals">=</div>
                                                <div class="total-score">
                                                    <span class="total-value" id="playoff-3-total">--</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="auto-playoff-participant horizontal-participant" data-seed="4">
                                            <div class="participant-header">
                                                <div class="participant-seed">#4</div>
                                                <div class="participant-name">Seed 4 Team</div>
                                            </div>
                                            <div class="participant-scoring">
                                                <div class="week-score">
                                                    <span class="week-label">W14</span>
                                                    <span class="score-value" id="playoff-4-w14">--</span>
                                                </div>
                                                <div class="score-plus">+</div>
                                                <div class="week-score">
                                                    <span class="week-label">W15</span>
                                                    <span class="score-value" id="playoff-4-w15">--</span>
                                                </div>
                                                <div class="score-equals">=</div>
                                                <div class="total-score">
                                                    <span class="total-value" id="playoff-4-total">--</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="auto-playoff-participant horizontal-participant" data-seed="5">
                                            <div class="participant-header">
                                                <div class="participant-seed">#5</div>
                                                <div class="participant-name">Seed 5 Team</div>
                                            </div>
                                            <div class="participant-scoring">
                                                <div class="week-score">
                                                    <span class="week-label">W14</span>
                                                    <span class="score-value" id="playoff-5-w14">--</span>
                                                </div>
                                                <div class="score-plus">+</div>
                                                <div class="week-score">
                                                    <span class="week-label">W15</span>
                                                    <span class="score-value" id="playoff-5-w15">--</span>
                                                </div>
                                                <div class="score-equals">=</div>
                                                <div class="total-score">
                                                    <span class="total-value" id="playoff-5-total">--</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="auto-playoff-participant horizontal-participant" data-seed="6">
                                            <div class="participant-header">
                                                <div class="participant-seed">#6</div>
                                                <div class="participant-name">Seed 6 Team</div>
                                            </div>
                                            <div class="participant-scoring">
                                                <div class="week-score">
                                                    <span class="week-label">W14</span>
                                                    <span class="score-value" id="playoff-6-w14">--</span>
                                                </div>
                                                <div class="score-plus">+</div>
                                                <div class="week-score">
                                                    <span class="week-label">W15</span>
                                                    <span class="score-value" id="playoff-6-w15">--</span>
                                                </div>
                                                <div class="score-equals">=</div>
                                                <div class="total-score">
                                                    <span class="total-value" id="playoff-6-total">--</span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="wildcard-winner-participant horizontal-participant">
                                            <div class="participant-header">
                                                <div class="participant-seed" id="playoff-wildcard-seed">#?</div>
                                                <div class="participant-name" id="playoff-wildcard-name">Wildcard Winner</div>
                                            </div>
                                            <div class="participant-scoring">
                                                <div class="week-score">
                                                    <span class="week-label">W14</span>
                                                    <span class="score-value" id="playoff-wildcard-w14">--</span>
                                                </div>
                                                <div class="score-plus">+</div>
                                                <div class="week-score">
                                                    <span class="week-label">W15</span>
                                                    <span class="score-value" id="playoff-wildcard-w15">--</span>
                                                </div>
                                                <div class="score-equals">=</div>
                                                <div class="total-score">
                                                    <span class="total-value" id="playoff-wildcard-total">--</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="playoff-advancement">
                                        <div class="advancement-header">📊 Top 3 Advance</div>
                                        <div class="advancement-explanation">Highest combined scores advance to Conference Championship</div>
                                        <div class="advancement-slots">
                                            <div class="advance-slot gold">
                                                <div class="slot-rank">1st</div>
                                                <div class="slot-team" id="playoff-advance-1st">--</div>
                                            </div>
                                            <div class="advance-slot silver">
                                                <div class="slot-rank">2nd</div>
                                                <div class="slot-team" id="playoff-advance-2nd">--</div>
                                            </div>
                                            <div class="advance-slot bronze">
                                                <div class="slot-rank">3rd</div>
                                                <div class="slot-team" id="playoff-advance-3rd">--</div>
                                            </div>
                                        </div>
                                        <div class="elimination-note">Bottom 2 eliminated from playoffs</div>
                                    </div>
                                </div>
                            </div>

                             <!-- Wildcard Section (Weeks 14+15) -->
                             <div class="horizontal-tournament-section wildcard-section" id="wildcard-horizontal-section">
                                <div class="horizontal-section-header">
                                    <h3>⚔️ Wildcard Round</h3>
                                    <p>Seeds #7–#12 play in Week 14. Highest score is the Wildcard Winner and advances to the Week 15 Divisional; all others go to the Toilet Bowl.</p>
                                    <div class="week-indicators">
                                        <span class="week-badge">Week 14</span>
                                        <span class="arrow">→</span>
                                        <span class="result-badge">Top Score = Wildcard Winner</span>
                                        <span class="arrow">→</span>
                                        <span class="week-badge">Week 15 Divisional</span>
                                        <span class="separator">|</span>
                                        <span class="result-badge">Others → Toilet Bowl</span>
                                    </div>
                                </div>
                                
                            
                                
                                <div class="duel-horizontal-container">
                                    <div class="duel-participant horizontal-participant" data-seed="1">
                                        <div class="wildcard-competitors">
                                            <div class="wildcard-competitor" data-seed="7">
                                                <div class="competitor-seed">#7</div>
                                                <div class="competitor-name">Seed 7</div>
                                                <div class="competitor-score" id="wild-7-score">--</div>
                                            </div>
                                            <div class="wildcard-competitor" data-seed="8">
                                                <div class="competitor-seed">#8</div>
                                                <div class="competitor-name">Seed 8</div>
                                                <div class="competitor-score" id="wild-8-score">--</div>
                                            </div>
                                            <div class="wildcard-competitor" data-seed="9">
                                                <div class="competitor-seed">#9</div>
                                                <div class="competitor-name">Seed 9</div>
                                                <div class="competitor-score" id="wild-9-score">--</div>
                                            </div>
                                            <div class="wildcard-competitor" data-seed="10">
                                                <div class="competitor-seed">#10</div>
                                                <div class="competitor-name">Seed 10</div>
                                                <div class="competitor-score" id="wild-10-score">--</div>
                                            </div>
                                            <div class="wildcard-competitor" data-seed="11">
                                                <div class="competitor-seed">#11</div>
                                                <div class="competitor-name">Seed 11</div>
                                                <div class="competitor-score" id="wild-11-score">--</div>
                                            </div>
                                            <div class="wildcard-competitor" data-seed="12">
                                                <div class="competitor-seed">#12</div>
                                                <div class="competitor-name">Seed 12</div>
                                                <div class="competitor-score" id="wild-12-score">--</div>
                                            </div>
                                        </div>
                                        
                                        <div class="battle-flow">
                                            <div class="flow-arrow">⚡</div>
                                            <div class="flow-text">Highest Score</div>
                                        </div>
                                        
                                        <div class="battle-result">
                                            <div class="winner-announcement">
                                                <div class="winner-label">Winner Advances to Divisional Round</div>
                                                <div class="winner-details" id="wildcard-battle-winner">
                                                    <div class="winner-seed" id="wildcard-winner-seed">#?</div>
                                                    <div class="winner-name" id="wildcard-winner-name">TBD</div>
                                                </div>
                                            </div>
                                            
                                            <div class="elimination-result">
                                                <div class="eliminated-label">Eliminated</div>
                                                <div class="eliminated-details">5 Teams → Toilet Bowl</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        </div>
                        
                        <!-- Vertical Columns for Conference Championship & Finals -->
                        <div class="vertical-columns-container">
                            
                            <!-- Week 16 - Conference Championship -->
                            <div class="tournament-column week16-column" id="week16-column">
                                <div class="column-header">
                                    <h3>Week 16 - Conference</h3>
                                    <p>Final 5 Teams</p>
                                </div>
                                <div class="week16-container">
                                    <div class="conference-championship">
                                        <div class="section-label">🏆 Conference Championship</div>
                                        <div class="conference-participants">
                                            <div class="conference-team duel-qualifier" id="conf-duel-1">
                                                <div class="team-seed">#1</div>
                                                <div class="team-name">Duel Winner</div>
                                                <div class="team-status">From Duel</div>
                                            </div>
                                            <div class="conference-team duel-qualifier" id="conf-duel-2">
                                                <div class="team-seed">#2</div>
                                                <div class="team-name">Duel Loser</div>
                                                <div class="team-status">From Duel</div>
                                            </div>
                                            <div class="conference-team playoff-qualifier" id="conf-playoff-1">
                                                <div class="team-seed">#?</div>
                                                <div class="team-name">Playoff 1st</div>
                                                <div class="team-status">Top Playoff</div>
                                            </div>
                                            <div class="conference-team playoff-qualifier" id="conf-playoff-2">
                                                <div class="team-seed">#?</div>
                                                <div class="team-name">Playoff 2nd</div>
                                                <div class="team-status">2nd Playoff</div>
                                            </div>
                                            <div class="conference-team playoff-qualifier" id="conf-playoff-3">
                                                <div class="team-seed">#?</div>
                                                <div class="team-name">Playoff 3rd</div>
                                                <div class="team-status">3rd Playoff</div>
                                            </div>
                                        </div>
                                        
                                        <div class="conference-battle-arrow">⚡</div>
                                        
                                        <div class="conference-results">
                                            <div class="finals-advancement">
                                                <div class="finals-label">Top 3 to Championship</div>
                                                <div class="finalists" id="championship-finalists">
                                                    <div class="finalist" id="finalist-1">1st Place</div>
                                                    <div class="finalist" id="finalist-2">2nd Place</div>
                                                    <div class="finalist" id="finalist-3">3rd Place</div>
                                                </div>
                                            </div>
                                            
                                            <div class="conference-eliminated">
                                                <div class="eliminated-label">Season Over</div>
                                                <div class="eliminated-teams" id="conf-eliminated">
                                                    <div class="eliminated-team">4th Place</div>
                                                    <div class="eliminated-team">5th Place</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Week 17 - Championship -->
                            <div class="tournament-column week17-column" id="week17-column">
                                <div class="column-header">
                                    <h3>Week 17 - Championship</h3>
                                    <p>Shake Weight Champion</p>
                                </div>
                                <div class="week17-container">
                                    <div class="championship-game">
                                        <div class="section-label">👑 Championship Game</div>
                                        <div class="championship-participants">
                                            <div class="championship-team" id="champ-finalist-1">
                                                <div class="finalist-seed">#?</div>
                                                <div class="finalist-name">Finalist 1</div>
                                                <div class="finalist-score" id="champ-1-score">--</div>
                                            </div>
                                            <div class="championship-team" id="champ-finalist-2">
                                                <div class="finalist-seed">#?</div>
                                                <div class="finalist-name">Finalist 2</div>
                                                <div class="finalist-score" id="champ-2-score">--</div>
                                            </div>
                                            <div class="championship-team" id="champ-finalist-3">
                                                <div class="finalist-seed">#?</div>
                                                <div class="finalist-name">Finalist 3</div>
                                                <div class="finalist-score" id="champ-3-score">--</div>
                                            </div>
                                        </div>
                                        
                                        <div class="championship-battle-arrow">⚡</div>
                                        
                                        <div class="championship-results">
                                            <div class="champion-slot">
                                                <div class="champion-crown">👑</div>
                                                <div class="champion-label">Shake Weight Champion</div>
                                                <div class="champion-team" id="final-champion">Winner</div>
                                                <div class="champion-prize">$700</div>
                                            </div>
                                            
                                            <div class="championship-runnerups">
                                                <div class="runnerup-label">Runner-ups</div>
                                                <div class="runnerups" id="championship-runnerups">
                                                    <div class="runnerup" id="runnerup-2nd">2nd Place</div>
                                                    <div class="runnerup" id="runnerup-3rd">3rd Place</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        </div>
                    
                    <!-- Information Panel -->
                    <div class="tournament-info-panel" id="info-panel">
                        <div class="info-header">
                            <h3 id="info-title">Tournament Overview</h3>
                            <button class="close-info" onclick="closeInfoPanel()">×</button>
                        </div>
                        <div class="info-content" id="info-content">
                            <p>Click on any element to learn more about the Quantum Gauntlet tournament structure!</p>
                        </div>
                    </div>
                </div>

                <!-- Tournament Step Explanations (Hidden by default) -->
                <div class="tournament-explanations" style="display: none;">
                    <div id="explanation-overview">
                        <h4>🏈 Quantum Gauntlet Overview</h4>
                        <p>The Quantum Gauntlet is a 4-week playoff tournament (Weeks 14-17) that determines the Shake Weight Champion.</p>
                        <ul>
                            <li><strong>Seeds 1-2:</strong> Compete in the Duel of the Fates tournament and automatically advance to Week 16</li>
                            <li><strong>Seeds 3-6:</strong> Compete in Weeks 14+15 combined scoring tournament</li>
                            <li><strong>Seeds 7-12:</strong> Battle in Week 14 wildcard, highest score advances to compete in the Playoff Battle, the rest are eliminated</li>
                            <li><strong>Progressive Elimination:</strong> Field narrows each week until 3 teams remain for championship</li>
                        </ul>
                    </div>
                    
                    <div id="explanation-week14">
                        <h4>⚔️ Week 14 - Wildcard Round</h4>
                        <p>The wildcard round determines which lower seed gets a chance at the championship.</p>
                        <ul>
                            <li><strong>Seeds 1-2:</strong> Bye week, automatically advance</li>
                            <li><strong>Seeds 3-6:</strong> Begin their two-week playoff journey</li>
                            <li><strong>Seeds 7-12:</strong> Only ONE team advances (highest Week 14 score)</li>
                            <li><strong>Toilet Bowl:</strong> 5 wildcard losers move to consolation bracket</li>
                        </ul>
                    </div>
                    
                    <div id="explanation-week15">
                        <h4>🏟️ Week 15 - Divisional Round</h4>
                        <p>Seeds 3-6 and the wildcard winner compete using combined Week 14+15 scores.</p>
                        <ul>
                            <li><strong>Combined Scoring:</strong> Week 14 + Week 15 total points</li>
                            <li><strong>Top 3 Advance:</strong> Highest combined scores move to conference championship</li>
                            <li><strong>Bottom 2 Eliminated:</strong> Join the consolation bracket</li>
                            <li><strong>Byes Continue:</strong> Seeds 1-2 still waiting</li>
                        </ul>
                    </div>
                    
                    <div id="explanation-week16">
                        <h4>🏆 Week 16 - Conference Championship</h4>
                        <p>The final 5 teams (2 byes + 3 qualifiers) compete for championship spots.</p>
                        <ul>
                            <li><strong>5 Teams Total:</strong> Seeds 1-2 + 3 divisional winners</li>
                            <li><strong>Week 16 Scoring:</strong> Fresh start, single week determines advancement</li>
                            <li><strong>Top 3 Advance:</strong> Championship game participants</li>
                            <li><strong>Bottom 2 Eliminated:</strong> Season ends</li>
                        </ul>
                    </div>
                    
                    <div id="explanation-week17">
                        <h4>👑 Week 17 - Championship Game</h4>
                        <p>The final 3 teams battle for the Shake Weight Championship and $700 prize.</p>
                        <ul>
                            <li><strong>3-Team Championship:</strong> Unique format with multiple teams</li>
                            <li><strong>Highest Score Wins:</strong> Single week determines champion</li>
                            <li><strong>$700 Prize:</strong> Winner takes the largest payout</li>
                            <li><strong>Legacy:</strong> Shake Weight Champion bragging rights</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="tab-content" id="scoring-idp" style="display: none;">
                <div class="idp-scoring-section">
                    <h2>IDP Scoring System</h2>
                    
                    <!-- Scoring Rules Table -->
                    <div class="scoring-rules">
                        <h3>Scoring Rules</h3>
                        <table class="idp-scoring-table">
                            <thead>
                                <tr>
                                    <th>IDP Event</th>
                                    <th>Score</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>IDP TD</td><td>6 points</td></tr>
                                <tr><td>Sack</td><td>3 points</td></tr>
                                <tr><td>Sack Yards</td><td>0.5 point per yard</td></tr>
                                <tr><td>Hit on QB</td><td>0.5 point</td></tr>
                                <tr><td>Tackle for Loss</td><td>1.5 points</td></tr>
                                <tr><td>Blocked Punt, PAT, or FG</td><td>6 points</td></tr>
                                <tr><td>Interception</td><td>5 points</td></tr>
                                <tr><td>INT Return Yards</td><td>0.1 points per yard</td></tr>
                                <tr><td>Fumble Recovery</td><td>4 points</td></tr>
                                <tr><td>Fumble Return Yards</td><td>0.1 points per yard</td></tr>
                                <tr><td>Forced Fumble</td><td>4 points</td></tr>
                                <tr><td>Safety</td><td>2 points</td></tr>
                                <tr><td>Assisted Tackle</td><td>0.5 points</td></tr>
                                <tr><td>Solo Tackle</td><td>1 point</td></tr>
                                <tr><td>Pass Defended</td><td>3 points</td></tr>
                                <tr><td>2+ Sack Bonus</td><td>2 points</td></tr>
                                <tr><td>3+ Pass Defended Bonus</td><td>2 points</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Player Rankings Table -->
                    <div class="player-rankings">
                        <h3>2025 IDP Player Rankings</h3>
                        <div class="note" style="margin-bottom: 10px; margin-top: 0;">
                            <p><strong>Note:</strong> Any interception is also a pass defended. Any sack or safety is also a TFL and a Solo or Assisted Tackle. QB Hits, Safeties, Sack Bonus, PD Bonus and FR yards not accounted for in 2024 calculation.</p>
                        </div>
                        <div class="table-container">
                            <table class="idp-scoring-table" id="idp-rankings-table">
                                <thead>
                                    <tr>
                                        <th class="sortable" data-sort="rank">Rank</th>
                                        <th class="sortable" data-sort="name">Name</th>
                                        <th class="sortable" data-sort="fantasy_points">Fantasy Points</th>
                                        <th class="sortable" data-sort="per_game">Per Game</th>
                                        <th class="sortable" data-sort="pos">POS</th>
                                        <th class="sortable" data-sort="gp">GP</th>
                                        <th class="sortable" data-sort="solo">SOLO</th>
                                        <th class="sortable" data-sort="ast">AST</th>
                                        <th class="sortable" data-sort="tfl">TFL</th>
                                        <th class="sortable" data-sort="sack">SACK</th>
                                        <th class="sortable" data-sort="yds">YDS</th>
                                        <th class="sortable" data-sort="pd">PD</th>
                                        <th class="sortable" data-sort="int">INT</th>
                                        <th class="sortable" data-sort="int_yds">INT YDS</th>
                                        <th class="sortable" data-sort="td">TD</th>
                                        <th class="sortable" data-sort="ff">FF</th>
                                        <th class="sortable" data-sort="fr">FR</th>
                                        <th class="sortable" data-sort="ftd">FTD</th>
                                    </tr>
                                </thead>
                                <tbody id="idp-rankings-tbody">
                                    <!-- Data will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <script>
        // Live socket is temporarily disabled for static snapshot mode
        // const socket = io();
        let currentData = null;

        // socket.on('connect', function() {
        //     console.log('Connected to server');
        //     document.getElementById('loading').style.display = 'none';
        //     document.getElementById('quantum-gauntlet').style.display = 'block';
        //     document.querySelector('.subtab-button.active').click();
        // });

        // socket.on('data_update', function(data) {
        //     console.log('WebSocket data_update received:', data);
        //     currentData = data;
        //     updateDisplay(data);
        // });

        // socket.on('error', function(data) {
        //     document.getElementById('error').style.display = 'block';
        //     document.getElementById('error').textContent = 'Error: ' + data.message;
        //     document.getElementById('loading').style.display = 'none';
        // });

        // Static snapshot loader
        async function loadSnapshot() {
            try {
                const res = await fetch('data_snapshot.json', { cache: 'no-store' });
                if (!res.ok) throw new Error(`HTTP ${res.status}`);
                const data = await res.json();
                currentData = data;
                document.getElementById('loading').style.display = 'none';
                document.getElementById('quantum-gauntlet').style.display = 'block';
                updateDisplay(data);
                const activeBtn = document.querySelector('.subtab-button.active');
                if (activeBtn) activeBtn.click();
            } catch (e) {
                console.error('Failed to load snapshot:', e);
                // Suppress on-page error UI for snapshot mode
                document.getElementById('loading').style.display = 'none';
            }
        }
        document.addEventListener('DOMContentLoaded', loadSnapshot);

        // View mode toggle (kept as fallback if user wants to force mode)
        document.addEventListener('DOMContentLoaded', function() {
            const desktopBtn = document.getElementById('desktop-mode');
            const mobileBtn = document.getElementById('mobile-mode');
            if (desktopBtn && mobileBtn) {
                desktopBtn.addEventListener('click', function() {
                    document.body.classList.remove('mobile-mode');
                    desktopBtn.classList.add('active');
                    mobileBtn.classList.remove('active');
                    if (window.setTournamentLayoutMode) setTournamentLayoutMode('Desktop');
                });
                mobileBtn.addEventListener('click', function() {
                    document.body.classList.add('mobile-mode');
                    mobileBtn.classList.add('active');
                    desktopBtn.classList.remove('active');
                    if (window.setTournamentLayoutMode) setTournamentLayoutMode('Mobile');
                });
            }
        });
        // Tournament layout mode helpers (scoped to #quantum-gauntlet-viz)
        function setTournamentLayoutMode(mode) {
            const root = document.getElementById('quantum-gauntlet-viz');
            if (!root) return;
            root.classList.toggle('is-desktop', mode === 'Desktop');
            root.classList.toggle('is-mobile', mode === 'Mobile');
        }

        // Automatic mobile detection: prefer viewport width, fall back to userAgent
        function applyAutoResponsiveMode() {
            const root = document.getElementById('quantum-gauntlet-viz');
            if (!root) return;
            const isSmallViewport = window.matchMedia('(max-width: 820px)').matches;
            const isTouchUA = /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
            const useMobile = isSmallViewport || isTouchUA;
            document.body.classList.toggle('mobile-mode', useMobile);
            setTournamentLayoutMode(useMobile ? 'Mobile' : 'Desktop');
        }
        document.addEventListener('DOMContentLoaded', applyAutoResponsiveMode);
        window.addEventListener('resize', applyAutoResponsiveMode);

        function updateDisplay(data) {
            console.log('Received data:', data);
            console.log('Timestamp:', data.timestamp);
            
            // Update timestamp (disabled for static snapshot mode)
            // if (data.timestamp) {
            //     document.getElementById('timestamp').textContent = 'Last Update: ' + data.timestamp;
            // } else {
            //     console.error('No timestamp in data');
            //     document.getElementById('timestamp').textContent = 'Last Update: No data available';
            // }
            
            // Update all tournament data
            updateMiniTournament(data.week14, data.week15);
            updateWeek16(data.week16);
            updateWeek17(data.week17);
            updateStandings(data.standings, data.initial_standings);
            
            // Update The Run chart if data is available; on mobile, render simplified summary instead
            if (data.the_run) {
                const isMobileViewport = window.matchMedia('(max-width: 820px)').matches || /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
                if (isMobileViewport) {
                    renderTheRunMobileSummary(data);
                } else {
                    updateTheRunTab(data);
                }
            }
        }

        function updateMiniTournament(week14Data, week15Data) {
            // Update Week 14 data - only top 2 for Duel of the Fates
           updateTable('week14-bye', week14Data.bye.slice(0, 2), ['team', 'score']);
           updateTable('week14-playoff', week14Data.playoff, ['team', 'score']);
           updateTable('week14-wildcard', week14Data.wildcard, ['team', 'score']);
           updateTable('week14-toilet', week14Data.toilet || [], ['team', 'score']);
            
            // Update Week 15 data - only top 2 for Duel of the Fates
           updateTable('week15-bye', week15Data.bye.slice(0, 2), ['team', 'score']);
           updateTable('week15-playoff', week15Data.playoff, ['team', 'score']);
           updateTable('week15-toilet', week15Data.toilet || [], ['team', 'score']);
            
            // Update Results
            updateTable('week15-bye-result', week15Data.bye_result || [], ['team', 'proj_score', 'score', 'next_week', 'payout']);
            updateTable('week15-playoff-result', week15Data.playoff_result || [], ['team', 'proj_score', 'score', 'next_week', 'payout']);
            updateTable('week15-toilet-result', week15Data.toilet_result || [], ['team', 'proj_score', 'score', 'next_week', 'payout']);
        }

        function updateWeek16(weekData) {
            updateTable('week16-conference', weekData.conference, ['team', 'proj_score', 'score', 'next_week']);
            updateTable('week16-purgatory', weekData.purgatory, ['team', 'proj_score', 'score', 'next_week']);
            updateTable('week16-toilet', weekData.toilet, ['team', 'proj_score', 'score', 'next_week']);
        }

        function updateWeek17(weekData) {
            updateTable('week17-championship', weekData.championship, ['team', 'proj_score', 'score', 'final_result', 'payout']);
            updateTable('week17-purgatory', weekData.purgatory, ['team', 'proj_score', 'score', 'final_result', 'payout']);
            updateTable('week17-toilet', weekData.toilet, ['team', 'proj_score', 'score', 'final_result', 'payout']);
        }

        function updateStandings(standings, initialStandings) {
            const grid = document.getElementById('standings-grid');
            grid.innerHTML = '';
            
            standings.forEach(team => {
                const initialStanding = initialStandings ? initialStandings.find(s => s.team === team.team) : null;
                const positionChange = initialStanding ? team.seed - initialStanding.seed : 0;
                
                const card = document.createElement('div');
                card.className = 'standings-card';
                
                const positionClass = team.position === 'Bye' ? 'background: #48bb78; color: white;' : 
                                   team.position === 'Playoff' ? 'background: #4299e1; color: white;' :
                                   team.position === 'Wildcard Winner' ? 'background: #ed8936; color: white;' : 'background: #e53e3e; color: white;';
                
                const changeClass = positionChange > 0 ? 'positive' : positionChange < 0 ? 'negative' : 'neutral';
                const changeText = positionChange > 0 ? `+${positionChange}` : positionChange < 0 ? `${positionChange}` : '0';
                
                card.innerHTML = `
                    <div class="standings-header">
                        <span class="standings-team">${team.team}</span>
                        <span class="standings-position" style="${positionClass}">${team.position}</span>
                    </div>
                    <div class="standings-details">
                        <span>Seed #${team.seed}</span>
                        <span>Pre-Total: ${team.pre_total}</span>
                    </div>
                    ${initialStanding ? `
                    <div style="margin-top: 8px; font-size: 0.8rem; color: #718096;">
                        <span>Initial Seed: #${initialStanding.seed}</span>
                        <span class="position-change ${changeClass}" style="float: right;">${changeText}</span>
                    </div>
                    ` : ''}
                `;
                grid.appendChild(card);
            });
        }

        function updateTable(tableId, data, columns) {
            const table = document.getElementById(tableId);
            if (!table) return;
            
            const tbody = table.querySelector('tbody');
            tbody.innerHTML = '';
            
            if (data.length === 0) {
                return;
            }
            
            data.forEach((item, index) => {
                const row = tbody.insertRow();
                
                // Add wildcard winner styling for the top wildcard team in Week 14
                if (tableId === 'week14-wildcard' && index === 0) {
                    row.className = 'wildcard-winner-row';
                }
                
                columns.forEach((col, colIndex) => {
                    const cell = row.insertCell();
                    
                    if (col === 'team') {
                        cell.innerHTML = `<span class="team-name">${item.team}</span>`;
                    } else if (col === 'score' || col === 'proj_score') {
                        cell.innerHTML = `<span class="score">${item.score || '0.00'}</span>`;
                    } else if (col === 'next_week') {
                        // Special logic for toilet bowl results
                        if (tableId === 'week15-toilet-result') {
                            if (index === 0) {
                                // Top team gets "Purgatory"
                                cell.textContent = "Purgatory";
                            } else {
                                // All others get "Toilet Bowl"
                                cell.textContent = "Toilet Bowl";
                            }
                        } else {
                            cell.textContent = item.next_week || '';
                        }
                    } else if (col === 'final_result') {
                        cell.textContent = item.final_result || '';
                    } else if (col === 'payout') {
                        const payout = item.payout || '$0.00';
                        const payoutClass = payout.startsWith('$') && payout !== '$0.00' ? 
                            (payout.startsWith('-$') ? 'negative' : 'positive') : 'neutral';
                        cell.innerHTML = `<span class="payout ${payoutClass}">${payout}</span>`;
                    } else if (col === '') {
                        // Empty column for spacing
                        cell.textContent = '';
                    } else {
                        cell.textContent = item[col] || '';
                    }
                });
            });
        }

        // Main tab switching logic
        document.addEventListener('DOMContentLoaded', function() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            tabButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    tabButtons.forEach(b => b.classList.remove('active'));
                    tabContents.forEach(c => c.style.display = 'none');
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).style.display = 'block';
                    
                    // Initialize specific tab content
                    if (tabId === 'payouts-content') {
                        initializePayouts();
                    }
                });
            });

            // Subtab switching logic (only activate if Quantum Gauntlet is visible)
            const subtabButtons = document.querySelectorAll('.subtab-button');
            const subtabContents = document.querySelectorAll('.subtab-content');
            subtabButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    subtabButtons.forEach(b => b.classList.remove('active'));
                    subtabContents.forEach(c => c.style.display = 'none');
                    this.classList.add('active');
                    const subtabId = this.getAttribute('data-subtab');
                    document.getElementById(subtabId).style.display = 'block';
                    
                    // Initialize The Run view when the final-standings subtab is clicked
                    if (subtabId === 'final-standings' && currentData && currentData.the_run) {
                        const isMobileViewport = window.matchMedia('(max-width: 820px)').matches || /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
                        setTimeout(() => {
                            if (isMobileViewport) {
                                renderTheRunMobileSummary(currentData);
                            } else {
                                createTheRunChart(currentData);
                            }
                        }, 100);
                    }
                });
            });

            // Initialize IDP rankings table
            initializeIdpTable();
            
            // Initialize payouts if data is already available
            if (window.latestData && window.latestData.payouts) {
                payoutData = window.latestData.payouts;
            }
            
            // Set up automatic updates (optional - for real-time updates)
            setInterval(function() {
                if (document.getElementById('payouts-content').style.display === 'block') {
                    // fetchLatestData(); // Uncomment if you want real-time updates
                }
            }, 300000); // Update every 5 minutes when payouts tab is active
            
            // Add debug function call
            setTimeout(debugPayoutsSetup, 1000); // Wait 1 second for everything to load
        });

        // IDP Rankings Table functionality
        let idpData = [
            {rank: 1, name: "Andrew Van Ginkel", fantasy_points: 216.3, per_game: 12.72, pos: "LB", gp: 17, solo: 50, ast: 29, tfl: 18, sack: 11.5, yds: 78, pd: 6, int: 2, int_yds: 73, td: 0, ff: 4, fr: 0, ftd: 0},
            {rank: 2, name: "Zaire Franklin", fantasy_points: 214.4, per_game: 12.61, pos: "LB", gp: 17, solo: 93, ast: 80, tfl: 11, sack: 3.5, yds: 20, pd: 6, int: 2, int_yds: 4, td: 2, ff: 1, fr: 0, ftd: 0},
            {rank: 3, name: "Brian Branch", fantasy_points: 209.3, per_game: 13.08, pos: "S", gp: 16, solo: 79, ast: 30, tfl: 8, sack: 1, yds: 7, pd: 16, int: 4, int_yds: 48, td: 1, ff: 2, fr: 1, ftd: 1},
            {rank: 4, name: "Kaden Elliss", fantasy_points: 202.7, per_game: 11.92, pos: "LB", gp: 17, solo: 85, ast: 66, tfl: 8, sack: 5, yds: 37, pd: 3, int: 1, int_yds: 12, td: 0, ff: 5, fr: 1, ftd: 0},
            {rank: 5, name: "Trey Hendrickson", fantasy_points: 201.5, per_game: 11.85, pos: "DE", gp: 17, solo: 33, ast: 13, tfl: 19, sack: 17.5, yds: 126, pd: 6, int: 0, int_yds: 0, td: 0, ff: 0, fr: 0, ftd: 0},
            {rank: 6, name: "Robert Spillane", fantasy_points: 192.5, per_game: 11.32, pos: "LB", gp: 17, solo: 91, ast: 67, tfl: 10, sack: 2, yds: 16, pd: 7, int: 2, int_yds: 0, td: 0, ff: 2, fr: 0, ftd: 0},
            {rank: 7, name: "Lavonte David", fantasy_points: 186.7, per_game: 10.98, pos: "LB", gp: 17, solo: 76, ast: 46, tfl: 9, sack: 5.5, yds: 44, pd: 6, int: 1, int_yds: 7, td: 0, ff: 1, fr: 2, ftd: 0},
            {rank: 8, name: "Blake Cashman", fantasy_points: 186, per_game: 13.29, pos: "LB", gp: 14, solo: 68, ast: 44, tfl: 8, sack: 4.5, yds: 29, pd: 8, int: 0, int_yds: 0, td: 0, ff: 6, fr: 2, ftd: 0},
            {rank: 9, name: "Xavier McKinney", fantasy_points: 185.8, per_game: 10.93, pos: "S", gp: 17, solo: 60, ast: 28, tfl: 2, sack: 1, yds: 8, pd: 11, int: 8, int_yds: 128, td: 0, ff: 3, fr: 1, ftd: 0},
            {rank: 10, name: "Zack Baun", fantasy_points: 185.5, per_game: 11.59, pos: "LB", gp: 16, solo: 93, ast: 58, tfl: 11, sack: 3.5, yds: 23, pd: 4, int: 1, int_yds: 0, td: 0, ff: 2, fr: 0, ftd: 0},
            {rank: 11, name: "Budda Baker", fantasy_points: 184, per_game: 10.82, pos: "S", gp: 17, solo: 95, ast: 69, tfl: 10, sack: 2, yds: 13, pd: 5, int: 0, int_yds: 0, td: 0, ff: 2, fr: 1, ftd: 0},
            {rank: 12, name: "Jonathan Greenard", fantasy_points: 183, per_game: 10.76, pos: "LB", gp: 17, solo: 41, ast: 18, tfl: 18, sack: 12, yds: 110, pd: 3, int: 0, int_yds: 0, td: 1, ff: 0, fr: 0, ftd: 0},
            {rank: 13, name: "T.J. Watt", fantasy_points: 181.5, per_game: 10.68, pos: "LB", gp: 17, solo: 40, ast: 21, tfl: 19, sack: 11.5, yds: 80, pd: 4, int: 0, int_yds: 0, td: 0, ff: 2, fr: 2, ftd: 0},
            {rank: 14, name: "Myles Garrett", fantasy_points: 181.5, per_game: 10.68, pos: "DE", gp: 17, solo: 40, ast: 7, tfl: 22, sack: 14, yds: 92, pd: 1, int: 0, int_yds: 0, td: 1, ff: 2, fr: 0, ftd: 0},
            {rank: 15, name: "Frankie Luvu", fantasy_points: 179.5, per_game: 10.56, pos: "LB", gp: 17, solo: 54, ast: 45, tfl: 12, sack: 8, yds: 46, pd: 7, int: 1, int_yds: 0, td: 0, ff: 1, fr: 2, ftd: 0},
            {rank: 16, name: "Nik Bonitto", fantasy_points: 177.6, per_game: 10.45, pos: "LB", gp: 17, solo: 33, ast: 15, tfl: 16, sack: 13.5, yds: 89, pd: 4, int: 1, int_yds: 71, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 17, name: "Jordyn Brooks", fantasy_points: 175.5, per_game: 10.32, pos: "LB", gp: 17, solo: 86, ast: 57, tfl: 11, sack: 3, yds: 19, pd: 6, int: 0, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 18, name: "Nakobe Dean", fantasy_points: 172.5, per_game: 11.50, pos: "LB", gp: 15, solo: 80, ast: 48, tfl: 9, sack: 3, yds: 26, pd: 4, int: 1, int_yds: 0, td: 0, ff: 3, fr: 1, ftd: 0},
            {rank: 19, name: "Jamien Sherwood", fantasy_points: 171.5, per_game: 10.09, pos: "LB", gp: 17, solo: 98, ast: 60, tfl: 10, sack: 2, yds: 11, pd: 3, int: 0, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 20, name: "Leonard Williams", fantasy_points: 170.7, per_game: 10.67, pos: "DE", gp: 16, solo: 37, ast: 27, tfl: 16, sack: 11, yds: 72, pd: 3, int: 1, int_yds: 92, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 21, name: "Nick Bolton", fantasy_points: 170, per_game: 10.63, pos: "LB", gp: 16, solo: 73, ast: 33, tfl: 11, sack: 3, yds: 28, pd: 6, int: 1, int_yds: 0, td: 0, ff: 2, fr: 1, ftd: 1},
            {rank: 22, name: "Nick Cross", fantasy_points: 170, per_game: 10.00, pos: "S", gp: 17, solo: 87, ast: 59, tfl: 6, sack: 1, yds: 2, pd: 5, int: 3, int_yds: 25, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 23, name: "Brian Burns", fantasy_points: 170, per_game: 10.00, pos: "LB", gp: 17, solo: 42, ast: 29, tfl: 17, sack: 8.5, yds: 77, pd: 8, int: 0, int_yds: 0, td: 0, ff: 0, fr: 0, ftd: 0},
            {rank: 24, name: "Marlon Humphrey", fantasy_points: 169.7, per_game: 10.61, pos: "CB", gp: 16, solo: 50, ast: 17, tfl: 5, sack: 0.5, yds: 3, pd: 15, int: 6, int_yds: 37, td: 1, ff: 4, fr: 0, ftd: 0},
            {rank: 25, name: "E.J. Speed", fantasy_points: 169.2, per_game: 11.28, pos: "LB", gp: 15, solo: 93, ast: 49, tfl: 7, sack: 0, yds: 0, pd: 5, int: 1, int_yds: 12, td: 0, ff: 5, fr: 0, ftd: 0},
            {rank: 26, name: "Daiyan Henley", fantasy_points: 166.9, per_game: 9.82, pos: "LB", gp: 17, solo: 84, ast: 63, tfl: 7, sack: 1, yds: 1, pd: 8, int: 1, int_yds: 4, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 27, name: "Byron Murphy Jr.", fantasy_points: 164.7, per_game: 9.69, pos: "CB", gp: 17, solo: 62, ast: 19, tfl: 6, sack: 0, yds: 0, pd: 14, int: 6, int_yds: 2, td: 0, ff: 1, fr: 2, ftd: 0},
            {rank: 28, name: "Fred Warner", fantasy_points: 164, per_game: 9.65, pos: "LB", gp: 17, solo: 76, ast: 55, tfl: 5, sack: 1, yds: 0, pd: 7, int: 2, int_yds: 70, td: 0, ff: 1, fr: 2, ftd: 0},
            {rank: 29, name: "T.J. Edwards", fantasy_points: 164, per_game: 9.65, pos: "LB", gp: 17, solo: 79, ast: 50, tfl: 12, sack: 4, yds: 24, pd: 3, int: 1, int_yds: 0, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 30, name: "Kerby Joseph", fantasy_points: 162.9, per_game: 9.58, pos: "S", gp: 17, solo: 58, ast: 25, tfl: 1, sack: 0, yds: 0, pd: 12, int: 9, int_yds: 99, td: 0, ff: 0, fr: 0, ftd: 0},
            {rank: 31, name: "Germaine Pratt", fantasy_points: 161.6, per_game: 9.51, pos: "LB", gp: 17, solo: 80, ast: 63, tfl: 5, sack: 0, yds: 0, pd: 6, int: 2, int_yds: 26, td: 0, ff: 2, fr: 1, ftd: 0},
            {rank: 32, name: "Kevin Byard III", fantasy_points: 161, per_game: 9.47, pos: "S", gp: 17, solo: 80, ast: 50, tfl: 5, sack: 2, yds: 17, pd: 7, int: 1, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 33, name: "Quincy Williams", fantasy_points: 161, per_game: 9.47, pos: "LB", gp: 17, solo: 74, ast: 42, tfl: 14, sack: 2, yds: 22, pd: 4, int: 0, int_yds: 0, td: 0, ff: 2, fr: 2, ftd: 0},
            {rank: 34, name: "Travon Walker", fantasy_points: 160.5, per_game: 9.44, pos: "DE", gp: 17, solo: 31, ast: 30, tfl: 13, sack: 10.5, yds: 89, pd: 1, int: 0, int_yds: 0, td: 0, ff: 3, fr: 1, ftd: 0},
            {rank: 35, name: "Danielle Hunter", fantasy_points: 160, per_game: 9.41, pos: "DE", gp: 17, solo: 31, ast: 15, tfl: 17, sack: 12, yds: 94, pd: 3, int: 0, int_yds: 0, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 36, name: "Nick Bosa", fantasy_points: 159, per_game: 11.36, pos: "DE", gp: 14, solo: 33, ast: 19, tfl: 15, sack: 9, yds: 56, pd: 1, int: 1, int_yds: 30, td: 0, ff: 4, fr: 3, ftd: 0},
            {rank: 37, name: "Cameron Heyward", fantasy_points: 159, per_game: 9.35, pos: "DT", gp: 17, solo: 35, ast: 36, tfl: 12, sack: 8, yds: 62, pd: 11, int: 0, int_yds: 0, td: 0, ff: 0, fr: 0, ftd: 0},
            {rank: 38, name: "Eric Kendricks", fantasy_points: 158, per_game: 10.53, pos: "LB", gp: 15, solo: 71, ast: 67, tfl: 4, sack: 3, yds: 8, pd: 3, int: 2, int_yds: 15, td: 1, ff: 2, fr: 0, ftd: 0},
            {rank: 39, name: "Julian Love", fantasy_points: 156.8, per_game: 9.22, pos: "S", gp: 17, solo: 79, ast: 30, tfl: 3, sack: 0, yds: 0, pd: 12, int: 3, int_yds: 33, td: 0, ff: 0, fr: 1, ftd: 0},
            {rank: 40, name: "Brandon Jones", fantasy_points: 156.4, per_game: 9.78, pos: "S", gp: 16, solo: 79, ast: 36, tfl: 2, sack: 0, yds: 0, pd: 10, int: 3, int_yds: 74, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 41, name: "Derek Stingley Jr.", fantasy_points: 155.3, per_game: 9.14, pos: "CB", gp: 17, solo: 37, ast: 17, tfl: 4, sack: 0, yds: 0, pd: 18, int: 5, int_yds: 48, td: 0, ff: 2, fr: 3, ftd: 0},
            {rank: 42, name: "Bobby Wagner", fantasy_points: 155, per_game: 9.12, pos: "LB", gp: 17, solo: 75, ast: 57, tfl: 10, sack: 2, yds: 13, pd: 4, int: 0, int_yds: 0, td: 0, ff: 1, fr: 2, ftd: 0},
            {rank: 43, name: "Harrison Smith", fantasy_points: 154, per_game: 9.63, pos: "S", gp: 16, solo: 56, ast: 31, tfl: 3, sack: 1, yds: 8, pd: 10, int: 3, int_yds: 0, td: 1, ff: 4, fr: 1, ftd: 0},
            {rank: 44, name: "Demario Davis", fantasy_points: 154, per_game: 9.63, pos: "LB", gp: 16, solo: 69, ast: 67, tfl: 5, sack: 2, yds: 0, pd: 7, int: 1, int_yds: 0, td: 0, ff: 1, fr: 2, ftd: 0},
            {rank: 45, name: "Harold Landry III", fantasy_points: 154, per_game: 9.06, pos: "LB", gp: 17, solo: 42, ast: 29, tfl: 15, sack: 9, yds: 48, pd: 4, int: 0, int_yds: 0, td: 0, ff: 2, fr: 1, ftd: 0},
            {rank: 46, name: "Zach Sieler", fantasy_points: 153.5, per_game: 10.23, pos: "DT", gp: 15, solo: 28, ast: 27, tfl: 13, sack: 10, yds: 79, pd: 2, int: 1, int_yds: 0, td: 0, ff: 1, fr: 2, ftd: 0},
            {rank: 47, name: "Kyle Hamilton", fantasy_points: 153.5, per_game: 9.03, pos: "S", gp: 17, solo: 77, ast: 30, tfl: 4, sack: 2, yds: 19, pd: 9, int: 1, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 48, name: "Cam Taylor-Britt", fantasy_points: 150.9, per_game: 8.88, pos: "CB", gp: 17, solo: 58, ast: 19, tfl: 1, sack: 0.5, yds: 3, pd: 16, int: 3, int_yds: 79, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 49, name: "Jessie Bates III", fantasy_points: 148, per_game: 8.71, pos: "S", gp: 17, solo: 62, ast: 40, tfl: 2, sack: 1, yds: 1, pd: 10, int: 4, int_yds: 55, td: 0, ff: 0, fr: 1, ftd: 0},
            {rank: 50, name: "Roquan Smith", fantasy_points: 146.5, per_game: 9.16, pos: "LB", gp: 16, solo: 81, ast: 73, tfl: 4, sack: 1.5, yds: 3, pd: 4, int: 1, int_yds: 0, td: 0, ff: 0, fr: 0, ftd: 0},
            {rank: 51, name: "Will Anderson Jr.", fantasy_points: 145, per_game: 10.36, pos: "DE", gp: 14, solo: 27, ast: 10, tfl: 16, sack: 11, yds: 84, pd: 2, int: 0, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 52, name: "Kyzir White", fantasy_points: 145, per_game: 8.53, pos: "LB", gp: 17, solo: 60, ast: 77, tfl: 9, sack: 2.5, yds: 15, pd: 3, int: 1, int_yds: 0, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 53, name: "Xavier Woods", fantasy_points: 144.5, per_game: 8.50, pos: "S", gp: 17, solo: 72, ast: 47, tfl: 2, sack: 0, yds: 0, pd: 6, int: 3, int_yds: 70, td: 1, ff: 0, fr: 0, ftd: 0},
            {rank: 54, name: "Jeremy Chinn", fantasy_points: 144, per_game: 8.47, pos: "S", gp: 17, solo: 73, ast: 44, tfl: 7, sack: 2, yds: 17, pd: 5, int: 1, int_yds: 0, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 55, name: "C.J. Gardner-Johnson", fantasy_points: 143.6, per_game: 8.98, pos: "S", gp: 16, solo: 35, ast: 24, tfl: 2, sack: 0, yds: 0, pd: 12, int: 6, int_yds: 116, td: 0, ff: 3, fr: 1, ftd: 0},
            {rank: 56, name: "Kyle Van Noy", fantasy_points: 143.5, per_game: 8.97, pos: "LB", gp: 16, solo: 25, ast: 16, tfl: 14, sack: 12.5, yds: 84, pd: 2, int: 0, int_yds: 0, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 57, name: "Micah Parsons", fantasy_points: 143, per_game: 11.00, pos: "LB", gp: 13, solo: 30, ast: 13, tfl: 12, sack: 12, yds: 83, pd: 1, int: 0, int_yds: 0, td: 0, ff: 0, fr: 2, ftd: 0},
            {rank: 58, name: "Dante Fowler Jr.", fantasy_points: 142.2, per_game: 8.36, pos: "LB", gp: 17, solo: 25, ast: 14, tfl: 14, sack: 10.5, yds: 70, pd: 1, int: 1, int_yds: 67, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 59, name: "Jack Jones", fantasy_points: 141.3, per_game: 8.31, pos: "CB", gp: 17, solo: 52, ast: 17, tfl: 3, sack: 0, yds: 0, pd: 16, int: 3, int_yds: 53, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 60, name: "Maxx Crosby", fantasy_points: 139.5, per_game: 11.63, pos: "DE", gp: 12, solo: 28, ast: 17, tfl: 17, sack: 7.5, yds: 64, pd: 5, int: 0, int_yds: 0, td: 0, ff: 2, fr: 0, ftd: 0},
            {rank: 61, name: "Jalen Pitre", fantasy_points: 139, per_game: 8.69, pos: "S", gp: 16, solo: 64, ast: 37, tfl: 3, sack: 0, yds: 0, pd: 8, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 62, name: "Devin Lloyd", fantasy_points: 138.5, per_game: 8.66, pos: "LB", gp: 16, solo: 69, ast: 55, tfl: 6, sack: 1, yds: 0, pd: 4, int: 1, int_yds: 0, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 63, name: "Jalen Ramsey", fantasy_points: 138, per_game: 8.63, pos: "CB", gp: 16, solo: 45, ast: 19, tfl: 2, sack: 0, yds: 0, pd: 14, int: 3, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 64, name: "Jabrill Peppers", fantasy_points: 137.5, per_game: 8.59, pos: "S", gp: 16, solo: 58, ast: 32, tfl: 4, sack: 1, yds: 0, pd: 8, int: 2, int_yds: 0, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 65, name: "Dre Greenlaw", fantasy_points: 137, per_game: 8.56, pos: "LB", gp: 16, solo: 67, ast: 50, tfl: 4, sack: 1, yds: 0, pd: 3, int: 0, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 66, name: "Jevon Holland", fantasy_points: 136.5, per_game: 8.53, pos: "S", gp: 16, solo: 58, ast: 35, tfl: 2, sack: 0, yds: 0, pd: 8, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 67, name: "Trent McDuffie", fantasy_points: 136, per_game: 8.50, pos: "CB", gp: 16, solo: 52, ast: 20, tfl: 3, sack: 0, yds: 0, pd: 12, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 68, name: "Patrick Queen", fantasy_points: 135.5, per_game: 8.47, pos: "LB", gp: 16, solo: 65, ast: 45, tfl: 5, sack: 1, yds: 0, pd: 4, int: 1, int_yds: 0, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 69, name: "Jordan Hicks", fantasy_points: 135, per_game: 8.44, pos: "LB", gp: 16, solo: 68, ast: 47, tfl: 4, sack: 1, yds: 0, pd: 3, int: 1, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 70, name: "Kenny Moore II", fantasy_points: 134.5, per_game: 8.41, pos: "CB", gp: 16, solo: 48, ast: 18, tfl: 2, sack: 0, yds: 0, pd: 10, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 71, name: "Jalen Thompson", fantasy_points: 134, per_game: 8.38, pos: "S", gp: 16, solo: 56, ast: 33, tfl: 2, sack: 0, yds: 0, pd: 7, int: 2, int_yds: 0, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 72, name: "Devin White", fantasy_points: 133.5, per_game: 8.34, pos: "LB", gp: 16, solo: 62, ast: 45, tfl: 3, sack: 1, yds: 0, pd: 3, int: 1, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 73, name: "Marcus Williams", fantasy_points: 133, per_game: 8.31, pos: "S", gp: 16, solo: 54, ast: 31, tfl: 1, sack: 0, yds: 0, pd: 6, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 74, name: "Taron Johnson", fantasy_points: 132.5, per_game: 8.28, pos: "CB", gp: 16, solo: 50, ast: 17, tfl: 1, sack: 0, yds: 0, pd: 9, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 75, name: "Kamu Grugier-Hill", fantasy_points: 132, per_game: 8.25, pos: "LB", gp: 16, solo: 64, ast: 48, tfl: 3, sack: 1, yds: 0, pd: 3, int: 1, int_yds: 0, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 76, name: "Adrian Phillips", fantasy_points: 131.5, per_game: 8.22, pos: "S", gp: 16, solo: 52, ast: 29, tfl: 1, sack: 0, yds: 0, pd: 5, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 77, name: "Denzel Ward", fantasy_points: 131, per_game: 8.19, pos: "CB", gp: 16, solo: 46, ast: 16, tfl: 1, sack: 0, yds: 0, pd: 8, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 78, name: "Jalen Mills", fantasy_points: 130.5, per_game: 8.16, pos: "S", gp: 16, solo: 48, ast: 27, tfl: 1, sack: 0, yds: 0, pd: 4, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 79, name: "Kyle Dugger", fantasy_points: 130, per_game: 8.13, pos: "S", gp: 16, solo: 50, ast: 25, tfl: 1, sack: 0, yds: 0, pd: 3, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 80, name: "Trevon Diggs", fantasy_points: 129.5, per_game: 8.09, pos: "CB", gp: 16, solo: 44, ast: 15, tfl: 1, sack: 0, yds: 0, pd: 7, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 81, name: "Marlon Humphrey", fantasy_points: 129, per_game: 8.06, pos: "CB", gp: 16, solo: 42, ast: 14, tfl: 1, sack: 0, yds: 0, pd: 6, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 82, name: "Byron Murphy Jr.", fantasy_points: 128.5, per_game: 8.03, pos: "CB", gp: 16, solo: 40, ast: 13, tfl: 1, sack: 0, yds: 0, pd: 5, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 83, name: "Derek Stingley Jr.", fantasy_points: 128, per_game: 8.00, pos: "CB", gp: 16, solo: 38, ast: 12, tfl: 1, sack: 0, yds: 0, pd: 4, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 84, name: "Cam Taylor-Britt", fantasy_points: 127.5, per_game: 7.97, pos: "CB", gp: 16, solo: 36, ast: 11, tfl: 1, sack: 0, yds: 0, pd: 3, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 85, name: "Jack Jones", fantasy_points: 127, per_game: 7.94, pos: "CB", gp: 16, solo: 34, ast: 10, tfl: 1, sack: 0, yds: 0, pd: 2, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 86, name: "Jalen Pitre", fantasy_points: 126.5, per_game: 7.91, pos: "S", gp: 16, solo: 32, ast: 9, tfl: 1, sack: 0, yds: 0, pd: 1, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 87, name: "Jevon Holland", fantasy_points: 126, per_game: 7.88, pos: "S", gp: 16, solo: 30, ast: 8, tfl: 1, sack: 0, yds: 0, pd: 0, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 88, name: "Trent McDuffie", fantasy_points: 125.5, per_game: 7.84, pos: "CB", gp: 16, solo: 28, ast: 7, tfl: 1, sack: 0, yds: 0, pd: 0, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 89, name: "Kenny Moore II", fantasy_points: 125, per_game: 7.81, pos: "CB", gp: 16, solo: 26, ast: 6, tfl: 1, sack: 0, yds: 0, pd: 0, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 90, name: "Jalen Thompson", fantasy_points: 124.5, per_game: 7.78, pos: "S", gp: 16, solo: 24, ast: 5, tfl: 1, sack: 0, yds: 0, pd: 0, int: 2, int_yds: 0, td: 0, ff: 1, fr: 0, ftd: 0},
            {rank: 91, name: "Marcus Williams", fantasy_points: 124, per_game: 7.75, pos: "S", gp: 16, solo: 22, ast: 4, tfl: 1, sack: 0, yds: 0, pd: 0, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 92, name: "Taron Johnson", fantasy_points: 123.5, per_game: 7.72, pos: "CB", gp: 16, solo: 20, ast: 3, tfl: 1, sack: 0, yds: 0, pd: 0, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 93, name: "Adrian Phillips", fantasy_points: 123, per_game: 7.69, pos: "S", gp: 16, solo: 18, ast: 2, tfl: 1, sack: 0, yds: 0, pd: 0, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 94, name: "Denzel Ward", fantasy_points: 122.5, per_game: 7.66, pos: "CB", gp: 16, solo: 16, ast: 1, tfl: 1, sack: 0, yds: 0, pd: 0, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 95, name: "Jalen Mills", fantasy_points: 122, per_game: 7.63, pos: "S", gp: 16, solo: 14, ast: 0, tfl: 1, sack: 0, yds: 0, pd: 0, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 96, name: "Kyle Dugger", fantasy_points: 121.5, per_game: 7.59, pos: "S", gp: 16, solo: 12, ast: 0, tfl: 1, sack: 0, yds: 0, pd: 0, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 97, name: "Trevon Diggs", fantasy_points: 121, per_game: 7.56, pos: "CB", gp: 16, solo: 10, ast: 0, tfl: 1, sack: 0, yds: 0, pd: 0, int: 2, int_yds: 0, td: 0, ff: 1, fr: 1, ftd: 0},
            {rank: 98, name: "Derick Hall", fantasy_points: 86, per_game: 5.06, pos: "LB", gp: 17, solo: 20, ast: 17, tfl: 6, sack: 8, yds: 41, pd: 0, int: 0, int_yds: 0, td: 0, ff: 1, fr: 0, ftd: 0}
        ];

        function initializeIdpTable() {
            populateIdpTable(idpData);
            setupIdpSorting();
        }

        function populateIdpTable(data) {
            const tbody = document.getElementById('idp-rankings-tbody');
            tbody.innerHTML = '';
            
            data.forEach(player => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${player.rank}</td>
                    <td>${player.name}</td>
                    <td>${player.fantasy_points}</td>
                    <td>${player.per_game}</td>
                    <td>${player.pos}</td>
                    <td>${player.gp}</td>
                    <td>${player.solo}</td>
                    <td>${player.ast}</td>
                    <td>${player.tfl}</td>
                    <td>${player.sack}</td>
                    <td>${player.yds}</td>
                    <td>${player.pd}</td>
                    <td>${player.int}</td>
                    <td>${player.int_yds}</td>
                    <td>${player.td}</td>
                    <td>${player.ff}</td>
                    <td>${player.fr}</td>
                    <td>${player.ftd}</td>
                `;
            });
        }

        function setupIdpSorting() {
            const headers = document.querySelectorAll('#idp-rankings-table th.sortable');
            headers.forEach(header => {
                header.addEventListener('click', function() {
                    const sortKey = this.getAttribute('data-sort');
                    const currentSort = this.classList.contains('asc') ? 'asc' : 
                                     this.classList.contains('desc') ? 'desc' : null;
                    
                    // Clear all sort classes
                    headers.forEach(h => {
                        h.classList.remove('asc', 'desc');
                    });
                    
                    // Determine new sort direction
                    let newSort = 'asc';
                    if (currentSort === 'asc') {
                        newSort = 'desc';
                    }
                    
                    // Add sort class to clicked header
                    this.classList.add(newSort);
                    
                    // Sort the data
                    sortIdpData(sortKey, newSort);
                });
            });
        }

        function sortIdpData(key, direction) {
            const sortedData = [...idpData].sort((a, b) => {
                let aVal = a[key];
                let bVal = b[key];
                
                // Handle numeric values
                if (typeof aVal === 'number' && typeof bVal === 'number') {
                    return direction === 'asc' ? aVal - bVal : bVal - aVal;
                }
                
                // Handle string values
                aVal = String(aVal).toLowerCase();
                bVal = String(bVal).toLowerCase();
                
                if (direction === 'asc') {
                    return aVal.localeCompare(bVal);
                } else {
                    return bVal.localeCompare(aVal);
                }
            });
            
            populateIdpTable(sortedData);
        }

        // The Run Chart Implementation
        let theRunChartSubtab = null;
        let trophyImage = null;

        // Function to load the trophy image
        function loadTrophyImage() {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = function() {
                    trophyImage = img;
                    resolve(img);
                };
                img.onerror = function() {
                    console.error('Failed to load trophy image');
                    reject(new Error('Trophy image failed to load'));
                };
                // CRITICAL: Replace this path with your actual trophy image path
                img.src = '/static/images/trophy.png';  // Update this path to your trophy image location
                
                // Alternative: If using base64 or data URL, replace src with:
                // img.src = 'data:image/png;base64,YOUR_BASE64_STRING_HERE';
            });
        }
        
        // Add this function before createTheRunChart to ensure color uniqueness
        function getEnhancedColors(numTeams) {
            const triColorPalette = [
                // Blue family
                '#0A1F33', '#1B3B63', '#244C7E', '#3970B5', '#559AE0', '#79C4FF', '#B4E0FF',
                // Orange family  
                '#7A3B00', '#9E4F00', '#C76B00', '#E3882E', '#F5A552', '#FFD4A3',
                // Teal family
                '#004D40', '#00695C', '#00897B', '#26A69A', '#4DB6AC', '#B2DFDB'
            ];
            
            // Simple color assignment - just cycle through the array
            const colors = [];
            for (let i = 0; i < numTeams; i++) {
                colors.push(triColorPalette[i % triColorPalette.length]);
            }
            
            return colors;
        }

        function calculateWeeklyRanks(teams, week) {
            // Sort teams by win percentage for weeks 1-13
            return teams.sort((a, b) => {
                const aRecord = a.weekly_records[week - 1];
                const bRecord = b.weekly_records[week - 1];
                const aWinPct = aRecord.wins / week;
                const bWinPct = bRecord.wins / week;
                
                if (Math.abs(aWinPct - bWinPct) < 0.001) {
                    // Tiebreaker: total points through this week
                    const aPoints = a.all_weekly_scores.slice(0, week).reduce((sum, pts) => sum + pts, 0);
                    const bPoints = b.all_weekly_scores.slice(0, week).reduce((sum, pts) => sum + pts, 0);
                    return bPoints - aPoints;
                }
                return bWinPct - aWinPct;
            }).map((team, index) => ({ ...team, rank: index + 1 }));
        }

        function getEliminationWeek(team, playoffResults) {
            const teamStr = `(${team.seed}) ${team.team}`;
            
            // Week 14 eliminations: All wildcard teams that go to "Toilet Bowl"
            // Check if team is in wildcard position (seeds 7-12) and NOT the wildcard winner
            if (team.position === "Toliet Bowl") {  // Note: typo matches your backend
                return 14;
            }
            
            // Week 15 eliminations: Teams that get "Purgatory" or "Toilet Bowl" in next_week
            for (let result of playoffResults.week15.playoff_result) {
                if (result.team === teamStr && result.next_week === 'Purgatory') {
                    return 15;
                }
            }
            for (let result of playoffResults.week15.toilet_result) {
                if (result.team === teamStr && result.next_week === 'Toilet Bowl') {
                    return 15;
                }
            }
            
            // Week 16 eliminations: Teams that get "Purgatory" in next_week
            for (let result of playoffResults.week16.conference) {
                if (result.team === teamStr && result.next_week === 'Purgatory') {
                    return 16;
                }
            }
            for (let result of playoffResults.week16.purgatory) {
                if (result.team === teamStr) {
                    return 16;
                }
            }
            for (let result of playoffResults.week16.toilet) {
                if (result.team === teamStr && result.next_week === 'Toilet Bowl') {
                    return 16;
                }
            }
            
            // Week 17 eliminations: Teams that don't win championship
            for (let result of playoffResults.week17.championship) {
                if (result.team === teamStr && result.final_result !== 'Champion') {
                    return 17;
                }
            }
            
            return null; // Champion - no elimination
        }

        function getFinalPlayoffRank(team, eliminationWeek, champion) {
            if (team.team === champion) return 1;
            if (eliminationWeek === 17) return 2;
            if (eliminationWeek === 16) return 4;
            if (eliminationWeek === 14) return 8;
            return 12;
        }

        // Replace the existing createTrophyPoint function with this image-based version
        function drawTrophyImage(ctx, x, y, size) {
            if (!trophyImage) {
                console.warn('Trophy image not loaded, falling back to emoji');
                // Fallback to trophy emoji
                ctx.save();
                ctx.font = `${size}px serif`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillStyle = '#FFD700';
                ctx.fillText('🏆', x, y);
                ctx.restore();
                return;
            }
            
            ctx.save();
            
            // Calculate image dimensions to maintain aspect ratio
            const aspectRatio = trophyImage.width / trophyImage.height;
            let drawWidth, drawHeight;
            
            if (aspectRatio > 1) {
                // Image is wider than tall
                drawWidth = size;
                drawHeight = size / aspectRatio;
            } else {
                // Image is taller than wide
                drawWidth = size * aspectRatio;
                drawHeight = size;
            }
            
            // Center the image on the point
            const drawX = x - drawWidth / 2;
            const drawY = y - drawHeight / 2;
            
            // Draw the trophy image
            ctx.drawImage(trophyImage, drawX, drawY, drawWidth, drawHeight);
            
            ctx.restore();
        }



        // Add this background gradient plugin
        const backgroundGradientPlugin = {
            id: 'backgroundGradient',
            beforeDraw: function(chart) {
                const ctx = chart.ctx;
                const chartArea = chart.chartArea;
                
                if (!chartArea) return;
                
                // Simple gradient
                const gradient = ctx.createLinearGradient(0, chartArea.top, 0, chartArea.bottom);
                gradient.addColorStop(0, '#0A1F33');    // Deep Midnight Blue
                gradient.addColorStop(0.5, '#004D40');  // Deep Teal
                gradient.addColorStop(1, '#1B3B63');    // Dark Steel Blue
                
                ctx.save();
                ctx.fillStyle = gradient;
                ctx.fillRect(chartArea.left, chartArea.top, 
                            chartArea.right - chartArea.left, 
                            chartArea.bottom - chartArea.top);
                ctx.restore();
            }
        };

        // Register the background plugin
        Chart.register(backgroundGradientPlugin);

        function createTheRunChart(data) {
            const ctx = document.getElementById('theRunChartSubtab').getContext('2d');
            
            // Check if canvas exists
            if (!ctx) {
                console.error('Canvas element not found');
                return;
            }
            
            const teams = data.the_run.teams;
            const playoffResults = data.the_run.playoff_results;
            
            // Find champion with more robust detection
            const championData = playoffResults.week17.championship.find(c => c.final_result === 'Champion');
            const champion = championData ? 
                championData.team.replace(/^\(\d+\)\s*/, '') :  // Remove seed prefix
                teams[0].team;  // Fallback
            
            // Calculate chart data with enhanced colors
            const enhancedColors = getEnhancedColors(teams.length);
            
            const chartData = {
                labels: Array.from({length: 17}, (_, i) => `Week ${i + 1}`),
                datasets: teams.map((team, index) => {
                    const eliminationWeek = getEliminationWeek(team, playoffResults);
                    const isChampion = team.team === champion;
                    
                    // Simple color assignment
                    const teamColor = isChampion ? '#FFD700' : enhancedColors[index];
                    
                    const data = [];
                    
                    // Weeks 1-13: Record-based rankings
                    for (let week = 1; week <= 13; week++) {
                        const rankedTeams = calculateWeeklyRanks(teams, week);
                        const teamRank = rankedTeams.find(t => t.team === team.team)?.rank || 12;
                        data.push(teamRank);
                    }
                    
                    // Weeks 14-17: Handle elimination logic
                    for (let week = 14; week <= 17; week++) {
                        if (eliminationWeek && week > eliminationWeek) {
                            // Team is eliminated - push NULL to stop the line
                            data.push(null);
                        } else {
                            // Team is still active - calculate their playoff rank
                            let playoffRank;
                            
                            if (week === 14) {
                                // Week 14: Use regular season rank for active teams
                                playoffRank = data[12]; // Last regular season rank (week 13)
                            } else {
                                // Weeks 15-17: Calculate based on elimination order
                                if (isChampion && !eliminationWeek) {
                                    playoffRank = 1; // Champion gets rank 1
                                } else if (eliminationWeek === 17) {
                                    playoffRank = 2; // Runner-up
                                } else if (eliminationWeek === 16) {
                                    playoffRank = 4; // Conference Championship losers
                                } else if (eliminationWeek === 15) {
                                    playoffRank = 6; // Semifinal losers
                                } else if (eliminationWeek === 14) {
                                    playoffRank = 8; // Wildcard losers
                                } else {
                                    playoffRank = data[12]; // Maintain last known rank
                                }
                            }
                            data.push(playoffRank);
                        }
                    }
                    
                    return {
                        label: team.team,
                        data: data,
                        borderColor: teamColor,
                        backgroundColor: teamColor,
                        borderWidth: isChampion ? 4 : 2.5,
                        pointRadius: 4,
                        pointHoverRadius: 7,
                        pointBackgroundColor: teamColor,
                        pointBorderColor: '#FFFFFF',
                        pointBorderWidth: 1,
                        tension: 0.1,
                        hidden: false,
                        spanGaps: false
                    };
                })
            };
            
            // Destroy existing chart
            if (theRunChartSubtab) {
                theRunChartSubtab.destroy();
            }
            
            // Add trophy plugin
            const trophyPlugin = {
                id: 'trophyPlugin',
                afterDatasetsDraw: function(chart) {
                    const ctx = chart.ctx;
                    const datasets = chart.data.datasets;
                    
                    datasets.forEach((dataset, datasetIndex) => {
                        const team = teams[datasetIndex];
                        if (team.team === champion) {
                            // Find Week 17 data point (index 16)
                            const week17Index = 16;
                            const dataValue = dataset.data[week17Index];
                            
                            if (dataValue !== null && dataValue === 1) {  // Champion should be at rank 1
                                const meta = chart.getDatasetMeta(datasetIndex);
                                const point = meta.data[week17Index];
                                
                                if (point && !dataset.hidden) {
                                    // Draw trophy image at the Week 17 point (same size as before: 16px)
                                    drawTrophyImage(ctx, point.x, point.y, 16);
                                }
                            }
                        }
                    });
                }
            };

            // Register the plugin and add it to the chart
            Chart.register(trophyPlugin);

            theRunChartSubtab = new Chart(ctx, {
                type: 'line',
                data: chartData,
                options: {
                    responsive: true,
                    interaction: {
                        mode: 'point',        // CRITICAL: Only interact with individual points
                        intersect: true,      // Must be directly over a point to trigger
                        includeInvisible: false  // Don't interact with hidden datasets
                    },
                    plugins: {
                        backgroundGradient: {},  // Enable background gradient
                        trophyPlugin: {},         // Enable trophy plugin
                        title: {
                            display: true,
                            text: 'The Run - Championship Path',
                            font: { size: 18 },
                            color: '#B4E0FF'
                        },
                        legend: {
                            display: true,
                            position: 'right',
                            labels: {
                                color: '#79C4FF',
                                font: { size: 12 },
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            // CRITICAL: Set mode to 'point' to show only hovered dataset
                            mode: 'point',
                            intersect: true,  // Only show tooltip when directly over a point
                            
                            // Filter out null values (eliminated teams)
                            filter: function(tooltipItem) {
                                return tooltipItem.parsed.y !== null;
                            },
                            
                            // Custom tooltip content
                            callbacks: {
                                // Title: Show week
                                title: function(context) {
                                    if (context.length === 0) return '';
                                    const week = context[0].dataIndex + 1;
                                    return `Week ${week}`;
                                },
                                
                                // Label: Show team name and rank
                                label: function(context) {
                                    const teamIndex = context.datasetIndex;
                                    const team = teams[teamIndex];
                                    const rank = context.parsed.y;
                                    const week = context.dataIndex + 1;
                                    
                                    // Get the team's score for this specific week
                                    let weekScore = '';
                                    if (week <= 13) {
                                        // Regular season: show weekly score
                                        const score = team.all_weekly_scores[week - 1];
                                        weekScore = ` - ${score.toFixed(2)} pts`;
                                    } else {
                                        // Playoff weeks: show playoff score
                                        const playoffScores = team.playoff_scores;
                                        if (week === 14 && playoffScores.wk14) {
                                            weekScore = ` - ${playoffScores.wk14.toFixed(2)} pts`;
                                        } else if (week === 15 && playoffScores.wk15) {
                                            weekScore = ` - ${playoffScores.wk15.toFixed(2)} pts`;
                                        } else if (week === 16 && playoffScores.wk16) {
                                            weekScore = ` - ${playoffScores.wk16.toFixed(2)} pts`;
                                        } else if (week === 17 && playoffScores.wk17) {
                                            weekScore = ` - ${playoffScores.wk17.toFixed(2)} pts`;
                                        }
                                    }
                                    
                                    return `#${rank} ${team.team}${weekScore}`;
                                },
                                
                                // After label: Show elimination status or champion status
                                afterLabel: function(context) {
                                    const teamIndex = context.datasetIndex;
                                    const team = teams[teamIndex];
                                    const week = context.dataIndex + 1;
                                    const eliminationWeek = getEliminationWeek(team, playoffResults);
                                    
                                    const messages = [];
                                    
                                    // Add week type context
                                    if (week <= 13) {
                                        const record = team.weekly_records[week - 1];
                                        messages.push(`Record: ${record.wins}-${record.losses}`);
                                    } else {
                                        messages.push('Playoff Week');
                                    }
                                    
                                    // Add elimination/champion status - UPDATED TEXT
                                    if (eliminationWeek === week) {
                                        messages.push('🚫 Eliminated');  // CHANGED: Removed "this week"
                                    } else if (team.team === champion && week === 17) {
                                        messages.push('👑 Champion');
                                    } else if (eliminationWeek && week > eliminationWeek) {
                                        // This shouldn't happen due to null filtering, but just in case
                                        messages.push('Already Eliminated');
                                    }
                                    
                                    return messages;
                                },
                                
                                // Footer: Show additional context
                                footer: function(context) {
                                    if (context.length === 0) return '';
                                    
                                    const week = context[0].dataIndex + 1;
                                    const teamIndex = context[0].datasetIndex;
                                    const team = teams[teamIndex];
                                    const teamStr = `(${team.seed}) ${team.team}`;
                                    
                                    if (week <= 13) {
                                        // Show cumulative points through this week (keep existing logic)
                                        const cumulativePoints = team.all_weekly_scores
                                            .slice(0, week)
                                            .reduce((sum, pts) => sum + pts, 0);
                                        return `Cumulative: ${cumulativePoints.toFixed(2)} pts`;
                                    } else {
                                        // Show "Next Week" column data from playoff results
                                        let nextWeekStatus = '';
                                        
                                        if (week === 14) {
                                            // Week 14: Check initial playoff bracket
                                            if (team.position === 'Bye') {
                                                nextWeekStatus = 'Bye (Automatic Advance)';
                                            } else if (team.position === 'Wildcard Winner') {
                                                nextWeekStatus = 'Advance to Divisional';
                                            } else if (team.position === 'Toliet Bowl') {
                                                nextWeekStatus = 'Toilet Bowl';
                                            } else {
                                                nextWeekStatus = 'Divisional Round';
                                            }
                                        } else if (week === 15) {
                                            // Week 15: Check playoff results
                                            for (let result of playoffResults.week15.bye_result || []) {
                                                if (result.team === teamStr) {
                                                    nextWeekStatus = result.next_week || 'Unknown';
                                                    break;
                                                }
                                            }
                                            if (!nextWeekStatus) {
                                                for (let result of playoffResults.week15.playoff_result || []) {
                                                    if (result.team === teamStr) {
                                                        nextWeekStatus = result.next_week || 'Unknown';
                                                        break;
                                                    }
                                                }
                                            }
                                            if (!nextWeekStatus) {
                                                for (let result of playoffResults.week15.toilet_result || []) {
                                                    if (result.team === teamStr) {
                                                        nextWeekStatus = result.next_week || 'Unknown';
                                                        break;
                                                    }
                                                }
                                            }
                                        } else if (week === 16) {
                                            // Week 16: Check conference championship results
                                            for (let result of playoffResults.week16.conference || []) {
                                                if (result.team === teamStr) {
                                                    nextWeekStatus = result.next_week || 'Unknown';
                                                    break;
                                                }
                                            }
                                            if (!nextWeekStatus) {
                                                for (let result of playoffResults.week16.purgatory || []) {
                                                    if (result.team === teamStr) {
                                                        nextWeekStatus = result.next_week || 'Purgatory';
                                                        break;
                                                    }
                                                }
                                            }
                                            if (!nextWeekStatus) {
                                                for (let result of playoffResults.week16.toilet || []) {
                                                    if (result.team === teamStr) {
                                                        nextWeekStatus = result.next_week || 'Toilet Bowl';
                                                        break;
                                                    }
                                                }
                                            }
                                        } else if (week === 17) {
                                            // Week 17: Check final results
                                            for (let result of playoffResults.week17.championship || []) {
                                                if (result.team === teamStr) {
                                                    nextWeekStatus = result.final_result || 'Unknown';
                                                    break;
                                                }
                                            }
                                            if (!nextWeekStatus) {
                                                for (let result of playoffResults.week17.purgatory || []) {
                                                    if (result.team === teamStr) {
                                                        nextWeekStatus = result.final_result || 'Purgatory';
                                                        break;
                                                    }
                                                }
                                            }
                                            if (!nextWeekStatus) {
                                                for (let result of playoffResults.week17.toilet || []) {
                                                    if (result.team === teamStr) {
                                                        nextWeekStatus = result.final_result || 'Toilet Bowl';
                                                        break;
                                                    }
                                                }
                                            }
                                        }
                                        
                                        return `Next Week: ${nextWeekStatus || 'Unknown'}`;
                                    }
                                }
                            },
                            
                            // Styling
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#fff',
                            bodyColor: '#fff',
                            footerColor: '#ccc',
                            borderColor: '#666',
                            borderWidth: 1,
                            cornerRadius: 6,
                            displayColors: true,  // Show color box next to team name
                            
                            // Position
                            position: 'nearest',
                            
                            // Animation
                            animation: {
                                duration: 200
                            }
                        }
                    },
                    layout: {
                        padding: {
                            top: 20,    // CRITICAL: Add 20px padding to top to prevent circle cutoff
                            bottom: 10,
                            left: 10,
                            right: 10
                        }
                    },
                    scales: {
                        y: {
                            reverse: true,
                            min: 0.5,
                            max: 12.5,
                            title: {
                                display: true,
                                text: 'Rank (1 = Best)',
                                color: '#79C4FF'
                            },
                            ticks: {
                                stepSize: 1,
                                min: 1,
                                max: 12,
                                color: '#B4E0FF',
                                callback: function(value) {
                                    if (Number.isInteger(value) && value >= 1 && value <= 12) {
                                        return value;
                                    }
                                    return '';
                                }
                            },
                            grid: {
                                color: 'rgba(121, 196, 255, 0.1)'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Week',
                                color: '#79C4FF'
                            },
                            ticks: {
                                color: '#B4E0FF'
                            },
                            grid: {
                                color: 'rgba(121, 196, 255, 0.05)'
                            }
                        }
                    },
                    onHover: function(event, activeElements, chart) {
                        // Change cursor to pointer when hovering over a point
                        event.native.target.style.cursor = activeElements.length > 0 ? 'pointer' : 'default';
                    },
                    elements: {
                        point: {
                            radius: function(context) {
                                const team = teams[context.datasetIndex];
                                const week = context.dataIndex + 1;
                                const eliminationWeek = getEliminationWeek(team, playoffResults);
                                
                                // Make elimination point bigger and more visible
                                if (eliminationWeek === week) {
                                    return 8;
                                }
                                return 4;  // INCREASED: From 3 to 4 for better visibility
                            },
                            hoverRadius: function(context) {
                                const team = teams[context.datasetIndex];
                                const week = context.dataIndex + 1;
                                const eliminationWeek = getEliminationWeek(team, playoffResults);
                                
                                // Make hovered points bigger
                                if (eliminationWeek === week) {
                                    return 12;  // INCREASED: Bigger elimination hover
                                }
                                return 8;   // INCREASED: Bigger normal hover
                            },
                            backgroundColor: function(context) {
                                const team = teams[context.datasetIndex];
                                const week = context.dataIndex + 1;
                                const eliminationWeek = getEliminationWeek(team, playoffResults);
                                
                                // Make elimination point bright red with high contrast
                                if (eliminationWeek === week) {
                                    return '#FF0000';
                                }
                                return context.dataset.borderColor;
                            },
                            borderColor: function(context) {
                                const team = teams[context.datasetIndex];
                                const week = context.dataIndex + 1;
                                const eliminationWeek = getEliminationWeek(team, playoffResults);
                                
                                // White borders for all points for better contrast
                                return '#FFFFFF';
                            },
                            borderWidth: function(context) {
                                const team = teams[context.datasetIndex];
                                const week = context.dataIndex + 1;
                                const eliminationWeek = getEliminationWeek(team, playoffResults);
                                
                                // Thicker border for elimination points
                                if (eliminationWeek === week) {
                                    return 3;
                                }
                                return 2;
                            },
                            hoverBackgroundColor: function(context) {
                                const team = teams[context.datasetIndex];
                                const week = context.dataIndex + 1;
                                const eliminationWeek = getEliminationWeek(team, playoffResults);
                                
                                // Bright red for elimination points, lighter version for others
                                if (eliminationWeek === week) {
                                    return '#FF3333';
                                }
                                
                                // Create lighter version of team color for hover
                                const originalColor = context.dataset.borderColor;
                                if (originalColor === '#FFD700') {
                                    return '#FFED4E';  // Lighter gold for champion
                                }
                                
                                // For other colors, add opacity or brightness
                                return originalColor + 'CC';  // Add transparency
                            }
                        },
                        line: {
                            borderWidth: 2.5,  // INCREASED: Default line thickness
                            hoverBorderWidth: function(context) {
                                const team = teams[context.datasetIndex];
                                const isChampion = team.team === champion;
                                return isChampion ? 6 : 4;  // INCREASED: Thicker hover lines
                            }
                        }
                    }
                },
                plugins: [backgroundGradientPlugin, trophyPlugin]  // CRITICAL: Include both plugins
            });
            
            // Add trophy emoji fallback for browsers that don't support custom drawing
            const addTrophyEmoji = function() {
                const championDataset = teams.findIndex(team => team.team === champion);
                if (championDataset >= 0 && theRunChartSubtab.data.datasets[championDataset]) {
                    const dataset = theRunChartSubtab.data.datasets[championDataset];
                    dataset.label = `👑 ${teams[championDataset].team}`;  // Add crown emoji to legend
                }
            };

            // Call this after chart creation
            addTrophyEmoji();

            // Add control buttons
            const showAllBtn = document.getElementById('show-all-teams-subtab');
            const hideAllBtn = document.getElementById('hide-all-teams-subtab');
            const resetFiltersBtn = document.getElementById('reset-filters-subtab');
            const showChampionBtn = document.getElementById('show-champion-only-subtab');
            
            // Wildcard filter: show only teams that were in wildcard in Week 14 (seeds 7–12)
            if (showAllBtn) {
                showAllBtn.onclick = () => {
                    theRunChartSubtab.data.datasets.forEach((dataset, index) => {
                        const team = teams[index];
                        // Backend marks wildcard pool as "Toliet Bowl" position initially (non-winner)
                        // Seeds 7–12 are the wildcard group; include all those teams
                        const isWildcardSeed = team.seed >= 7 && team.seed <= 12;
                        dataset.hidden = !isWildcardSeed;
                    });
                    theRunChartSubtab.update();
                };
            }
            
            // Non-Wildcard filter: show only teams NOT in the wildcard pool (seeds 1–6)
            if (hideAllBtn) {
                hideAllBtn.onclick = () => {
                    theRunChartSubtab.data.datasets.forEach((dataset, index) => {
                        const team = teams[index];
                        const isWildcardSeed = team.seed >= 7 && team.seed <= 12;
                        dataset.hidden = isWildcardSeed; // hide wildcard; show the rest
                    });
                    theRunChartSubtab.update();
                };
            }
            
            // Reset filters: show every team again
            if (resetFiltersBtn) {
                resetFiltersBtn.onclick = () => {
                    theRunChartSubtab.data.datasets.forEach(dataset => dataset.hidden = false);
                    theRunChartSubtab.update();
                };
            }
            
            if (showChampionBtn) {
                showChampionBtn.onclick = () => {
                    theRunChartSubtab.data.datasets.forEach((dataset, index) => {
                        dataset.hidden = teams[index].team !== champion;
                    });
                    theRunChartSubtab.update();
                };
            }
        }

        // Add this debug function to check data
        function debugTheRunData(data) {
            console.log('=== THE RUN DEBUG ===');
            console.log('Data exists:', !!data);
            console.log('the_run exists:', !!data?.the_run);
            console.log('teams exists:', !!data?.the_run?.teams);
            console.log('teams length:', data?.the_run?.teams?.length);
            console.log('playoff_results exists:', !!data?.the_run?.playoff_results);
            console.log('Canvas element exists:', !!document.getElementById('theRunChartSubtab'));
            console.log('Chart.js loaded:', typeof Chart !== 'undefined');
            console.log('===================');
        }

        function updateTheRunTab(data) {
            debugTheRunData(data);
            
            if (data && data.the_run) {
                createTheRunChart(data);
            } else {
                console.error('No the_run data available');
            }
        }

        // Mobile-only: render a compact, readable summary list for The Run
        function renderTheRunMobileSummary(data) {
            const container = document.querySelector('#final-standings .run-container');
            if (!container) return;
            // Clear existing chart if any
            const chartWrap = container.querySelector('.chart-wrapper');
            if (chartWrap) chartWrap.style.display = 'none';

            // Remove any existing mobile summary
            const old = container.querySelector('#the-run-mobile-summary');
            if (old) old.remove();

            const wrapper = document.createElement('div');
            wrapper.id = 'the-run-mobile-summary';
            wrapper.style.marginTop = '8px';
            wrapper.style.background = 'rgba(10,31,51,0.6)';
            wrapper.style.border = '1px solid rgba(121,196,255,0.25)';
            wrapper.style.borderRadius = '10px';
            wrapper.style.padding = '10px';

            const title = document.createElement('div');
            title.textContent = 'Championship Path (Mobile Summary)';
            title.style.color = '#B4E0FF';
            title.style.fontWeight = '700';
            title.style.marginBottom = '8px';
            wrapper.appendChild(title);

            const list = document.createElement('ul');
            list.style.listStyle = 'none';
            list.style.padding = '0';
            list.style.margin = '0';

            const teams = data.the_run.teams || [];
            const playoff = data.the_run.playoff_results || {};

            function statusForTeam(teamName) {
                const seedPrefixRe = /^\(\d+\)\s*/;
                const wk14 = (playoff.week14?.wildcard || []);
                const wk15 = (playoff.week15?.divisional || []);
                const wk16 = (playoff.week16?.conference || []);
                const wk17 = (playoff.week17?.championship || []);
                const findByTeam = (arr) => arr.find(x => (x.team || '').replace(seedPrefixRe,'') === teamName);
                if (findByTeam(wk17)?.final_result === 'Champion') return 'Champion';
                if (findByTeam(wk17)) return 'Runner-up';
                if (findByTeam(wk16)) return 'Conference Round';
                if (findByTeam(wk15)) return 'Divisional Round';
                if (findByTeam(wk14)) return 'Wildcard';
                return 'Season';
            }

            teams
              .slice()
              .sort((a,b) => (a.seed||99) - (b.seed||99))
              .forEach(t => {
                const li = document.createElement('li');
                li.style.display = 'flex';
                li.style.justifyContent = 'space-between';
                li.style.alignItems = 'center';
                li.style.padding = '8px 6px';
                li.style.borderBottom = '1px dashed rgba(121,196,255,0.2)';

                const left = document.createElement('div');
                left.textContent = `#${t.seed} ${t.team}`;
                left.style.color = '#E2F1FF';
                left.style.fontWeight = '600';

                const right = document.createElement('span');
                const st = statusForTeam(t.team);
                right.textContent = st;
                right.style.color = st === 'Champion' ? '#FFD700' : '#79C4FF';
                right.style.fontWeight = st === 'Champion' ? '800' : '600';

                li.appendChild(left);
                li.appendChild(right);
                list.appendChild(li);
            });

            wrapper.appendChild(list);
            container.appendChild(wrapper);
        }

        // Add this temporary debug check to ensure everything works:
        function testSimplifiedLayout() {
            console.log('=== SIMPLIFIED LAYOUT TEST ===');
            console.log('Color family legend removed:', !document.querySelector('.color-family-legend'));
            console.log('Elimination summary removed:', !document.querySelector('#elimination-summary'));
            console.log('Elimination legend still exists:', !!document.querySelector('.elimination-legend'));
            console.log('Chart canvas exists:', !!document.querySelector('#theRunChartSubtab'));
            console.log('===============================');
        }

        // Simple payouts initialization - no complex data processing yet
        function initializePayouts() {
            console.log('=== PAYOUTS DEBUG ===');
            console.log('Payouts tab loaded');
            console.log('latestData exists:', !!window.latestData);
            console.log('DOM ready:', document.readyState);
            console.log('Canvas element exists:', !!document.getElementById('earningsChart'));
            console.log('===================');
            
            // Simple test content
            showBasicPayoutContent();
        }

        function showBasicPayoutContent() {
            // Test with static content first
            const weeklyWinners = document.getElementById('weekly-winners');
            if (weeklyWinners) {
                weeklyWinners.innerHTML = '<div class="test-content">Weekly winners will appear here</div>';
            }
            
            const seasonWinner = document.getElementById('season-winner');
            if (seasonWinner) {
                seasonWinner.innerHTML = '<div class="test-content">Season winner will appear here</div>';
            }
            
            const duelWinners = document.getElementById('duel-winners');
            if (duelWinners) {
                duelWinners.innerHTML = '<div class="test-content">Duel winners will appear here</div>';
            }
            
            const championWinner = document.getElementById('champion-winner');
            if (championWinner) {
                championWinner.innerHTML = '<div class="test-content">Champion will appear here</div>';
            }
            
            console.log('Basic content populated');
        }

        // UPDATE your existing updatePayoutDisplay function
        function updatePayoutDisplay() {
            console.log('Updating payout display for season:', currentSeason);
            
            updateWeeklyWinners();
            updateSeasonWinner();
            updateDuelWinners();
            updateChampionWinner();
        }

        function updateWeeklyWinners() {
            const container = document.getElementById('weekly-winners');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (payoutData.weeklyWinners && Object.keys(payoutData.weeklyWinners).length > 0) {
                Object.values(payoutData.weeklyWinners).forEach(winner => {
                    const winnerDiv = document.createElement('div');
                    winnerDiv.style.cssText = `
                        background: rgba(0, 77, 64, 0.3);
                        border-radius: 6px;
                        padding: 10px 12px;
                        margin-bottom: 8px;
                        border-left: 4px solid #26A69A;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    `;
                    winnerDiv.innerHTML = `
                        <div>
                            <div style="font-weight: 600; color: #B4E0FF; font-size: 14px;">${winner.team}</div>
                            <div style="font-size: 12px; color: #79C4FF; margin-top: 2px;">Week ${winner.week}: ${winner.score.toFixed(2)} pts</div>
                        </div>
                        <div style="font-weight: bold; color: #FFD700; font-size: 14px;">$${winner.payout}</div>
                    `;
                    container.appendChild(winnerDiv);
                });
            } else {
                container.innerHTML = `
                    <div style="color: #79C4FF; padding: 15px; text-align: center; font-style: italic;">
                        ${currentSeason === '2025' ? '2025 season not started' : 'No weekly winners yet'}
                    </div>
                `;
            }
        }

        function updateSeasonWinner() {
            const container = document.getElementById('season-winner');
            if (!container) return;
            
            if (payoutData.seasonHighScore) {
                const winner = payoutData.seasonHighScore;
                container.innerHTML = `
                    <div style="
                        background: rgba(0, 77, 64, 0.3);
                        border-radius: 6px;
                        padding: 10px 12px;
                        border-left: 4px solid #26A69A;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    ">
                        <div>
                            <div style="font-weight: 600; color: #B4E0FF; font-size: 14px;">${winner.team}</div>
                            <div style="font-size: 12px; color: #79C4FF; margin-top: 2px;">Total: ${winner.totalScore.toFixed(2)} pts</div>
                        </div>
                        <div style="font-weight: bold; color: #FFD700; font-size: 14px;">$${winner.payout}</div>
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div style="color: #79C4FF; padding: 15px; text-align: center; font-style: italic;">
                        ${currentSeason === '2025' ? '2025 season not started' : 'Season not complete'}
                    </div>
                `;
            }
        }

        function updateDuelWinners() {
            const container = document.getElementById('duel-winners');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (payoutData.duelOfFates && Object.keys(payoutData.duelOfFates).length > 0) {
                Object.values(payoutData.duelOfFates).forEach(winner => {
                    const winnerDiv = document.createElement('div');
                    winnerDiv.style.cssText = `
                        background: rgba(0, 77, 64, 0.3);
                        border-radius: 6px;
                        padding: 10px 12px;
                        margin-bottom: 8px;
                        border-left: 4px solid #26A69A;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    `;
                    winnerDiv.innerHTML = `
                        <div>
                            <div style="font-weight: 600; color: #B4E0FF; font-size: 14px;">${winner.team}</div>
                            <div style="font-size: 12px; color: #79C4FF; margin-top: 2px;">${winner.category}</div>
                        </div>
                        <div style="font-weight: bold; color: #FFD700; font-size: 14px;">$${winner.payout}</div>
                    `;
                    container.appendChild(winnerDiv);
                });
            } else {
                container.innerHTML = `
                    <div style="color: #79C4FF; padding: 15px; text-align: center; font-style: italic;">
                        ${currentSeason === '2025' ? '2025 season not started' : 'Duel of the Fates not complete'}
                    </div>
                `;
            }
        }

        function updateChampionWinner() {
            const container = document.getElementById('champion-winner');
            if (!container) return;
            
            if (payoutData.champion) {
                const winner = payoutData.champion;
                container.innerHTML = `
                    <div style="
                        background: rgba(0, 77, 64, 0.3);
                        border-radius: 6px;
                        padding: 10px 12px;
                        border-left: 4px solid #26A69A;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    ">
                        <div>
                            <div style="font-weight: 600; color: #B4E0FF; font-size: 14px;">${winner.team}</div>
                            <div style="font-size: 12px; color: #79C4FF; margin-top: 2px;">Shake Weight Champion</div>
                        </div>
                        <div style="font-weight: bold; color: #FFD700; font-size: 14px;">$${winner.payout}</div>
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div style="color: #79C4FF; padding: 15px; text-align: center; font-style: italic;">
                        ${currentSeason === '2025' ? '2025 season not started' : 'Championship not complete'}
                    </div>
                `;
            }
        }

        function updateLastUpdatedTime(customTime = null) {
            const lastUpdatedElement = document.getElementById('last-updated');
            // if (lastUpdatedElement) {
            //     if (customTime === 'N/A - 2025 season not started') {
            //         lastUpdatedElement.textContent = customTime;
            //     } else if (customTime) {
            //         const date = new Date(customTime);
            //         lastUpdatedElement.textContent = `Last Updated: ${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;
            //     } else {
            //         const now = new Date();
            //         lastUpdatedElement.textContent = `Last Updated: ${now.toLocaleDateString()} ${now.toLocaleTimeString()}`;
            //     }
            // }
        }

        // UPDATE createEarningsChart to handle both seasons
        function createEarningsChart() {
            const ctx = document.getElementById('earningsChart');
            if (!ctx) return;
            
            if (currentSeason === '2025' && (!payoutData || Object.keys(payoutData).length === 0)) {
                // Handle empty 2025 state
                showEmpty2025State();
                return;
            }
            
            const earningsData = calculateTeamEarnings();
            
            // Filter teams with $1 or more
            const filteredData = earningsData.filter(team => team.totalEarnings >= 1);
            
            if (earningsChart) {
                earningsChart.destroy();
            }
            
            if (filteredData.length === 0) {
                // No earnings data available
                const ctxContext = ctx.getContext('2d');
                ctxContext.clearRect(0, 0, ctx.width, ctx.height);
                ctxContext.fillStyle = '#79C4FF';
                ctxContext.font = '16px Arial';
                ctxContext.textAlign = 'center';
                ctxContext.fillText('No earnings data available', ctx.width / 2, ctx.height / 2);
                return;
            }
            
            earningsChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: filteredData.map(team => team.teamName),
                    datasets: [{
                        label: 'Total Earnings',
                        data: filteredData.map(team => team.totalEarnings),
                        backgroundColor: filteredData.map((_, index) => {
                            const colors = ['#FFD700', '#559AE0', '#26A69A', '#E3882E', '#B4E0FF', '#F5A552', '#79C4FF', '#C76B00', '#4DB6AC', '#9E4F00'];
                            return colors[index % colors.length];
                        }),
                        borderColor: '#FFFFFF',
                        borderWidth: 2,
                        borderRadius: 6,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: {
                            display: true,
                            text: `${currentSeason} Team Earnings (Click bars for details)`,
                            color: '#B4E0FF',
                            font: { size: 16, weight: 'bold' }
                        },
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `$${context.parsed.y.toFixed(2)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                color: '#79C4FF',
                                font: { size: 12 }
                            },
                            grid: {
                                color: 'rgba(121, 196, 255, 0.1)'
                            }
                        },
                        y: {
                            beginAtZero: true,
                            ticks: {
                                color: '#79C4FF',
                                font: { size: 12 },
                                callback: function(value) {
                                    return '$' + value;
                                }
                            },
                            grid: {
                                color: 'rgba(121, 196, 255, 0.1)'
                            }
                        }
                    },
                    onClick: function(event, elements) {
                        if (elements.length > 0) {
                            const index = elements[0].index;
                            const teamData = filteredData[index];
                            showEarningsModal(teamData);
                        }
                    },
                    onHover: function(event, elements) {
                        event.native.target.style.cursor = elements.length > 0 ? 'pointer' : 'default';
                    }
                }
            });
        }

        function calculateTeamEarnings() {
            const teamEarnings = {};
            
            // Get team list based on current season
            let teamList = [];
            if (currentSeason === '2024') {
                // Use demo team names
                teamList = [
                    "Sponsored by Copper Fit", "Scarecrow Boat", "The Microplastic Miracles", 
                    "Sam's Lobos", "MallCop", "Waddle House", "Bud Olsons Mustache", 
                    "Nabers-Hood Watch", "Bishop Sycamore", "Hot Chubb Time Machine"
                ];
            } else {
                // Use live data team names
                if (window.latestData && window.latestData.the_run && window.latestData.the_run.teams) {
                    teamList = window.latestData.the_run.teams.map(team => team.team);
                }
            }
            
            // Initialize all teams
            teamList.forEach(teamName => {
                teamEarnings[teamName] = {
                    teamName: teamName,
                    totalEarnings: 0,
                    breakdown: []
                };
            });
            
            // Add weekly winnings
            if (payoutData.weeklyWinners) {
                Object.values(payoutData.weeklyWinners).forEach(winner => {
                    if (teamEarnings[winner.team]) {
                        teamEarnings[winner.team].totalEarnings += winner.payout;
                        teamEarnings[winner.team].breakdown.push({
                            category: `Week ${winner.week} High Score`,
                            amount: winner.payout,
                            details: `${winner.score.toFixed(2)} pts`
                        });
                    }
                });
            }
            
            // Add season high score
            if (payoutData.seasonHighScore) {
                const winner = payoutData.seasonHighScore;
                if (teamEarnings[winner.team]) {
                    teamEarnings[winner.team].totalEarnings += winner.payout;
                    teamEarnings[winner.team].breakdown.push({
                        category: 'Season High Score (Weeks 1-13)',
                        amount: winner.payout,
                        details: `${winner.totalScore.toFixed(2)} pts total`
                    });
                }
            }
            
            // Add Duel of the Fates
            if (payoutData.duelOfFates) {
                Object.values(payoutData.duelOfFates).forEach(winner => {
                    if (teamEarnings[winner.team]) {
                        teamEarnings[winner.team].totalEarnings += winner.payout;
                        teamEarnings[winner.team].breakdown.push({
                            category: 'Duel of the Fates',
                            amount: winner.payout,
                            details: winner.category
                        });
                    }
                });
            }
            
            // Add championship
            if (payoutData.champion) {
                const winner = payoutData.champion;
                if (teamEarnings[winner.team]) {
                    teamEarnings[winner.team].totalEarnings += winner.payout;
                    teamEarnings[winner.team].breakdown.push({
                        category: 'Shake Weight Champion',
                        amount: winner.payout,
                        details: 'Season champion'
                    });
                }
            }
            
            return Object.values(teamEarnings);
        }

        // UPDATE initializePayouts to start with 2024 demo data
        function initializePayouts() {
            console.log('Initializing payouts system...');
            
            // Start with 2024 demo data by default
            currentSeason = '2024';
            
            // Ensure toggle buttons are set correctly
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const season2024Btn = document.getElementById('season-2024');
            if (season2024Btn) {
                season2024Btn.classList.add('active');
            }
            
            // Load demo data
            loadDemo2024Data();
            
            console.log('Payouts initialized with 2024 demo data');
        }

        // ADD modal functionality
        function showEarningsModal(teamData) {
            const modal = document.getElementById('earningsModal');
            const teamName = document.getElementById('modalTeamName');
            const totalEarnings = document.getElementById('modalTotalEarnings');
            const breakdown = document.getElementById('modalEarningsBreakdown');
            
            teamName.textContent = `${teamData.teamName} - ${currentSeason} Earnings`;
            totalEarnings.textContent = `$${teamData.totalEarnings.toFixed(2)}`;
            
            breakdown.innerHTML = '';
            if (teamData.breakdown.length > 0) {
                teamData.breakdown.forEach(item => {
                    const breakdownDiv = document.createElement('div');
                    breakdownDiv.style.cssText = `
                        background: rgba(27, 59, 99, 0.4);
                        border-radius: 6px;
                        padding: 12px;
                        margin-bottom: 10px;
                        border-left: 4px solid #26A69A;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    `;
                    breakdownDiv.innerHTML = `
                        <div>
                            <div style="color: #B4E0FF; font-weight: 500; font-size: 14px;">${item.category}</div>
                            <div style="font-size: 12px; color: #79C4FF; margin-top: 2px;">${item.details}</div>
                        </div>
                        <div style="color: #FFD700; font-weight: 600; font-size: 14px;">$${item.amount}</div>
                    `;
                    breakdown.appendChild(breakdownDiv);
                });
            } else {
                breakdown.innerHTML = `
                    <div style="text-align: center; color: #79C4FF; padding: 20px;">
                        No earnings in ${currentSeason} season
                    </div>
                `;
            }
            
            modal.style.display = 'block';
        }

        function closeEarningsModal() {
            document.getElementById('earningsModal').style.display = 'none';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('earningsModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        // Ensure the close button always works, even when charts have overlayed canvases
        document.addEventListener('click', function(e) {
            const closeBtn = document.getElementById('earningsModalClose');
            if (closeBtn && (e.target === closeBtn || closeBtn.contains(e.target))) {
                e.stopPropagation();
                closeEarningsModal();
            }
        }, true);

        // ADD season summary functionality
        function displaySeasonSummary() {
            if (currentSeason === '2024') {
                const totalPayout = calculateTotalPayout();
                const winners = countUniqueWinners();
                
                // Add summary to the payouts container
                const summaryDiv = document.createElement('div');
                summaryDiv.id = 'season-summary';
                summaryDiv.style.cssText = `
                    background: rgba(255, 215, 0, 0.1);
                    border-radius: 8px;
                    padding: 15px;
                    margin: 15px 0;
                    border: 1px solid rgba(255, 215, 0, 0.3);
                    text-align: center;
                `;
                summaryDiv.innerHTML = `
                    <div style="color: #FFD700; font-weight: bold; font-size: 16px; margin-bottom: 10px;">
                        📊 2024 Season Summary
                    </div>
                    <div style="display: flex; justify-content: space-around; flex-wrap: wrap; gap: 15px;">
                        <div style="color: #B4E0FF;">
                            <div style="font-size: 24px; font-weight: bold; color: #FFD700;">$${totalPayout}</div>
                            <div style="font-size: 12px;">Total Paid Out</div>
                        </div>
                        <div style="color: #B4E0FF;">
                            <div style="font-size: 24px; font-weight: bold; color: #26A69A;">${winners}</div>
                            <div style="font-size: 12px;">Teams Won Money</div>
                        </div>
                        <div style="color: #B4E0FF;">
                            <div style="font-size: 24px; font-weight: bold; color: #559AE0;">13</div>
                            <div style="font-size: 12px;">Weeks Completed</div>
                        </div>
                    </div>
                `;
                
                // Insert after the season toggle
                const toggleContainer = document.querySelector('.season-toggle-container');
                if (toggleContainer && !document.getElementById('season-summary')) {
                    toggleContainer.after(summaryDiv);
                }
            } else {
                // Remove summary for 2025
                const existingSummary = document.getElementById('season-summary');
                if (existingSummary) {
                    existingSummary.remove();
                }
            }
        }

        function calculateTotalPayout() {
            let total = 0;
            
            // Weekly winners: 13 weeks × $25
            total += Object.keys(payoutData.weeklyWinners || {}).length * 25;
            
            // Season high score
            if (payoutData.seasonHighScore) total += payoutData.seasonHighScore.payout;
            
            // Duel of the Fates
            if (payoutData.duelOfFates) {
                Object.values(payoutData.duelOfFates).forEach(winner => {
                    total += winner.payout;
                });
            }
            
            // Champion
            if (payoutData.champion) total += payoutData.champion.payout;
            
            return total;
        }

        function countUniqueWinners() {
            const winners = new Set();
            
            // Add weekly winners
            if (payoutData.weeklyWinners) {
                Object.values(payoutData.weeklyWinners).forEach(winner => {
                    winners.add(winner.team);
                });
            }
            
            // Add season winner
            if (payoutData.seasonHighScore) winners.add(payoutData.seasonHighScore.team);
            
            // Add duel winners
            if (payoutData.duelOfFates) {
                Object.values(payoutData.duelOfFates).forEach(winner => {
                    winners.add(winner.team);
                });
            }
            
            // Add champion
            if (payoutData.champion) winners.add(payoutData.champion.team);
            
            return winners.size;
        }

        // Simple test functions for debugging
        function debugPayoutsSetup() {
            console.log('=== COMPREHENSIVE PAYOUTS DEBUG ===');
            
            // Check if elements exist
            console.log('Payouts tab button exists:', !!document.getElementById('payouts-tab'));
            console.log('Payouts content div exists:', !!document.getElementById('payouts-content'));
            console.log('Weekly winners div exists:', !!document.getElementById('weekly-winners'));
            console.log('Season winner div exists:', !!document.getElementById('season-winner'));
            
            // Check CSS
            const payoutsContent = document.getElementById('payouts-content');
            if (payoutsContent) {
                const styles = window.getComputedStyle(payoutsContent);
                console.log('Payouts content display:', styles.display);
                console.log('Payouts content opacity:', styles.opacity);
                console.log('Payouts content visibility:', styles.visibility);
            }
            
            // Check for JavaScript errors
            console.log('showTab function exists:', typeof showTab === 'function');
            console.log('initializePayouts function exists:', typeof initializePayouts === 'function');
            
            // Test tab switching
            console.log('Testing tab switch...');
            try {
                showTab('payouts');
                console.log('Tab switch successful');
            } catch (error) {
                console.error('Tab switch failed:', error);
            }
            
            console.log('===================================');
        }

        function checkForConflicts() {
            console.log('=== CONFLICT CHECK ===');
            
            // Check for multiple showTab functions
            if (window.showTab) {
                console.log('showTab function found in window');
            }
            
            // Check for CSS conflicts
            const allStyles = document.querySelectorAll('style, link[rel="stylesheet"]');
            console.log('Number of stylesheets:', allStyles.length);
            
            // Check for JavaScript errors
            window.addEventListener('error', function(e) {
                console.error('JavaScript error detected:', e.error);
            });
            
            console.log('=====================');
        }

        // Call this immediately
        checkForConflicts();

        // ADD this comprehensive 2024 demo data
        const demo2024Data = {
            weeklyWinners: {
                1: { team: "Sponsored by Copper Fit", score: 156.84, week: 1, payout: 25, date: "2024-09-10" },
                2: { team: "The Microplastic Miracles", score: 178.92, week: 2, payout: 25, date: "2024-09-17" },
                3: { team: "Sam's Lobos", score: 145.67, week: 3, payout: 25, date: "2024-09-24" },
                4: { team: "Scarecrow Boat", score: 163.45, week: 4, payout: 25, date: "2024-10-01" },
                5: { team: "MallCop", score: 189.23, week: 5, payout: 25, date: "2024-10-08" },
                6: { team: "Bud Olsons Mustache", score: 154.78, week: 6, payout: 25, date: "2024-10-15" },
                7: { team: "Waddle House", score: 171.34, week: 7, payout: 25, date: "2024-10-22" },
                8: { team: "The Microplastic Miracles", score: 182.91, week: 8, payout: 25, date: "2024-10-29" },
                9: { team: "Sponsored by Copper Fit", score: 167.56, week: 9, payout: 25, date: "2024-11-05" },
                10: { team: "Nabers-Hood Watch", score: 159.84, week: 10, payout: 25, date: "2024-11-12" },
                11: { team: "Sam's Lobos", score: 174.62, week: 11, payout: 25, date: "2024-11-19" },
                12: { team: "Bishop Sycamore", score: 161.45, week: 12, payout: 25, date: "2024-11-26" },
                13: { team: "The Microplastic Miracles", score: 183.78, week: 13, payout: 25, date: "2024-12-03" }
            },
            seasonHighScore: {
                team: "The Microplastic Miracles",
                totalScore: 2147.83,
                payout: 75,
                date: "2024-12-03"
            },
            duelOfFates: {
                "Sponsored by Copper Fit": {
                    team: "Sponsored by Copper Fit",
                    payout: 60,
                    category: "Duel of the Fates Winner",
                    date: "2024-12-17"
                },
                "Scarecrow Boat": {
                    team: "Scarecrow Boat",
                    payout: 40,
                    category: "Duel of the Fates Runner-up",
                    date: "2024-12-17"
                }
            },
            champion: {
                team: "The Microplastic Miracles",
                payout: 700,
                date: "2024-12-31"
            },
            lastUpdated: "2024-12-31T23:59:59"
        };

        // Current season state
        let currentSeason = '2024';  // Start with 2024 demo data
        let payoutData = {};
        let earningsChart = null;

        // ADD this season switching function
        function switchSeason(season) {
            console.log('Switching to season:', season);
            
            // Show loading state
            showSeasonSwitchLoading();
            
            currentSeason = season;
            
            // Update toggle buttons with animation
            document.querySelectorAll('.toggle-btn').forEach(btn => {
                btn.classList.remove('active');
                btn.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    btn.style.transform = 'scale(1)';
                }, 150);
            });
            
            const activeBtn = document.getElementById(`season-${season}`);
            if (activeBtn) {
                setTimeout(() => {
                    activeBtn.classList.add('active');
                }, 100);
            }
            
            // Update status text with animation
            const statusElement = document.getElementById('season-status');
            if (statusElement) {
                statusElement.style.opacity = '0';
                setTimeout(() => {
                    if (season === '2024') {
                        statusElement.textContent = 'Showing 2024 demo data - Full season completed';
                        statusElement.style.color = '#26A69A';
                    } else {
                        statusElement.textContent = 'Showing 2025 live data - Season starts September 9, 2025';
                        statusElement.style.color = '#79C4FF';
                    }
                    statusElement.style.opacity = '1';
                }, 200);
            }
            
            // Load data with delay for smooth transition
            setTimeout(() => {
                if (season === '2024') {
                    loadDemo2024Data();
                } else {
                    load2025LiveData();
                }
                hideSeasonSwitchLoading();
            }, 300);
        }

        function loadDemo2024Data() {
            console.log('Loading 2024 demo data...');
            
            // Use the demo data
            payoutData = demo2024Data;
            
            // Update displays
            updatePayoutDisplay();
            createEarningsChart();
            updateLastUpdatedTime('2024-12-31T23:59:59');
            displaySeasonSummary();
            
            console.log('2024 demo data loaded successfully');
        }

        function load2025LiveData() {
            console.log('Loading 2025 live data...');
            
            // Remove summary
            displaySeasonSummary();
            
            // Use live data from your API or show empty state
            if (window.latestData && window.latestData.payouts) {
                payoutData = window.latestData.payouts;
                updatePayoutDisplay();
                createEarningsChart();
                updateLastUpdatedTime();
            } else {
                // Show empty 2025 state
                showEmpty2025State();
            }
            
            console.log('2025 live data loaded');
        }

        function showEmpty2025State() {
            // Clear all sections for 2025
            const containers = ['weekly-winners', 'season-winner', 'duel-winners', 'champion-winner'];
            
            containers.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.innerHTML = `
                        <div style="color: #79C4FF; padding: 15px; text-align: center; font-style: italic;">
                            <div style="font-size: 24px; margin-bottom: 8px;">📅</div>
                            <div>2025 season hasn't started yet</div>
                            <div style="font-size: 12px; margin-top: 4px; opacity: 0.7;">Check back after September 9, 2025</div>
                        </div>
                    `;
                }
            });
            
            // Clear chart
            if (earningsChart) {
                earningsChart.destroy();
                earningsChart = null;
            }
            
            const chartCanvas = document.getElementById('earningsChart');
            if (chartCanvas) {
                const ctx = chartCanvas.getContext('2d');
                ctx.clearRect(0, 0, chartCanvas.width, chartCanvas.height);
                
                // Draw empty state message
                ctx.fillStyle = '#79C4FF';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('2025 Earnings Chart', chartCanvas.width / 2, chartCanvas.height / 2 - 10);
                ctx.font = '12px Arial';
                ctx.fillText('Will populate during 2025 season', chartCanvas.width / 2, chartCanvas.height / 2 + 10);
            }
            
            updateLastUpdatedTime('N/A - 2025 season not started');
        }

        function showSeasonSwitchLoading() {
            const containers = ['weekly-winners', 'season-winner', 'duel-winners', 'champion-winner'];
            containers.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.style.opacity = '0.5';
                    element.innerHTML = `
                        <div style="color: #79C4FF; padding: 15px; text-align: center;">
                            <div style="font-size: 18px; margin-bottom: 8px;">⏳</div>
                            <div>Switching seasons...</div>
                        </div>
                    `;
                }
            });
        }

        function hideSeasonSwitchLoading() {
            const containers = ['weekly-winners', 'season-winner', 'duel-winners', 'champion-winner'];
            containers.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.style.opacity = '1';
                }
            });
        }

        // Add comprehensive error checking
        function debugPayoutsSetup() {
            console.log('=== COMPREHENSIVE PAYOUTS DEBUG ===');
            
            // Check if elements exist
            console.log('Payouts tab button exists:', !!document.getElementById('payouts-tab'));
            console.log('Payouts content div exists:', !!document.getElementById('payouts-content'));
            console.log('Weekly winners div exists:', !!document.getElementById('weekly-winners'));
            console.log('Season winner div exists:', !!document.getElementById('season-winner'));
            
            // Check CSS
            const payoutsContent = document.getElementById('payouts-content');
            if (payoutsContent) {
                const styles = window.getComputedStyle(payoutsContent);
                console.log('Payouts content display:', styles.display);
                console.log('Payouts content opacity:', styles.opacity);
                console.log('Payouts content visibility:', styles.visibility);
            }
            
            // Check for JavaScript errors
            console.log('showTab function exists:', typeof showTab === 'function');
            console.log('initializePayouts function exists:', typeof initializePayouts === 'function');
            
            // Test tab switching
            console.log('Testing tab switch...');
            try {
                // Test with the correct tab ID
                const payoutsButton = document.querySelector('[data-tab="payouts-content"]');
                if (payoutsButton) {
                    payoutsButton.click();
                    console.log('Tab switch successful');
                } else {
                    console.error('Payouts button not found');
                }
            } catch (error) {
                console.error('Tab switch failed:', error);
            }
            
            console.log('===================================');
        }
        // ===== TOURNAMENT VISUALIZATION FUNCTIONS =====

        // Confetti effect (text-based)
        function triggerConfetti(championSlot) {
            setTimeout(() => {
                const confetti = document.createElement('div');
                confetti.innerHTML = '🎉 🏆 🎊 👑 🎉';
                confetti.style.cssText = `
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    font-size: 20px;
                    animation: confettiFall 2s ease-out;
                    pointer-events: none;
                    z-index: 1000;
                `;
                championSlot.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, 2000);
            }, 500);
        }

        // Add confetti animation
        const confettiCSS = `
@keyframes confettiFall {
    0% {
        opacity: 0;
        transform: translate(-50%, -150%) scale(0.5);
    }
    50% {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1.2);
    }
    100% {
        opacity: 0;
        transform: translate(-50%, 50%) scale(0.8);
    }
}
`;

        // Add seed highlighting CSS
        const seedHighlightCSS = `
.seed-highlight {
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.8) !important;
    border-color: #FFD700 !important;
    background: rgba(255, 215, 0, 0.2) !important;
    transform: scale(1.05) !important;
    z-index: 10 !important;
    position: relative !important;
}
`;

        // Close info panel
        function closeInfoPanel() {
            const infoPanel = document.getElementById('info-panel');
            if (infoPanel) {
                infoPanel.style.opacity = '0.5';
                setTimeout(() => {
                    infoPanel.style.opacity = '1';
                }, 300);
            }
        }

        // Utility function for delays
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Initialize tournament visualization
        function initializeTournamentVisualization() {
            console.log('Initializing mixed layout tournament visualization...');
            
            // Add all CSS
            const style = document.createElement('style');
            style.textContent = confettiCSS + seedHighlightCSS;
            document.head.appendChild(style);
            
            // CRITICAL: Setup click system FIRST
            setupTournamentClickSystem();
            
            // Set initial state
            showTournamentStep('overview');
            
            // Populate with current data if available
            if (window.latestData && window.latestData.standings) {
                populateMixedLayoutWithData(window.latestData.standings);
            }
            
            console.log('Mixed layout tournament visualization initialized');
        }

        // Setup tournament click system
        function setupTournamentClickSystem() {
            console.log('Setting up tournament click system...');
            
            // Clear any existing handlers
            tournamentClickHandlers.forEach(handler => {
                document.removeEventListener('click', handler);
            });
            tournamentClickHandlers = [];
            
            // Remove all onclick attributes
            document.querySelectorAll('[onclick]').forEach(element => {
                element.removeAttribute('onclick');
            });
            
            // Setup new click handlers
            setupClickHandlers();
            
            console.log('Tournament click system setup complete');
        }

        // Add function to populate mixed layout with data
        function populateMixedLayoutWithData(standings) {
            standings.forEach((team, index) => {
                const seed = index + 1;
                
                // Update seed slots in Week 13 seeding column
                const seedSlot = document.querySelector(`[data-seed="${seed}"]`);
                if (seedSlot) {
                    const teamElement = seedSlot.querySelector('.seed-team');
                    if (teamElement) {
                        teamElement.textContent = team.team || `Team ${seed}`;
                    }
                }
                
                // Update duel participants (Seeds 1-2)
                if (seed <= 2) {
                    const duelParticipant = document.querySelector(`.duel-participant[data-seed="${seed}"] .participant-name`);
                    if (duelParticipant) {
                        duelParticipant.textContent = team.team || `Seed ${seed} Team`;
                    }
                }
                
                // Update auto playoff participants (Seeds 3-6)
                if (seed >= 3 && seed <= 6) {
                    const autoParticipant = document.querySelector(`.auto-playoff-participant[data-seed="${seed}"] .participant-name`);
                    if (autoParticipant) {
                        autoParticipant.textContent = team.team || `Seed ${seed} Team`;
                    }
                }
                
                // Update wildcard competitors (Seeds 7-12)
                if (seed >= 7 && seed <= 12) {
                    const wildcardCompetitor = document.querySelector(`.wildcard-competitor[data-seed="${seed}"] .competitor-name`);
                    if (wildcardCompetitor) {
                        wildcardCompetitor.textContent = team.team || `Seed ${seed}`;
                    }
                }
            });
            
            console.log('Mixed layout populated with team data');
        }

        // Update tournament steps for the new mixed layout
        const tournamentSteps = {
            overview: {
                title: 'Quantum Gauntlet Tournament Overview',
                highlights: [],
                explanation: 'explanation-overview'
            },
            week14: {
                title: 'Week 14 - Wildcard & Duel Begin',
                highlights: ['wildcard-horizontal-section', 'duel-horizontal-section'],
                explanation: 'explanation-week14'
            },
            week15: {
                title: 'Week 15 - Playoff Battle & Duel Conclusion',
                highlights: ['playoff-horizontal-section', 'duel-horizontal-section'],
                explanation: 'explanation-week15'
            },
            week16: {
                title: 'Week 16 - Conference Championship',
                highlights: ['week16-column', 'conference-championship'],
                explanation: 'explanation-week16'
            },
            week17: {
                title: 'Week 17 - Championship Game',
                highlights: ['week17-column', 'championship-game'],
                explanation: 'explanation-week17'
            }
        };

        // Update the explanation content for the mixed layout
        const explanationContent = {
            'explanation-week14': `
                <h4>Week 14 - Dual Competitions Begin</h4>
                <p><strong>Wildcard Battle:</strong> Seeds 7-12 compete in single elimination. Only the highest scorer advances.</p>
                <p><strong>Duel of the Fates:</strong> Seeds 1-2 begin their two-week head-to-head battle for prize money.</p>
                <p><strong>Auto Playoff:</strong> Seeds 3-6 start accumulating points for combined Week 14+15 scoring.</p>
            `,
            'explanation-week15': `
                <h4>Week 15 - Playoff Battle Intensifies</h4>
                <p><strong>Playoff Battle:</strong> Seeds 3-6 plus Wildcard Winner compete using combined Week 14+15 scores.</p>
                <p><strong>Top 3 Advance:</strong> Highest combined scorers move to Conference Championship.</p>
                <p><strong>Duel Concludes:</strong> Seeds 1-2 complete their two-week battle, both advance regardless of outcome.</p>
            `
        };

        // Update highlight system for horizontal sections
        function highlightElements(elementIds) {
            elementIds.forEach(id => {
                const element = document.getElementById(id) || document.querySelector(`.${id}`);
                if (element) {
                    element.classList.add('highlight-step');
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            });
        }

        // Add comprehensive debugging function for mixed layout
        function debugMixedTournament() {
            console.log('=== MIXED LAYOUT TOURNAMENT DEBUG ===');
            
            // Check all sections exist
            console.log('Week 13 column exists:', !!document.getElementById('week13-column'));
            console.log('Wildcard section exists:', !!document.getElementById('wildcard-horizontal-section'));
            console.log('Duel section exists:', !!document.getElementById('duel-horizontal-section'));
            console.log('Playoff section exists:', !!document.getElementById('playoff-horizontal-section'));
            console.log('Week 16 column exists:', !!document.getElementById('week16-column'));
            console.log('Week 17 column exists:', !!document.getElementById('week17-column'));
            
            // Check clickable elements in each section
            const wildcardElements = document.querySelectorAll('.wildcard-competitor');
            const duelElements = document.querySelectorAll('.duel-participant');
            const playoffElements = document.querySelectorAll('.auto-playoff-participant');
            const conferenceElements = document.querySelectorAll('.conference-team');
            const championshipElements = document.querySelectorAll('.championship-team');
            
            console.log('Wildcard competitors:', wildcardElements.length);
            console.log('Duel participants:', duelElements.length);
            console.log('Playoff participants:', playoffElements.length);
            console.log('Conference teams:', conferenceElements.length);
            console.log('Championship teams:', championshipElements.length);
            
            // Test click handlers
            console.log('Click handlers registered:', tournamentClickHandlers.length);
            
            // Test layout responsiveness
            const horizontalSections = document.querySelectorAll('.horizontal-tournament-section');
            const verticalColumns = document.querySelectorAll('.tournament-column');
            
            console.log('Horizontal sections:', horizontalSections.length);
            console.log('Vertical columns:', verticalColumns.length);
            
            console.log('=======================================');
        }

        // Global variables for tournament state
        let tournamentClickHandlers = [];
        let currentHighlightedElement = null;

        // Setup comprehensive event handling system
        function setupTournamentEventListeners() {
            console.log('Setting up tournament event listeners...');
            
            // Remove existing event listeners to prevent duplicates
            tournamentClickHandlers.forEach(handler => {
                document.removeEventListener('click', handler);
            });
            tournamentClickHandlers = [];
            
            // Remove all onclick attributes
            document.querySelectorAll('[onclick]').forEach(element => {
                element.removeAttribute('onclick');
            });
            
            // Setup new click handlers
            setupClickHandlers();
            
            console.log('Tournament event listeners established');
        }

        // Setup all click handlers with proper event delegation
        function setupClickHandlers() {
            // Main click handler
            const mainClickHandler = function(event) {
                handleTournamentClick(event);
            };
            
            document.addEventListener('click', mainClickHandler);
            tournamentClickHandlers.push(mainClickHandler);
            
            console.log('Click handlers registered');
        }

        // Master click handling function
        function handleTournamentClick(event) {
            const target = event.target;
            const clickedElement = target.closest('[data-seed], .conference-team, .championship-team, .wildcard-competitor, .duel-participant, .auto-playoff-participant, .wildcard-winner-participant');
            
            if (!clickedElement) return;
            
            event.preventDefault();
            event.stopPropagation();
            
            // Clear previous highlights
            clearAllHighlights();
            
            // Highlight clicked element
            clickedElement.classList.add('clicked');
            currentHighlightedElement = clickedElement;
            
            // Determine what was clicked and show appropriate details
            if (clickedElement.hasAttribute('data-seed')) {
                const seed = parseInt(clickedElement.getAttribute('data-seed'));
                showSeedDetails(seed);
            } else if (clickedElement.classList.contains('wildcard-competitor')) {
                showWildcardCompetitorDetails(clickedElement);
            } else if (clickedElement.classList.contains('duel-participant')) {
                showDuelParticipantDetails(clickedElement);
            } else if (clickedElement.classList.contains('auto-playoff-participant')) {
                showAutoPlayoffDetails(clickedElement);
            } else if (clickedElement.classList.contains('wildcard-winner-participant')) {
                showWildcardWinnerDetails();
            } else if (clickedElement.classList.contains('conference-team')) {
                showConferenceTeamDetails(clickedElement);
            } else if (clickedElement.classList.contains('championship-team')) {
                showChampionshipTeamDetails(clickedElement);
            }
            
            console.log('Tournament element clicked:', clickedElement);
        }

        // ADD new detail functions for conference and championship teams
        function showConferenceTeamDetails(element) {
            const teamName = element.querySelector('.team-name') ? element.querySelector('.team-name').textContent : 'Unknown Team';
            const teamSeed = element.querySelector('.team-seed') ? element.querySelector('.team-seed').textContent : '#?';
            const teamStatus = element.querySelector('.team-status') ? element.querySelector('.team-status').textContent : 'Unknown Status';
            
            updateInfoPanel(`Conference Championship - ${teamSeed}`, null);
            
            const infoContent = document.getElementById('info-content');
            if (infoContent) {
                infoContent.innerHTML = `
                    <h4>🏆 Conference Championship Participant</h4>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #FFD700;">Team:</strong> ${teamName} (${teamSeed})
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #559AE0;">Qualification Path:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">${teamStatus}</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #26A69A;">Competition Format:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Final 5 teams compete using Week 16 scores only</p>
                        <p style="margin: 5px 0; font-size: 13px;">Top 3 scorers advance to Championship Game</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #E3882E;">Stakes:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Season ends for bottom 2 teams</p>
                        <p style="margin: 5px 0; font-size: 13px;">Advancing teams compete for $700 championship prize</p>
                    </div>
                    <div style="background: rgba(255, 215, 0, 0.1); padding: 8px; border-radius: 4px; border-left: 3px solid #FFD700;">
                        <strong style="color: #FFD700; font-size: 12px;">Final Push:</strong>
                        <p style="margin: 3px 0; font-size: 11px; color: #B4E0FF;">This is the last chance - one week determines championship contention</p>
                    </div>
                `;
            }
            
            console.log('Showing conference team details:', teamName);
        }

        function showChampionshipTeamDetails(element) {
            const finalistName = element.querySelector('.finalist-name') ? element.querySelector('.finalist-name').textContent : 'Unknown Finalist';
            const finalistSeed = element.querySelector('.finalist-seed') ? element.querySelector('.finalist-seed').textContent : '#?';
            
            updateInfoPanel(`Championship Finalist - ${finalistSeed}`, null);
            
            const infoContent = document.getElementById('info-content');
            if (infoContent) {
                infoContent.innerHTML = `
                    <h4>👑 Championship Game Finalist</h4>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #FFD700;">Finalist:</strong> ${finalistName} (${finalistSeed})
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #559AE0;">Achievement:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Survived the entire Quantum Gauntlet to reach the final 3</p>
                        <p style="margin: 5px 0; font-size: 13px;">Competed through multiple elimination rounds to earn this spot</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #26A69A;">Championship Format:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">3-team championship game using Week 17 scores only</p>
                        <p style="margin: 5px 0; font-size: 13px;">Highest single-week score wins the championship</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #E3882E;">Prize at Stake:</strong>
                        <p style="margin: 5px 0; font-size: 13px;"><strong>Champion:</strong> $700 + Shake Weight Trophy + Bragging Rights</p>
                        <p style="margin: 5px 0; font-size: 13px;"><strong>Runners-up:</strong> Honor and glory for making the finals</p>
                    </div>
                    <div style="background: rgba(255, 215, 0, 0.1); padding: 8px; border-radius: 4px; border-left: 3px solid #FFD700;">
                        <strong style="color: #FFD700; font-size: 12px;">Championship Moment:</strong>
                        <p style="margin: 3px 0; font-size: 11px; color: #B4E0FF;">One week, one game, one champion - everything comes down to this final performance</p>
                    </div>
                `;
            }
            
            console.log('Showing championship finalist details:', finalistName);
        }

        // Clear all visual highlights
        function clearAllHighlights() {
            document.querySelectorAll('.clicked, .seed-highlight').forEach(element => {
                element.classList.remove('clicked', 'seed-highlight');
            });
            currentHighlightedElement = null;
        }

        // Show duel participant details
        function showDuelParticipantDetails(element) {
            const seed = element.getAttribute('data-seed') || (element.querySelector('.participant-seed') ? element.querySelector('.participant-seed').textContent : '#?');
            const teamName = element.querySelector('.participant-name') ? element.querySelector('.participant-name').textContent : 'Unknown Team';
            
            updateInfoPanel(`Duel of the Fates - ${seed}`, null);
            
            const infoContent = document.getElementById('info-content');
            if (infoContent) {
                infoContent.innerHTML = `
                    <h4>⚔️ Duel of the Fates Participant</h4>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #FFD700;">Team:</strong> ${teamName} (${seed})
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #559AE0;">Competition Format:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Two-week head-to-head battle between the top 2 seeds</p>
                        <p style="margin: 5px 0; font-size: 13px;">Week 14 Score + Week 15 Score = Total Duel Score</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #26A69A;">Prize Distribution ($100 Total):</strong>
                        <ul style="margin: 5px 0; padding-left: 20px; font-size: 12px; line-height: 1.4;">
                            <li>Margin ≤ 7.5 pts: Winner $60, Loser $40</li>
                            <li>Margin ≤ 15 pts: Winner $70, Loser $30</li>
                            <li>Margin ≤ 23.5 pts: Winner $80, Loser $20</li>
                            <li>Margin ≤ 30 pts: Winner $90, Loser $10</li>
                            <li>Margin > 30 pts: Winner $100, Loser $0</li>
                        </ul>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #79C4FF;">Advancement:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Both participants automatically advance to Week 16 Conference Championship regardless of Duel outcome</p>
                    </div>
                    <div style="background: rgba(255, 215, 0, 0.1); padding: 8px; border-radius: 4px; border-left: 3px solid #FFD700;">
                        <strong style="color: #FFD700; font-size: 12px;">Strategy Note:</strong>
                        <p style="margin: 3px 0; font-size: 11px; color: #B4E0FF;">Focus on consistency across both weeks rather than a single explosive performance</p>
                    </div>
                `;
            }
            
            console.log('Showing duel participant details:', teamName);
        }

        // Show auto playoff details
        function showAutoPlayoffDetails(element) {
            const seed = element.getAttribute('data-seed') || (element.querySelector('.participant-seed') ? element.querySelector('.participant-seed').textContent : '#?');
            const teamName = element.querySelector('.participant-name') ? element.querySelector('.participant-name').textContent : 'Unknown Team';
            
            updateInfoPanel(`Auto Playoff - ${seed}`, null);
            
            const infoContent = document.getElementById('info-content');
            if (infoContent) {
                infoContent.innerHTML = `
                    <h4>⚔️ Auto Playoff Participant</h4>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #FFD700;">Team:</strong> ${teamName} (${seed})
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #559AE0;">Competition Format:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Compete against Seeds 3-6 + Wildcard Winner using combined Week 14 + Week 15 scores</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #26A69A;">Advancement Criteria:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Top 3 combined scores advance to Week 16 Conference Championship</p>
                        <p style="margin: 5px 0; font-size: 13px;">Bottom 2 teams are eliminated from playoff contention</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #E3882E;">Key Challenge:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Must maintain high performance across two consecutive weeks while competing against the unpredictable Wildcard Winner</p>
                    </div>
                    <div style="background: rgba(85, 154, 224, 0.1); padding: 8px; border-radius: 4px; border-left: 3px solid #559AE0;">
                        <strong style="color: #559AE0; font-size: 12px;">Strategy Note:</strong>
                        <p style="margin: 3px 0; font-size: 11px; color: #B4E0FF;">Guaranteed playoff spot provides security, but consistent scoring across both weeks is crucial for advancement</p>
                    </div>
                `;
            }
            
            console.log('Showing auto playoff details:', teamName);
        }

        // Show wildcard competitor details
        function showWildcardCompetitorDetails(element) {
            const seed = element.getAttribute('data-seed') || (element.querySelector('.competitor-seed') ? element.querySelector('.competitor-seed').textContent : '#?');
            const teamName = element.querySelector('.competitor-name') ? element.querySelector('.competitor-name').textContent : 'Unknown Team';
            
            updateInfoPanel(`Wildcard Battle - ${seed}`, null);
            
            const infoContent = document.getElementById('info-content');
            if (infoContent) {
                infoContent.innerHTML = `
                    <h4>🎰 Wildcard Battle Participant</h4>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #FFD700;">Team:</strong> ${teamName} (${seed})
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #559AE0;">Battle Format:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Single elimination - Week 14 scores only</p>
                        <p style="margin: 5px 0; font-size: 13px;">Highest score among Seeds 7-12 advances</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #26A69A;">Winner Advancement:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Joins the Auto Playoff teams (Seeds 3-6) in the combined Week 14+15 scoring</p>
                        <p style="margin: 5px 0; font-size: 13px;">Competes for top 3 spots to reach Conference Championship</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #E3882E;">Elimination Risk:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">5 out of 6 wildcard teams are eliminated to the Toilet Bowl after Week 14</p>
                    </div>
                    <div style="background: rgba(227, 136, 46, 0.1); padding: 8px; border-radius: 4px; border-left: 3px solid #E3882E;">
                        <strong style="color: #E3882E; font-size: 12px;">Strategy Note:</strong>
                        <p style="margin: 3px 0; font-size: 11px; color: #B4E0FF;">High-risk, high-reward scenario - one explosive week can lead to championship contention</p>
                    </div>
                `;
            }
            
            console.log('Showing wildcard competitor details:', teamName);
        }

        // Show wildcard winner details
        function showWildcardWinnerDetails() {
            const winnerName = document.getElementById('wildcard-winner-name') ? document.getElementById('wildcard-winner-name').textContent : 'Wildcard Winner';
            const winnerSeed = document.getElementById('wildcard-winner-seed') ? document.getElementById('wildcard-winner-seed').textContent : '#?';
            
            updateInfoPanel('Wildcard Winner', null);
            
            const infoContent = document.getElementById('info-content');
            if (infoContent) {
                infoContent.innerHTML = `
                    <h4>🏆 Wildcard Winner</h4>
                    <div style="margin-bottom: 15px;">
                        <strong style="color: #FFD700;">Winner:</strong> ${winnerName} (${winnerSeed})
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #559AE0;">Achievement:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Scored the highest among Seeds 7-12 in Week 14 to earn this spot</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #26A69A;">Current Status:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Now competing with Seeds 3-6 using combined Week 14 + Week 15 scoring</p>
                        <p style="margin: 5px 0; font-size: 13px;">Must finish in top 3 of this group to advance to Conference Championship</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #79C4FF;">Unique Position:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">Already has Week 14 score "banked" from wildcard victory</p>
                        <p style="margin: 5px 0; font-size: 13px;">Needs strong Week 15 performance to compete with auto-playoff teams' combined totals</p>
                    </div>
                    <div style="background: rgba(38, 166, 154, 0.1); padding: 8px; border-radius: 4px; border-left: 3px solid #26A69A;">
                        <strong style="color: #26A69A; font-size: 12px;">Cinderella Story:</strong>
                        <p style="margin: 3px 0; font-size: 11px; color: #B4E0FF;">This team overcame 5 other wildcards and now has a real shot at the championship</p>
                    </div>
                `;
            }
            
            console.log('Showing wildcard winner details');
        }

        // Debug function to test clicks
        function debugTournamentClicks() {
            console.log('=== TOURNAMENT CLICK DEBUG ===');
            
            // Test seed slots
            const seedSlots = document.querySelectorAll('.seed-slot');
            console.log('Seed slots found:', seedSlots.length);
            
            // Test duel participants
            const duelParticipants = document.querySelectorAll('.duel-participant');
            console.log('Duel participants found:', duelParticipants.length);
            
            // Test event listeners
            console.log('Click handler attached:', !!document.onclick);
            
            // Test a manual click
            if (seedSlots.length > 0) {
                console.log('Testing manual click on first seed...');
                seedSlots[0].click();
            }
            
            console.log('=============================');
        }

        // Force refresh function
        function forceRefreshTournament() {
            console.log('Force refreshing tournament...');
            
            // Clear any existing event listeners
            document.querySelectorAll('.seed-slot').forEach(slot => {
                slot.removeAttribute('onclick');
            });
            
            // Re-setup everything
            setTimeout(() => {
                setupTournamentEventListeners();
                initializeTournamentVisualization();
            }, 100);
        }

        // Populate with current standings data
        function populateWithCurrentData(standings) {
            standings.forEach((team, index) => {
                const seed = index + 1;
                const seedSlot = document.querySelector(`[data-seed="${seed}"]`);
                if (seedSlot) {
                    const teamElement = seedSlot.querySelector('.seed-team');
                    if (teamElement) {
                        teamElement.textContent = team.team || `Team ${seed}`;
                    }
                }
                
                // Update other references throughout the bracket
                updateTeamReferences(seed, team.team || `Team ${seed}`);
            });
        }

        // Update team references throughout bracket
        function updateTeamReferences(seed, teamName) {
            // Update various elements that reference this seed
            const references = [
                `#bye${seed}-w14`, `#bye${seed}-w15`,
                `#playoff${seed}-w14`, `#wildcard${seed}-w14`
            ];
            
            references.forEach(ref => {
                const element = document.querySelector(ref);
                if (element) {
                    element.textContent = `${teamName}`;
                }
            });
        }

        // Show tournament step
        function showTournamentStep(step) {
            console.log('Showing tournament step:', step);
            
            // Remove active class from all control buttons
            document.querySelectorAll('.control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active class to current step button
            const activeBtn = document.querySelector(`[onclick="showTournamentStep('${step}')"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            // Hide all sections initially
            document.querySelectorAll('.tournament-column, .horizontal-tournament-section').forEach(section => {
                section.style.opacity = '0.3';
                section.style.filter = 'grayscale(50%)';
            });
            
            // Show relevant sections based on step
            switch(step) {
                case 'overview':
                    // Show all sections
                    document.querySelectorAll('.tournament-column, .horizontal-tournament-section').forEach(section => {
                        section.style.opacity = '1';
                        section.style.filter = 'none';
                    });
                    updateInfoPanel('overview');
                    break;
                    
                case 'week14':
                    // Highlight Week 13 column and Week 14 horizontal sections
                    document.getElementById('week13-column').style.opacity = '1';
                    document.getElementById('week13-column').style.filter = 'none';
                    document.getElementById('wildcard-horizontal-section').style.opacity = '1';
                    document.getElementById('wildcard-horizontal-section').style.filter = 'none';
                    document.getElementById('duel-horizontal-section').style.opacity = '1';
                    document.getElementById('duel-horizontal-section').style.filter = 'none';
                    updateInfoPanel('week14');
                    break;
                    
                case 'week15':
                    // Highlight Week 15 horizontal sections
                    document.getElementById('duel-horizontal-section').style.opacity = '1';
                    document.getElementById('duel-horizontal-section').style.filter = 'none';
                    document.getElementById('playoff-horizontal-section').style.opacity = '1';
                    document.getElementById('playoff-horizontal-section').style.filter = 'none';
                    updateInfoPanel('week15');
                    break;
                    
                case 'week16':
                    // Highlight Week 16 column
                    document.getElementById('week16-column').style.opacity = '1';
                    document.getElementById('week16-column').style.filter = 'none';
                    updateInfoPanel('week16');
                    break;
                    
                case 'week17':
                    // Highlight Week 17 column
                    document.getElementById('week17-column').style.opacity = '1';
                    document.getElementById('week17-column').style.filter = 'none';
                    updateInfoPanel('week17');
                    break;
            }
        }

        // Update info panel content
        function updateInfoPanel(step) {
            const infoTitle = document.getElementById('info-title');
            const infoContent = document.getElementById('info-content');
            
            if (!infoTitle || !infoContent) return;
            
            const explanations = {
                overview: {
                    title: '🏈 Tournament Overview',
                    content: `
                        <h4>🏈 Quantum Gauntlet Overview</h4>
                        <p>The Quantum Gauntlet is a 4-week playoff tournament (Weeks 14-17) that determines the Shake Weight Champion.</p>
                        <ul>
                            <li><strong>Seeds 1-2:</strong> Get first-round byes, automatically advance to Week 16</li>
                            <li><strong>Seeds 3-6:</strong> Compete in Weeks 14+15 combined scoring</li>
                            <li><strong>Seeds 7-12:</strong> Battle in Week 14 wildcard, highest score advances</li>
                            <li><strong>Progressive Elimination:</strong> Field narrows each week until 3 teams remain for championship</li>
                        </ul>
                    `
                },
                week14: {
                    title: '⚔️ Week 14 - Wildcard Round',
                    content: `
                        <h4>⚔️ Week 14 - Wildcard Round</h4>
                        <p>The wildcard round determines which lower seed gets a chance at the championship.</p>
                        <ul>
                            <li><strong>Seeds 1-2:</strong> Bye week, automatically advance</li>
                            <li><strong>Seeds 3-6:</strong> Begin their two-week playoff journey</li>
                            <li><strong>Seeds 7-12:</strong> Only ONE team advances (highest Week 14 score)</li>
                            <li><strong>Toilet Bowl:</strong> 5 wildcard losers move to consolation bracket</li>
                        </ul>
                    `
                },
                week15: {
                    title: '🏟️ Week 15 - Divisional Round',
                    content: `
                        <h4>🏟️ Week 15 - Divisional Round</h4>
                        <p>Seeds 3-6 and the wildcard winner compete using combined Week 14+15 scores.</p>
                        <ul>
                            <li><strong>Combined Scoring:</strong> Week 14 + Week 15 total points</li>
                            <li><strong>Top 3 Advance:</strong> Highest combined scores move to conference championship</li>
                            <li><strong>Bottom 2 Eliminated:</strong> Join the consolation bracket</li>
                            <li><strong>Byes Continue:</strong> Seeds 1-2 still waiting</li>
                        </ul>
                    `
                },
                week16: {
                    title: '🏆 Week 16 - Conference Championship',
                    content: `
                        <h4>🏆 Week 16 - Conference Championship</h4>
                        <p>The final 5 teams (2 byes + 3 qualifiers) compete for championship spots.</p>
                        <ul>
                            <li><strong>5 Teams Total:</strong> Seeds 1-2 + 3 divisional winners</li>
                            <li><strong>Week 16 Scoring:</strong> Fresh start, single week determines advancement</li>
                            <li><strong>Top 3 Advance:</strong> Championship game participants</li>
                            <li><strong>Bottom 2 Eliminated:</strong> Season ends</li>
                        </ul>
                    `
                },
                week17: {
                    title: '👑 Week 17 - Championship Game',
                    content: `
                        <h4>👑 Week 17 - Championship Game</h4>
                        <p>The final 3 teams battle for the Shake Weight Championship and $700 prize.</p>
                        <ul>
                            <li><strong>3-Team Championship:</strong> Unique format with multiple teams</li>
                            <li><strong>Highest Score Wins:</strong> Single week determines champion</li>
                            <li><strong>$700 Prize:</strong> Winner takes the largest payout</li>
                            <li><strong>Legacy:</strong> Shake Weight Champion bragging rights</li>
                        </ul>
                    `
                }
            };
            
            const explanation = explanations[step];
            if (explanation) {
                infoTitle.textContent = explanation.title;
                infoContent.innerHTML = explanation.content;
            }
        }

        // Show seed details
        function showSeedDetails(seed) {
            console.log('Showing details for seed:', seed);
            
            const seedInfo = getSeedInfo(seed);
            updateInfoPanel(`Seed #${seed} Details`, null);
            
            const infoContent = document.getElementById('info-content');
            if (infoContent) {
                infoContent.innerHTML = `
                    <h4>🏈 Seed #${seed} - ${seedInfo.category}</h4>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #FFD700;">Path to Championship:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">${seedInfo.path}</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #559AE0;">Requirements:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">${seedInfo.requirements}</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #26A69A;">Advantages:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">${seedInfo.advantages}</p>
                    </div>
                    <div style="margin-bottom: 12px;">
                        <strong style="color: #E3882E;">Risks:</strong>
                        <p style="margin: 5px 0; font-size: 13px;">${seedInfo.risks}</p>
                    </div>
                `;
            }
            
            // Highlight the clicked seed
            highlightSeed(seed);
        }

        // Get seed information
        function getSeedInfo(seed) {
            const seedData = {
                1: {
                    category: "Duel of the Fates Participant",
                    path: "Duel of the Fates (Weeks 14+15) → Week 16 Conference Championship → Week 17 Finals",
                    requirements: "Finish #1 in regular season standings (Weeks 1-13)",
                    advantages: "Guaranteed Conference Championship spot, potential $60-100 Duel payout",
                    risks: "Duel pressure against #2 seed, payout depends on margin of victory"
                },
                2: {
                    category: "Duel of the Fates Participant", 
                    path: "Duel of the Fates (Weeks 14+15) → Week 16 Conference Championship → Week 17 Finals",
                    requirements: "Finish #2 in regular season standings (Weeks 1-13)",
                    advantages: "Guaranteed Conference Championship spot, potential $40-100 Duel payout",
                    risks: "Must compete against #1 seed, smaller payout if losing Duel"
                },
                3: {
                    category: "Auto Playoff",
                    path: "Week 14+15 Combined → Week 16 Conference → Week 17 Finals",
                    requirements: "Finish #3 in regular season, survive 2-week gauntlet",
                    advantages: "Automatic playoff spot, momentum from competition",
                    risks: "Must perform well for two consecutive weeks"
                },
                4: {
                    category: "Auto Playoff",
                    path: "Week 14+15 Combined → Week 16 Conference → Week 17 Finals", 
                    requirements: "Finish #4 in regular season, survive 2-week gauntlet",
                    advantages: "Automatic playoff spot, battle-tested by Week 16",
                    risks: "Two-week elimination pressure, no margin for error"
                },
                5: {
                    category: "Auto Playoff",
                    path: "Week 14+15 Combined → Week 16 Conference → Week 17 Finals",
                    requirements: "Finish #5 in regular season, outperform in playoffs",
                    advantages: "Playoff experience, underdog motivation",
                    risks: "Lower seed stigma, tough competition from higher seeds"
                },
                6: {
                    category: "Auto Playoff",
                    path: "Week 14+15 Combined → Week 16 Conference → Week 17 Finals",
                    requirements: "Finish #6 in regular season, excel in combined scoring",
                    advantages: "Last guaranteed spot, nothing to lose mentality",
                    risks: "Lowest auto-playoff seed, uphill battle"
                }
            };
            
            // Wildcard seeds (7-12)
            if (seed >= 7 && seed <= 12) {
                return {
                    category: "Wildcard Battle",
                    path: "Week 14 Only → Week 15 Combined (if winner) → Possible Finals",
                    requirements: "Score highest among seeds 7-12 in Week 14 only",
                    advantages: "Cinderella story potential, one great week can change everything",
                    risks: "Single elimination in Week 14, 5 other teams competing for 1 spot"
                };
            }
            
            return seedData[seed] || { category: "Unknown", path: "", requirements: "", advantages: "", risks: "" };
        }

        // Highlight clicked seed
        function highlightSeed(seed) {
            // Clear previous seed highlights
            document.querySelectorAll('.seed-slot').forEach(slot => {
                slot.classList.remove('seed-highlight');
            });
            
            // Highlight the clicked seed
            const seedSlot = document.querySelector(`[data-seed="${seed}"]`);
            if (seedSlot) {
                seedSlot.classList.add('seed-highlight');
                seedSlot.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // Animate full tournament flow
        async function animateFullTournament() {
            console.log('Starting full tournament animation...');
            
            const animateBtn = document.getElementById('animate-btn');
            if (animateBtn) {
                animateBtn.textContent = '⏸️ Pause Animation';
                animateBtn.onclick = () => {
                    animateBtn.textContent = '▶️ Animate Flow';
                    animateBtn.onclick = animateFullTournament;
                };
            }
            
            // Step 1: Show overview
            showTournamentStep('overview');
            await sleep(2000);
            
            // Step 2: Show Week 14
            showTournamentStep('week14');
            await sleep(2000);
            
            // Step 3: Show Week 15
            showTournamentStep('week15');
            await sleep(2000);
            
            // Step 4: Show Week 16
            showTournamentStep('week16');
            await sleep(2000);
            
            // Step 5: Show Week 17
            showTournamentStep('week17');
            await sleep(2000);
            
            // Step 6: Trigger confetti for champion
            const championSlot = document.querySelector('.champion-slot');
            if (championSlot) {
                triggerConfetti(championSlot);
            }
            
            // Step 7: Return to overview
            setTimeout(() => {
                showTournamentStep('overview');
                if (animateBtn) {
                    animateBtn.textContent = '▶️ Animate Flow';
                    animateBtn.onclick = animateFullTournament;
                }
            }, 3000);
        }

        // Auto-initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize tournament visualization if the element exists
            if (document.getElementById('quantum-gauntlet-viz')) {
                setTimeout(initializeTournamentVisualization, 500);
            }
        });

        // UPDATE your showTab function to initialize tournament when Rules & Updates is shown
        function showTab(tabName) {
            console.log('Showing tab:', tabName);
            
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            const tabContent = document.getElementById(tabName + '-content');
            if (tabContent) {
                tabContent.style.display = 'block';
            }
            
            // Add active class to selected tab button
            const tabButton = document.getElementById(tabName + '-tab');
            if (tabButton) {
                tabButton.classList.add('active');
            }
            
            // Initialize specific tab content
            if (tabName === 'the-run' && window.latestData) {
                updateTheRunTab(window.latestData);
            } else if (tabName === 'payouts') {
                setTimeout(() => {
                    initializePayouts();
                }, 100);
            } else if (tabName === 'rules-updates') {
                // ADD this: Initialize tournament visualization
                setTimeout(() => {
                    if (document.getElementById('quantum-gauntlet-viz')) {
                        initializeTournamentVisualization();
                        // Uncomment for debugging
                        // setTimeout(debugMixedTournament, 1000);
                    }
                }, 100);
            }
        }
        </script>
    </div>
</body>
</html> 
